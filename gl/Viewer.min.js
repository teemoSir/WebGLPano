
/*
 underscore.js - modified by Clément Prévost
 @param {Function} func
 @param {int} wait
 @returns {Function}
 Nicholas Fisher <nfisher110@gmail.com>
 @param {Object} target
 @param {Object} src
 @returns {Object} target
 Facebook
 @param {MouseWheelEvent} event
 @returns {{spinX: number, spinY: number, pixelX: number, pixelY: number}}
 MIT
*/
(function(l,w){"function"===typeof define&&define.amd?define(["three","d.js","uevent","dot/doT"],w):"object"===typeof module&&module.exports?module.exports=w(require("three"),require("d.js"),require("uevent"),require("dot/doT")):l.Viewer=w(l.THREE,l.D,l.uEvent,l.doT)})(this,function(l,w,K,L){function c(a){if(!(this instanceof c))return new c(a);c.SYSTEM.loaded||c._loadSystem();this.config=d.clone(c.DEFAULTS);d.deepmerge(this.config,a);if(!a.container)throw new n("No value given for container.");if(!c.SYSTEM.isCanvasSupported)throw new n("Canvas is not supported.");if(!(c.SYSTEM.isWebGLSupported&&this.config.webgl||d.checkTHREE("CanvasRenderer","Projector")))throw new n("Missing Three.js components: CanvasRenderer, Projector. Get them from three.js-examples package.");this.config.longitude_range&&2!==this.config.longitude_range.length&&(this.config.longitude_range=null,console.warn("warning: longitude_range must have exactly two elements."));if(this.config.latitude_range)2!==this.config.latitude_range.length?(this.config.latitude_range=null,console.warn("warning: latitude_range must have exactly two elements.")):this.config.latitude_range[0]>this.config.latitude_range[1]&&(this.config.latitude_range=[this.config.latitude_range[1],this.config.latitude_range[0]],console.warn("warning: latitude_range values must be ordered."));else if(void 0!==this.config.tilt_up_max||void 0!==this.config.tilt_down_max)this.config.latitude_range=[void 0!==this.config.tilt_down_max?this.config.tilt_down_max-Math.PI/4:-d.HalfPI,void 0!==this.config.tilt_up_max?this.config.tilt_up_max+Math.PI/4:d.HalfPI],console.warn("warning: tilt_up_max and tilt_down_max are deprecated, use latitude_range instead.");if(this.config.max_fov<this.config.min_fov){var b=this.config.max_fov;this.config.max_fov=this.config.min_fov;this.config.min_fov=b;console.warn("warning: max_fov cannot be lower than min_fov.")}this.config.cache_texture&&(!d.isInteger(this.config.cache_texture)||0>this.config.cache_texture)&&(this.config.cache_texture=c.DEFAULTS.cache_texture,console.warn("warning: invalid value for cache_texture"));"panorama_roll"in this.config&&(this.config.sphere_correction.roll=this.config.panorama_roll,console.warn("warning: panorama_roll is deprecated, use sphere_correction.roll instead"));"gyroscope"in this.config&&console.warn("warning: gyroscope is deprecated, the control is automatically created if DeviceOrientationControls.js is loaded");!0===this.config.keyboard&&(this.config.keyboard=d.clone(c.DEFAULTS.keyboard));this.config.min_fov=d.bound(this.config.min_fov,1,179);this.config.max_fov=d.bound(this.config.max_fov,1,179);this.config.default_fov=null===this.config.default_fov?this.config.max_fov/2+this.config.min_fov/2:d.bound(this.config.default_fov,this.config.min_fov,this.config.max_fov);this.config.default_long=d.parseAngle(this.config.default_long);this.config.default_lat=d.parseAngle(this.config.default_lat,!0);this.config.sphere_correction.pan=d.parseAngle(this.config.sphere_correction.pan,!0);this.config.sphere_correction.tilt=d.parseAngle(this.config.sphere_correction.tilt,!0);this.config.sphere_correction.roll=d.parseAngle(this.config.sphere_correction.roll,!0);this.config.anim_lat=null===this.config.anim_lat?this.config.default_lat:d.parseAngle(this.config.anim_lat,!0);this.config.longitude_range&&(this.config.longitude_range=this.config.longitude_range.map(function(a){return d.parseAngle(a)}));this.config.latitude_range&&(this.config.latitude_range=this.config.latitude_range.map(function(a){return d.parseAngle(a,!0)}));this.config.anim_speed=d.parseSpeed(this.config.anim_speed);this.config.caption&&!this.config.navbar&&(this.config.navbar=["caption"]);!0===this.config.fisheye?this.config.fisheye=1:!1===this.config.fisheye&&(this.config.fisheye=0);this.parent="string"===typeof a.container?document.getElementById(a.container):a.container;this.doControls=this.raycaster=this.mesh=this.camera=this.scene=this.noSleep=this.stereoEffect=this.renderer=this.canvas_container=this.overlay=this.notification=this.tooltip=this.panel=this.hud=this.navbar=this.loader=this.container=null;this.prop={needsUpdate:!0,isCubemap:void 0,position:{longitude:0,latitude:0},ready:!1,direction:null,anim_speed:0,zoom_lvl:0,vFov:0,hFov:0,aspect:0,move_speed:.1,moving:!1,zooming:!1,start_mouse_x:0,start_mouse_y:0,mouse_x:0,mouse_y:0,mouse_history:[],gyro_alpha_offset:0,pinch_dist:0,main_reqid:null,orientation_cb:null,autorotate_cb:null,animation_promise:null,loading_promise:null,start_timeout:null,dblclick_data:null,dblclick_timeout:null,cache:[],size:{width:0,height:0},pano_data:{full_width:0,full_height:0,cropped_width:0,cropped_height:0,cropped_x:0,cropped_y:0}};Object.keys(c.TEMPLATES).forEach(function(a){this.config.templates[a]||(this.config.templates[a]=c.TEMPLATES[a]);"string"===typeof this.config.templates[a]&&(this.config.templates[a]=L.template(this.config.templates[a]))},this);this.parent.photoSphereViewer=this;this.container=document.createElement("div");this.container.classList.add("psv-container");this.parent.appendChild(this.container);null!==this.config.size&&this._setViewerSize(this.config.size);this._onResize();a=Math.round((this.config.default_fov-this.config.min_fov)/(this.config.max_fov-this.config.min_fov)*100);this.zoom(a-2*(a-50));this.prop.move_speed=l.Math.degToRad(this.config.move_speed/c.SYSTEM.pixelRatio);this.rotate({longitude:this.config.default_long,latitude:this.config.default_lat});this.loader=new I(this);this.loader.hide();this.navbar=new B(this);this.navbar.hide();this.hud=new p(this);this.hud.hide();this.panel=new v(this);this.tooltip=new t(this.hud);this.notification=new C(this);this.overlay=new D(this);this._bindEvents();this.config.panorama&&this.setPanorama(this.config.panorama);this.once("render",function(){this.config.navbar&&(this.container.classList.add("psv-container--has-navbar"),this.navbar.show());this.hud.show();this.config.markers&&(this.config.markers.forEach(function(a){this.hud.addMarker(a,!1)},this),this.hud.renderMarkers());!1!==this.config.time_anim&&(this.prop.start_timeout=window.setTimeout(this.startAutorotate.bind(this),this.config.time_anim));setTimeout(function(){this._run();this.trigger("ready")}.bind(this),0)}.bind(this));c.SYSTEM.touchEnabled.then(function(){this.container.classList.add("psv-is-touch")}.bind(this))}function k(a){this.psv=a instanceof c?a:a.psv;this.parent=a;this.container=null;this.visible=!0;this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(a){this.psv[a]=this[a].bind(this)},this)}function p(a){k.call(this,a);this.svgContainer=null;this.markers={};this.hoveringMarker=this.currentMarker=null;this.prop={panelOpened:!1,panelOpening:!1,markersButton:this.psv.navbar.getNavbarButton("markers",!0)};this.create()}function I(a){k.call(this,a);this.loader=this.canvas=null;this.create()}function B(a){k.call(this,a);this.config=this.psv.config.navbar;this.items=[];!0===this.config?this.config=d.clone(c.DEFAULTS.navbar):"string"===typeof this.config?this.config=this.config.split(" "):Array.isArray(this.config)||(console.warn('warning: hashmap form of "navbar" is deprecated, use an array instead.'),a=this.config,this.config=[],d.forEach(a,function(a,e){a&&this.config.push(e)}.bind(this)),this.config.sort(function(a,e){return c.DEFAULTS.navbar.indexOf(a)-c.DEFAULTS.navbar.indexOf(e)}));this.create()}function E(a,b){k.call(this,a);this.button=this.content=null;this.prop={caption:"",width:0};this.create();this.setCaption(b)}function C(a){k.call(this,a);this.create()}function D(a){k.call(this,a);this.create();this.hide()}function v(a){k.call(this,a);this.content=null;this.prop={mouse_x:0,mouse_y:0,mousedown:!1,opened:!1};this.create()}function t(a){k.call(this,a);this.config=this.psv.config.tooltip;this.prop={timeout:null};this.create()}function g(a){k.call(this,a);this.id=void 0;this.constructor.id&&(this.id=this.constructor.id);this.enabled=!0}function y(a){g.call(this,a);this.create()}function F(a){g.call(this,a);this.create()}function J(a,b){g.call(this,a);this.config=b;this.config.id&&(this.id=this.config.id);this.create()}function G(a){g.call(this,a);this.create()}function x(a){g.call(this,a);this.create()}function z(a){g.call(this,a);this.create()}function H(a){g.call(this,a);this.create()}function A(a){g.call(this,a);this.create()}function r(a){g.call(this,a);this.zoom_value=this.zoom_range=null;this.prop={mousedown:!1,buttondown:!1,longPressInterval:null,longPressTimeout:null};this.create()}function n(a){this.message=a;"captureStackTrace"in Error?Error.captureStackTrace(this,n):this.stack=Error().stack}function u(a,b){if(!a.id)throw new n("missing marker id");if(a.image&&(!a.width||!a.height))throw new n("missing marker width/height");if((a.image||a.html)&&!(a.hasOwnProperty("x")&&a.hasOwnProperty("y")||a.hasOwnProperty("latitude")&&a.hasOwnProperty("longitude")))throw new n("missing marker position, latitude/longitude or x/y");this.psv=b;this.visible=!0;this._dynamicSize=!1;var e=a.id,c=u.getType(a,!1),f;Object.defineProperties(this,{id:{configurable:!1,enumerable:!0,get:function(){return e},set:function(){}},type:{configurable:!1,enumerable:!0,get:function(){return c},set:function(){}},$el:{configurable:!1,enumerable:!0,get:function(){return f},set:function(){}},_def:{configurable:!1,enumerable:!0,get:function(){return this[c]},set:function(a){this[c]=a}}});f=this.isNormal()?document.createElement("div"):this.isPolygon()?document.createElementNS(d.svgNS,"polygon"):this.isPolyline()?document.createElementNS(d.svgNS,"polyline"):document.createElementNS(d.svgNS,this.type);f.id="psv-marker-"+this.id;f.psvMarker=this;this.update(a)}K.mixin(c);c.prototype._run=function(a){this.trigger("before-render",a||+new Date);this.prop.needsUpdate&&(this._render(),this.prop.needsUpdate=!1);this.prop.main_reqid=window.requestAnimationFrame(this._run.bind(this))};c.prototype._render=function(){this.prop.direction=this.sphericalCoordsToVector3(this.prop.position);this.camera.position.set(0,0,0);this.camera.lookAt(this.prop.direction);this.config.fisheye&&this.camera.position.copy(this.prop.direction).multiplyScalar(this.config.fisheye/2).negate();this.camera.aspect=this.prop.aspect;this.camera.fov=this.prop.vFov;this.camera.updateProjectionMatrix();(this.stereoEffect||this.renderer).render(this.scene,this.camera);this.trigger("render")};c.prototype._loadXMP=function(a){if(!this.config.usexmpdata)return w.resolved(null);var b=w(),e=new XMLHttpRequest;this.config.with_credentials&&(e.withCredentials=!0);var c=0;e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status||201===e.status||202===e.status||0===e.status){this.loader.setProgress(100);var a=e.responseText,h=a.indexOf("\x3cx:xmpmeta"),q=a.indexOf("\x3c/x:xmpmeta\x3e"),a=a.substring(h,q);-1===h||-1===q||-1===a.indexOf("GPano:")?b.resolve(null):(h={full_width:parseInt(d.getXMPValue(a,"FullPanoWidthPixels")),full_height:parseInt(d.getXMPValue(a,"FullPanoHeightPixels")),cropped_width:parseInt(d.getXMPValue(a,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(d.getXMPValue(a,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(d.getXMPValue(a,"CroppedAreaLeftPixels")),cropped_y:parseInt(d.getXMPValue(a,"CroppedAreaTopPixels"))},h.full_width&&h.full_height&&h.cropped_width&&h.cropped_height?b.resolve(h):(console.warn("warning: invalid XMP data"),b.resolve(null)))}else throw this.container.textContent="Cannot load image",new n("Cannot load image");else 3===e.readyState&&this.loader.setProgress(c+=10)}.bind(this);e.onprogress=function(a){a.lengthComputable&&(a=parseInt(a.loaded/a.total*100),a>c&&(c=a,this.loader.setProgress(c)))}.bind(this);e.onerror=function(){this.container.textContent="Cannot load image";throw new n("Cannot load image");}.bind(this);e.open("GET",a,!0);e.send(null);return b.promise};c.prototype._loadTexture=function(a){var b=[];if(Array.isArray(a)){if(6!==a.length)throw new n("Must provide exactly 6 image paths when using cubemap.");for(var e=0;6>e;e++)b[e]=a[c.CUBE_MAP[e]];a=b}else if("object"===typeof a){if(!c.CUBE_HASHMAP.every(function(b){return!!a[b]}))throw new n("Must provide exactly left, front, right, back, top, bottom when using cubemap.");c.CUBE_HASHMAP.forEach(function(e,c){b[c]=a[e]});a=b}if(Array.isArray(a)){if(!1===this.prop.isCubemap)throw new n("The viewer was initialized with an equirectangular panorama, cannot switch to cubemap.");this.config.fisheye&&console.warn("warning: fisheye effect with cubemap texture can generate distorsions.");this.config.cache_texture===c.DEFAULTS.cache_texture&&(this.config.cache_texture*=6);this.prop.isCubemap=!0;return this._loadCubemapTexture(a)}if(!0===this.prop.isCubemap)throw new n("The viewer was initialized with an cubemap, cannot switch to equirectangular panorama.");this.prop.isCubemap=!1;return this._loadEquirectangularTexture(a)};c.prototype._loadEquirectangularTexture=function(a){if(this.config.cache_texture){var b=this.getPanoramaCache(a);if(b)return this.prop.pano_data=b.pano_data,w.resolved(b.image)}return this._loadXMP(a).then(function(b){var e=w(),f=new l.ImageLoader,m=b?100:0;this.config.with_credentials?f.setCrossOrigin("use-credentials"):f.setCrossOrigin("anonymous");f.load(a,function(h){m=100;this.loader.setProgress(m);this.trigger("panorama-load-progress",a,m);!b&&this.config.pano_data&&(b=d.clone(this.config.pano_data));b||(b={full_width:h.width,full_height:h.height,cropped_width:h.width,cropped_height:h.height,cropped_x:0,cropped_y:0});this.prop.pano_data=b;var f=Math.min(b.full_width,c.SYSTEM.maxTextureWidth)/b.full_width;if(1!==f||b.cropped_width!==b.full_width||b.cropped_height!==b.full_height){var q=d.clone(b);q.full_width*=f;q.full_height*=f;q.cropped_width*=f;q.cropped_height*=f;q.cropped_x*=f;q.cropped_y*=f;h.width=q.cropped_width;h.height=q.cropped_height;f=document.createElement("canvas");f.width=q.full_width;f.height=q.full_height;f.getContext("2d").drawImage(h,q.cropped_x,q.cropped_y,q.cropped_width,q.cropped_height);h=new l.Texture(f)}else h=new l.Texture(h);h.needsUpdate=!0;h.minFilter=l.LinearFilter;h.generateMipmaps=!1;this.config.cache_texture&&this._putPanoramaCache({panorama:a,image:h,pano_data:b});e.resolve(h)}.bind(this),function(b){b.lengthComputable&&(b=parseInt(b.loaded/b.total*100),b>m&&(m=b,this.loader.setProgress(m),this.trigger("panorama-load-progress",a,m)))}.bind(this),function(a){this.container.textContent="Cannot load image";e.reject(a);throw new n("Cannot load image");}.bind(this));return e.promise}.bind(this))};c.prototype._loadCubemapTexture=function(a){var b=w(),e=new l.ImageLoader,h=[0,0,0,0,0,0],f=[],m=0;this.config.with_credentials?e.setCrossOrigin("use-credentials"):e.setCrossOrigin("anonymous");for(var q=function(){f.forEach(function(a){a.needsUpdate=!0;a.minFilter=l.LinearFilter;a.generateMipmaps=!1});b.resolve(f)},g=function(b,e){m++;h[b]=100;this.loader.setProgress(d.sum(h)/6);this.trigger("panorama-load-progress",a[b],h[b]);var g=Math.min(e.width,c.SYSTEM.maxTextureWidth/2)/e.width;if(1!==g){var k=document.createElement("canvas");k.width=e.width*g;k.height=e.height*g;k.getContext("2d").drawImage(e,0,0,k.width,k.height);f[b]=new l.Texture(k)}else f[b]=new l.Texture(e);this.config.cache_texture&&this._putPanoramaCache({panorama:a[b],image:f[b]});6===m&&q()},k=function(b,e){if(e.lengthComputable){var c=parseInt(e.loaded/e.total*100);c>h[b]&&(h[b]=c,this.loader.setProgress(d.sum(h)/6),this.trigger("panorama-load-progress",a[b],h[b]))}},p=function(a,e){this.container.textContent="Cannot load image";b.reject(e);throw new n("Cannot load image "+a);},r=0;6>r;r++){if(this.config.cache_texture){var t=this.getPanoramaCache(a[r]);if(t){m++;h[r]=100;f[r]=t.image;continue}}e.load(a[r],g.bind(this,r),k.bind(this,r),p.bind(this,r))}6===m&&b.resolve(f);return b.promise};c.prototype._setTexture=function(a){this.scene||this._createScene();if(this.prop.isCubemap)for(var b=0;6>b;b++)this.mesh.material[b].map&&this.mesh.material[b].map.dispose(),this.mesh.material[b].map=a[b];else this.mesh.material.map&&this.mesh.material.map.dispose(),this.mesh.material.map=a;this.trigger("panorama-loaded");this._render()};c.prototype._createScene=function(){this.raycaster=new l.Raycaster;this.renderer=c.SYSTEM.isWebGLSupported&&this.config.webgl?new l.WebGLRenderer:new l.CanvasRenderer;this.renderer.setSize(this.prop.size.width,this.prop.size.height);this.renderer.setPixelRatio(c.SYSTEM.pixelRatio);var a=c.SPHERE_RADIUS;this.prop.isCubemap&&(a*=Math.sqrt(3));this.config.fisheye&&(a+=c.SPHERE_RADIUS);this.camera=new l.PerspectiveCamera(this.config.default_fov,this.prop.size.width/this.prop.size.height,1,a);this.camera.position.set(0,0,0);this.scene=new l.Scene;this.scene.add(this.camera);this.mesh=this.prop.isCubemap?this._createCubemap():this._createSphere();this.scene.add(this.mesh);this.canvas_container=document.createElement("div");this.canvas_container.className="psv-canvas-container";this.renderer.domElement.className="psv-canvas";this.container.appendChild(this.canvas_container);this.canvas_container.appendChild(this.renderer.domElement)};c.prototype._createSphere=function(a){a=new l.SphereGeometry(c.SPHERE_RADIUS*(a||1),c.SPHERE_VERTICES,c.SPHERE_VERTICES,-d.HalfPI);var b=new l.MeshBasicMaterial({side:l.DoubleSide,overdraw:c.SYSTEM.isWebGLSupported&&this.config.webgl?0:1});a=new l.Mesh(a,b);a.scale.x=-1;a.rotation.x=this.config.sphere_correction.tilt;a.rotation.y=this.config.sphere_correction.pan;a.rotation.z=this.config.sphere_correction.roll;return a};c.prototype._createCubemap=function(a){a=a||1;for(var b=new l.BoxGeometry(2*c.SPHERE_RADIUS*a,2*c.SPHERE_RADIUS*a,2*c.SPHERE_RADIUS*a,c.CUBE_VERTICES,c.CUBE_VERTICES,c.CUBE_VERTICES),e=[],h=0;6>h;h++)e.push(new l.MeshBasicMaterial({side:l.BackSide,overdraw:c.SYSTEM.isWebGLSupported&&this.config.webgl?0:1}));b=new l.Mesh(b,e);b.position.x-=c.SPHERE_RADIUS*a;b.position.y-=c.SPHERE_RADIUS*a;b.position.z-=c.SPHERE_RADIUS*a;b.applyMatrix((new l.Matrix4).makeScale(1,1,-1));return b};c.prototype._transition=function(a,b){var e;this.prop.isCubemap?(b&&(console.warn("warning: cannot perform cubemap transition to different position."),b=void 0),e=this._createCubemap(.9),e.material.forEach(function(b,e){b.map=a[e];b.transparent=!0;b.opacity=0})):(e=this._createSphere(.9),e.material.map=a,e.material.transparent=!0,e.material.opacity=0);if(b){e.rotateY(b.longitude-this.prop.position.longitude);var c=(new l.Vector3(0,1,0)).cross(this.camera.getWorldDirection()).normalize(),c=(new l.Quaternion).setFromAxisAngle(c,b.latitude-this.prop.position.latitude);e.quaternion.multiplyQuaternions(c,e.quaternion);if(this.config.latitude_range||this.config.longitude_range)this.config.longitude_range=this.config.latitude_range=null,console.warn("warning: trying to perform transition with longitude_range and/or latitude_range, ranges cleared.")}this.scene.add(e);this.needsUpdate();return d.animation({properties:{opacity:{start:0,end:1}},duration:this.config.transition.duration,easing:"outCubic",onTick:function(a){if(this.prop.isCubemap)for(var b=0;6>b;b++)e.material[b].opacity=a.opacity;else e.material.opacity=a.opacity;this.needsUpdate()}.bind(this)}).then(function(){this._setTexture(a);this.scene.remove(e);e.geometry.dispose();e.geometry=null;b&&this.rotate(b)}.bind(this))};c.prototype._reverseAutorotate=function(){var a=this,b=-this.config.anim_speed,e=this.config.longitude_range;this.config.longitude_range=null;d.animation({properties:{speed:{start:this.config.anim_speed,end:0}},duration:300,easing:"inSine",onTick:function(b){a.config.anim_speed=b.speed}}).then(function(){return d.animation({properties:{speed:{start:0,end:b}},duration:300,easing:"outSine",onTick:function(b){a.config.anim_speed=b.speed}})}).then(function(){a.config.longitude_range=e;a.config.anim_speed=b})};c.prototype._putPanoramaCache=function(a){if(!this.config.cache_texture)throw new n("Cannot add panorama to cache, cache_texture is disabled");var b=this.getPanoramaCache(a.panorama);b?(b.image=a.image,b.pano_data=a.pano_data):(this.prop.cache=this.prop.cache.slice(0,this.config.cache_texture-1),this.prop.cache.unshift(a));this.trigger("panorama-cached",a.panorama)};c.prototype._stopAll=function(){this.stopAutorotate();this.stopAnimation();this.stopGyroscopeControl();this.stopStereoView()};c.MOVE_THRESHOLD=4;c.ANGLE_THRESHOLD=.003;c.DBLCLICK_DELAY=300;c.INERTIA_WINDOW=300;c.SPHERE_RADIUS=100;c.SPHERE_VERTICES=64;c.CUBE_VERTICES=8;c.CUBE_MAP=[0,2,4,5,3,1];c.CUBE_HASHMAP="left right top bottom back front".split(" ");c.SYSTEM={loaded:!1,pixelRatio:1,isWebGLSupported:!1,isCanvasSupported:!1,deviceOrientationSupported:null,maxTextureWidth:0,mouseWheelEvent:null,fullscreenEvent:null};c.ICONS={};c.DEFAULTS={panorama:null,container:null,caption:null,usexmpdata:!0,pano_data:null,webgl:!0,min_fov:30,max_fov:90,default_fov:null,default_long:0,default_lat:0,sphere_correction:{pan:0,tilt:0,roll:0},longitude_range:null,latitude_range:null,move_speed:1,zoom_speed:2,time_anim:2E3,anim_speed:"2rpm",anim_lat:null,fisheye:!1,navbar:"autorotate zoom download markers caption gyroscope stereo fullscreen".split(" "),tooltip:{offset:5,arrow_size:7,delay:100},lang:{autorotate:"Automatic rotation",zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",download:"Download",fullscreen:"Fullscreen",markers:"Markers",gyroscope:"Gyroscope",stereo:"Stereo view",stereo_notification:"Click anywhere to exit stereo view.",please_rotate:["Please rotate your device","(or tap to continue)"],two_fingers:["Use two fingers to navigate"]},mousewheel:!0,mousewheel_factor:1,mousemove:!0,mousemove_hover:!1,touchmove_two_fingers:!1,keyboard:{ArrowUp:"rotateLatitudeUp",ArrowDown:"rotateLatitudeDown",ArrowRight:"rotateLongitudeRight",ArrowLeft:"rotateLongitudeLeft",PageUp:"zoomIn",PageDown:"zoomOut","+":"zoomIn","-":"zoomOut"," ":"toggleAutorotate"},move_inertia:!0,click_event_on_marker:!1,transition:{duration:1500,loader:!0},loading_img:null,loading_txt:"Loading...",size:null,cache_texture:0,templates:{},markers:[],with_credentials:!1};c.TEMPLATES={markersList:'\x3cdiv class\x3d"psv-markers-list-container"\x3e   \x3ch1 class\x3d"psv-markers-list-title"\x3e{{\x3d it.config.lang.markers }}\x3c/h1\x3e   \x3cul class\x3d"psv-markers-list"\x3e   {{~ it.markers: marker }}     \x3cli data-psv-marker\x3d"{{\x3d marker.id }}" class\x3d"psv-markers-list-item {{? marker.className }}{{\x3d marker.className }}{{?}}"\x3e       {{? marker.image }}\x3cimg class\x3d"psv-markers-list-image" src\x3d"{{\x3d marker.image }}"/\x3e{{?}}       \x3cp class\x3d"psv-markers-list-name"\x3e{{? marker.tooltip }}{{\x3d marker.tooltip.content }}{{?? marker.html }}{{\x3d marker.html }}{{??}}{{\x3d marker.id }}{{?}}\x3c/p\x3e     \x3c/li\x3e   {{~}}   \x3c/ul\x3e \x3c/div\x3e'};c.prototype._bindEvents=function(){window.addEventListener("resize",this);this.config.mousemove&&(this.hud.container.style.cursor="default",this.config.mousemove_hover?(this.hud.container.addEventListener("mouseenter",this),this.hud.container.addEventListener("mouseleave",this)):(this.hud.container.addEventListener("mousedown",this),window.addEventListener("mouseup",this)),this.hud.container.addEventListener("touchstart",this),window.addEventListener("touchend",this),this.hud.container.addEventListener("mousemove",this),this.hud.container.addEventListener("touchmove",this));c.SYSTEM.fullscreenEvent&&document.addEventListener(c.SYSTEM.fullscreenEvent,this);this.config.mousewheel&&this.hud.container.addEventListener(c.SYSTEM.mouseWheelEvent,this);this.on("_side-reached",function(a){this.isAutorotateEnabled()&&("left"!==a&&"right"!==a||this._reverseAutorotate())})};c.prototype._unbindEvents=function(){window.removeEventListener("resize",this);this.config.mousemove&&(this.hud.container.removeEventListener("mousedown",this),this.hud.container.removeEventListener("mouseenter",this),this.hud.container.removeEventListener("touchstart",this),window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this),this.hud.container.removeEventListener("mouseleave",this),this.hud.container.removeEventListener("mousemove",this),this.hud.container.removeEventListener("touchmove",this));c.SYSTEM.fullscreenEvent&&document.removeEventListener(c.SYSTEM.fullscreenEvent,this);this.config.mousewheel&&this.hud.container.removeEventListener(c.SYSTEM.mouseWheelEvent,this);this.off("_side-reached")};c.prototype.handleEvent=function(a){switch(a.type){case "resize":d.throttle(this._onResize(),50);break;case "keydown":this._onKeyDown(a);break;case "mousedown":this._onMouseDown(a);break;case "mouseenter":this._onMouseDown(a);break;case "touchstart":this._onTouchStart(a);break;case "mouseup":this._onMouseUp(a);break;case "mouseleave":this._onMouseUp(a);break;case "touchend":this._onTouchEnd(a);break;case "mousemove":this._onMouseMove(a);break;case "touchmove":this._onTouchMove(a);break;case c.SYSTEM.fullscreenEvent:this._fullscreenToggled();break;case c.SYSTEM.mouseWheelEvent:this._onMouseWheel(a)}};c.prototype._onResize=function(){if(this.container.clientWidth!==this.prop.size.width||this.container.clientHeight!==this.prop.size.height)this.prop.size.width=parseInt(this.container.clientWidth),this.prop.size.height=parseInt(this.container.clientHeight),this.prop.aspect=this.prop.size.width/this.prop.size.height,this.needsUpdate(),this.renderer&&(this.stereoEffect||this.renderer).setSize(this.prop.size.width,this.prop.size.height),this.trigger("size-updated",this.getSize())};c.prototype._onKeyDown=function(a){var b=0,e=0,c=0;a=d.getEventKey(a);switch(this.config.keyboard[a]){case "rotateLatitudeUp":e=.01;break;case "rotateLatitudeDown":e=-.01;break;case "rotateLongitudeRight":b=.01;break;case "rotateLongitudeLeft":b=-.01;break;case "zoomIn":c=1;break;case "zoomOut":c=-1;break;case "toggleAutorotate":this.toggleAutorotate()}0!==c?this.zoom(this.prop.zoom_lvl+c*this.config.zoom_speed):0===e&&0===b||this.rotate({longitude:this.prop.position.longitude+b*this.prop.move_speed*this.prop.hFov,latitude:this.prop.position.latitude+e*this.prop.move_speed*this.prop.vFov})};c.prototype._onMouseDown=function(a){this._startMove(a)};c.prototype._onMouseUp=function(a){this._stopMove(a);this.isStereoEnabled()&&this.stopStereoView()};c.prototype._onMouseMove=function(a){0!==a.buttons?(a.preventDefault(),this._move(a)):this.config.mousemove_hover&&this._moveAbsolute(a)};c.prototype._onTouchStart=function(a){1===a.touches.length?this.config.touchmove_two_fingers||this._startMove(a.touches[0]):2===a.touches.length&&this._startMoveZoom(a)};c.prototype._onTouchEnd=function(a){1===a.touches.length?this._stopMoveZoom():0===a.touches.length&&(this._stopMove(a.changedTouches[0]),this.config.touchmove_two_fingers&&this.overlay.hideOverlay())};c.prototype._onTouchMove=function(a){1===a.touches.length?this.config.touchmove_two_fingers?this.overlay.showOverlay({image:c.ICONS["gesture.svg"],text:this.config.lang.two_fingers[0]}):(a.preventDefault(),this._move(a.touches[0])):2===a.touches.length&&(a.preventDefault(),this._moveZoom(a))};c.prototype._startMove=function(a){this.stopAutorotate();this.stopAnimation();this.prop.mouse_x=this.prop.start_mouse_x=parseInt(a.clientX);this.prop.mouse_y=this.prop.start_mouse_y=parseInt(a.clientY);this.prop.moving=!0;this.prop.zooming=!1;this.prop.mouse_history.length=0;this._logMouseMove(a)};c.prototype._startMoveZoom=function(a){a=[{x:parseInt(a.touches[0].clientX),y:parseInt(a.touches[0].clientY)},{x:parseInt(a.touches[1].clientX),y:parseInt(a.touches[1].clientY)}];this.prop.pinch_dist=Math.sqrt(Math.pow(a[0].x-a[1].x,2)+Math.pow(a[0].y-a[1].y,2));this.prop.mouse_x=this.prop.start_mouse_x=(a[0].x+a[1].x)/2;this.prop.mouse_y=this.prop.start_mouse_x=(a[0].y+a[1].y)/2;this.prop.moving=!0;this.prop.zooming=!0};c.prototype._stopMove=function(a){d.getClosest(a.target,".psv-hud")&&this.prop.moving&&(Math.abs(a.clientX-this.prop.start_mouse_x)<c.MOVE_THRESHOLD&&Math.abs(a.clientY-this.prop.start_mouse_y)<c.MOVE_THRESHOLD?(this._click(a),this.prop.moving=!1):this.config.move_inertia&&!this.isGyroscopeEnabled()?(this._logMouseMove(a),this._stopMoveInertia(a)):this.prop.moving=!1,this.prop.mouse_history.length=0)};c.prototype._stopMoveZoom=function(){this.prop.mouse_history.length=0;this.prop.moving=!1;this.prop.zooming=!1};c.prototype._stopMoveInertia=function(a){var b=a.clientX-this.prop.mouse_history[0][1],e=a.clientY-this.prop.mouse_history[0][2];this.prop.animation_promise=d.animation({properties:{clientX:{start:a.clientX,end:a.clientX+b},clientY:{start:a.clientY,end:a.clientY+e}},duration:Math.sqrt(b*b+e*e)*c.INERTIA_WINDOW/100,easing:"outCirc",onTick:function(a){this._move(a,!1)}.bind(this)}).ensure(function(){this.prop.moving=!1}.bind(this))};c.prototype._click=function(a){var b=this.container.getBoundingClientRect();a={target:a.target,client_x:a.clientX,client_y:a.clientY,viewer_x:parseInt(a.clientX-b.left),viewer_y:parseInt(a.clientY-b.top)};if(b=this.viewerCoordsToVector3({x:a.viewer_x,y:a.viewer_y}))b=this.vector3ToSphericalCoords(b),a.longitude=b.longitude,a.latitude=b.latitude,this.prop.isCubemap||(b=this.sphericalCoordsToTextureCoords({longitude:a.longitude,latitude:a.latitude}),a.texture_x=b.x,a.texture_y=b.y),this.prop.dblclick_timeout?(Math.abs(this.prop.dblclick_data.client_x-a.client_x)<c.MOVE_THRESHOLD&&Math.abs(this.prop.dblclick_data.client_y-a.client_y)<c.MOVE_THRESHOLD&&this.trigger("dblclick",this.prop.dblclick_data),clearTimeout(this.prop.dblclick_timeout),this.prop.dblclick_timeout=null,this.prop.dblclick_data=null):(this.trigger("click",a),this.prop.dblclick_data=d.clone(a),this.prop.dblclick_timeout=setTimeout(function(){this.prop.dblclick_timeout=null;this.prop.dblclick_data=null}.bind(this),c.DBLCLICK_DELAY))};c.prototype._move=function(a,b){if(this.prop.moving){var e=parseInt(a.clientX),d=parseInt(a.clientY),f=(e-this.prop.mouse_x)/this.prop.size.width*this.prop.move_speed*this.prop.hFov*c.SYSTEM.pixelRatio,m=(d-this.prop.mouse_y)/this.prop.size.height*this.prop.move_speed*this.prop.vFov*c.SYSTEM.pixelRatio;this.isGyroscopeEnabled()?this.prop.gyro_alpha_offset+=f:this.rotate({longitude:this.prop.position.longitude-f,latitude:this.prop.position.latitude+m});this.prop.mouse_x=e;this.prop.mouse_y=d;!1!==b&&this._logMouseMove(a)}};c.prototype._moveAbsolute=function(a){this.prop.moving&&this.rotate({longitude:((a.clientX-this.container.offsetLeft)/this.container.offsetWidth-.5)*d.TwoPI,latitude:-((a.clientY-this.container.offsetTop)/this.container.offsetHeight-.5)*Math.PI})};c.prototype._moveZoom=function(a){if(this.prop.zooming&&this.prop.moving){a=[{x:parseInt(a.touches[0].clientX),y:parseInt(a.touches[0].clientY)},{x:parseInt(a.touches[1].clientX),y:parseInt(a.touches[1].clientY)}];var b=Math.sqrt(Math.pow(a[0].x-a[1].x,2)+Math.pow(a[0].y-a[1].y,2));this.zoom(this.prop.zoom_lvl+80*(b-this.prop.pinch_dist)/this.prop.size.width);this._move({clientX:(a[0].x+a[1].x)/2,clientY:(a[0].y+a[1].y)/2});this.prop.pinch_dist=b}};c.prototype._onMouseWheel=function(a){a.preventDefault();a.stopPropagation();a=5*d.normalizeWheel(a).spinY;0!==a&&this.zoom(this.prop.zoom_lvl-a*this.config.mousewheel_factor)};c.prototype._fullscreenToggled=function(){var a=this.isFullscreenEnabled();this.config.keyboard&&(a?this.startKeyboardControl():this.stopKeyboardControl());this.trigger("fullscreen-updated",a)};c.prototype._logMouseMove=function(a){var b=Date.now();this.prop.mouse_history.push([b,a.clientX,a.clientY]);a=null;for(var e=0;e<this.prop.mouse_history.length;)this.prop.mouse_history[0][e]<b-c.INERTIA_WINDOW?this.prop.mouse_history.splice(e,1):(a&&this.prop.mouse_history[0][e]-a>c.INERTIA_WINDOW/10?(this.prop.mouse_history.splice(0,e),e=0):e++,a=this.prop.mouse_history[0][e])};c.prototype.load=function(){if(!this.config.panorama)throw new n("No value given for panorama.");return this.setPanorama(this.config.panorama,!1)};c.prototype.getPosition=function(){return{longitude:this.prop.position.longitude,latitude:this.prop.position.latitude}};c.prototype.getZoomLevel=function(){return this.prop.zoom_lvl};c.prototype.getSize=function(){return{width:this.prop.size.width,height:this.prop.size.height}};c.prototype.isAutorotateEnabled=function(){return!!this.prop.autorotate_cb};c.prototype.isGyroscopeEnabled=function(){return!!this.prop.orientation_cb};c.prototype.isStereoEnabled=function(){return!!this.stereoEffect};c.prototype.isFullscreenEnabled=function(){return d.isFullscreenEnabled(this.container)};c.prototype.needsUpdate=function(){this.prop.needsUpdate=!0};c.prototype.render=function(){this._render()};c.prototype.destroy=function(){window.cancelAnimationFrame(this.prop.main_reqid);this._stopAll();this.stopKeyboardControl();this.stopNoSleep();this.exitFullscreen();this.unlockOrientation();this._unbindEvents();this.tooltip&&this.tooltip.destroy();this.notification&&this.notification.destroy();this.hud&&this.hud.destroy();this.loader&&this.loader.destroy();this.navbar&&this.navbar.destroy();this.panel&&this.panel.destroy();this.overlay&&this.overlay.destroy();this.scene&&d.cleanTHREEScene(this.scene);this.canvas_container&&this.container.removeChild(this.canvas_container);this.parent.removeChild(this.container);delete this.parent.photoSphereViewer;delete this.parent;delete this.container;delete this.loader;delete this.navbar;delete this.hud;delete this.panel;delete this.tooltip;delete this.notification;delete this.overlay;delete this.canvas_container;delete this.renderer;delete this.noSleep;delete this.scene;delete this.camera;delete this.mesh;delete this.raycaster;delete this.passes;delete this.config;this.prop.cache.length=0};c.prototype.setPanorama=function(a,b,e){"boolean"===typeof b&&(e=b,b=void 0);b&&(this.cleanPosition(b),this._stopAll());this.config.panorama=a;e&&this.config.transition&&this.scene?(this.config.transition.loader&&this.loader.show(),this.prop.loading_promise=this._loadTexture(this.config.panorama).then(function(a){this.loader.hide();return this._transition(a,b)}.bind(this)).ensure(function(){this.loader.hide();this.prop.loading_promise=null}.bind(this)).rethrow()):(this.loader.show(),this.canvas_container&&(this.canvas_container.style.opacity=0),this.prop.loading_promise=this._loadTexture(this.config.panorama).then(function(a){this._setTexture(a);b&&this.rotate(b)}.bind(this)).ensure(function(){this.loader.hide();this.canvas_container.style.opacity=1;this.prop.loading_promise=null}.bind(this)).rethrow());return this.prop.loading_promise};c.prototype.startAutorotate=function(){this._stopAll();this.prop.autorotate_cb=this._getAutorotateUpdate();this.on("before-render",this.prop.autorotate_cb);this.trigger("autorotate",!0)};c.prototype._getAutorotateUpdate=function(){var a,b;return function(e){b=void 0===a?0:e-a;a=e;this.rotate({longitude:this.prop.position.longitude+this.config.anim_speed*b/1E3,latitude:this.prop.position.latitude-(this.prop.position.latitude-this.config.anim_lat)/200})}};c.prototype.stopAutorotate=function(){this.prop.start_timeout&&(window.clearTimeout(this.prop.start_timeout),this.prop.start_timeout=null);this.isAutorotateEnabled()&&(this.off("before-render",this.prop.autorotate_cb),this.prop.autorotate_cb=null,this.trigger("autorotate",!1))};c.prototype.toggleAutorotate=function(){this.isAutorotateEnabled()?this.stopAutorotate():this.startAutorotate()};c.prototype.startGyroscopeControl=function(){if(d.checkTHREE("DeviceOrientationControls"))return c.SYSTEM.deviceOrientationSupported.then(function(a){if(a)this._stopAll(),this.doControls=new l.DeviceOrientationControls(this.camera),this.doControls.alphaOffset=this.prop.position.longitude,this.doControls.update(),a=this.camera.getWorldDirection(new l.Vector3),a=this.vector3ToSphericalCoords(a),this.prop.gyro_alpha_offset=a.longitude,this.prop.orientation_cb=this._getOrientationUpdate(),this.on("before-render",this.prop.orientation_cb),this.trigger("gyroscope-updated",!0);else return console.warn("warning: gyroscope not available"),w.rejected()}.bind(this));throw new n("Missing Three.js components: DeviceOrientationControls. Get them from three.js-examples package.");};c.prototype._getOrientationUpdate=function(){return function(){this.doControls.alphaOffset=this.prop.gyro_alpha_offset;this.doControls.update();this.camera.getWorldDirection(this.prop.direction);this.prop.direction.multiplyScalar(c.SPHERE_RADIUS);var a=this.vector3ToSphericalCoords(this.prop.direction);this.prop.position.longitude=a.longitude;this.prop.position.latitude=a.latitude;this.needsUpdate()}};c.prototype.stopGyroscopeControl=function(){this.isGyroscopeEnabled()&&(this.off("before-render",this.prop.orientation_cb),this.prop.orientation_cb=null,this.doControls.disconnect(),this.doControls=null,this.trigger("gyroscope-updated",!1))};c.prototype.toggleGyroscopeControl=function(){this.isGyroscopeEnabled()?this.stopGyroscopeControl():this.startGyroscopeControl()};c.prototype.startNoSleep=function(){"NoSleep"in window?(this.noSleep||(this.noSleep=new NoSleep),this.noSleep.enable()):console.warn("warning: NoSleep is not available")};c.prototype.stopNoSleep=function(){this.noSleep&&this.noSleep.disable()};c.prototype.startStereoView=function(){if(d.checkTHREE("DeviceOrientationControls","StereoEffect"))this.startNoSleep(),this.enterFullscreen(),this.lockOrientation(),this.startGyroscopeControl().then(function(){this.stereoEffect=new l.StereoEffect(this.renderer);this.needsUpdate();this.hud.hide();this.navbar.hide();this.panel.hidePanel();this.trigger("stereo-updated",!0);this.notification.showNotification({content:this.config.lang.stereo_notification,timeout:3E3})}.bind(this),function(){this.unlockOrientation();this.exitFullscreen();this.stopNoSleep()}.bind(this));else throw new n("Missing Three.js components: StereoEffect, DeviceOrientationControls. Get them from three.js-examples package.");};c.prototype.stopStereoView=function(){this.isStereoEnabled()&&(this.stereoEffect=null,this.needsUpdate(),this.hud.show(),this.navbar.show(),this.unlockOrientation(),this.exitFullscreen(),this.stopNoSleep(),this.stopGyroscopeControl(),this.trigger("stereo-updated",!1))};c.prototype.lockOrientation=function(){var a,b=function(){this.isStereoEnabled()&&window.innerHeight>window.innerWidth&&this.overlay.showOverlay({image:c.ICONS["mobile-rotate.svg"],text:this.config.lang.please_rotate[0],subtext:this.config.lang.please_rotate[1]});a&&window.clearTimeout(a)};window.screen&&window.screen.orientation?(window.screen.orientation.lock("landscape").then(null,b.bind(this)),a=setTimeout(b.bind(this),500)):b.apply(this)};c.prototype.unlockOrientation=function(){window.screen&&window.screen.orientation?window.screen.orientation.unlock():this.overlay.hideOverlay()};c.prototype.toggleStereoView=function(){this.isStereoEnabled()?this.stopStereoView():this.startStereoView()};c.prototype.rotate=function(a){this.cleanPosition(a);this.applyRanges(a).forEach(this.trigger.bind(this,"_side-reached"));this.prop.position.longitude=a.longitude;this.prop.position.latitude=a.latitude;this.needsUpdate();this.trigger("position-updated",this.getPosition())};c.prototype.animate=function(a,b){this._stopAll();this.cleanPosition(a);if(!b||Math.abs(a.longitude-this.prop.position.longitude)<c.ANGLE_THRESHOLD&&Math.abs(a.latitude-this.prop.position.latitude)<c.ANGLE_THRESHOLD)return this.rotate(a),w.resolved();this.applyRanges(a).forEach(this.trigger.bind(this,"_side-reached"));b||"number"===typeof b||(b=b?d.parseSpeed(b):this.config.anim_speed,b=Math.acos(Math.cos(this.prop.position.latitude)*Math.cos(a.latitude)*Math.cos(this.prop.position.longitude-a.longitude)+Math.sin(this.prop.position.latitude)*Math.sin(a.latitude))/b*1E3);var e=d.getShortestArc(this.prop.position.longitude,a.longitude);this.prop.animation_promise=d.animation({properties:{longitude:{start:this.prop.position.longitude,end:this.prop.position.longitude+e},latitude:{start:this.prop.position.latitude,end:a.latitude}},duration:b,easing:"inOutSine",onTick:this.rotate.bind(this)});return this.prop.animation_promise};c.prototype.stopAnimation=function(){this.prop.animation_promise&&(this.prop.animation_promise.cancel(),this.prop.animation_promise=null)};c.prototype.zoom=function(a){this.prop.zoom_lvl=d.bound(Math.round(a),0,100);this.prop.vFov=this.config.max_fov+this.prop.zoom_lvl/100*(this.config.min_fov-this.config.max_fov);this.prop.hFov=l.Math.radToDeg(2*Math.atan(Math.tan(l.Math.degToRad(this.prop.vFov)/2)*this.prop.aspect));this.needsUpdate();this.trigger("zoom-updated",this.getZoomLevel())};c.prototype.zoomIn=function(){100>this.prop.zoom_lvl&&this.zoom(this.prop.zoom_lvl+this.config.zoom_speed)};c.prototype.zoomOut=function(){0<this.prop.zoom_lvl&&this.zoom(this.prop.zoom_lvl-this.config.zoom_speed)};c.prototype.resize=function(a){a.width&&(this.container.style.width=a.width);a.height&&(this.container.style.height=a.height);this._onResize()};c.prototype.enterFullscreen=function(){d.requestFullscreen(this.container)};c.prototype.exitFullscreen=function(){d.exitFullscreen()};c.prototype.toggleFullscreen=function(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()};c.prototype.startKeyboardControl=function(){window.addEventListener("keydown",this)};c.prototype.stopKeyboardControl=function(){window.removeEventListener("keydown",this)};c.prototype.preloadPanorama=function(a){if(!this.config.cache_texture)throw new n("Cannot preload panorama, cache_texture is disabled");return this._loadTexture(a)};c.prototype.clearPanoramaCache=function(a){if(!this.config.cache_texture)throw new n("Cannot clear cache, cache_texture is disabled");if(a)for(var b=0,e=this.prop.cache.length;b<e;b++){if(this.prop.cache[b].panorama===a){this.prop.cache.splice(b,1);break}}else this.prop.cache.length=0};c.prototype.getPanoramaCache=function(a){if(!this.config.cache_texture)throw new n("Cannot query cache, cache_texture is disabled");return this.prop.cache.filter(function(b){return b.panorama===a}).shift()};c._loadSystem=function(){var a=c.SYSTEM;a.loaded=!0;a.pixelRatio=window.devicePixelRatio||1;a.isWebGLSupported=d.isWebGLSupported();a.isCanvasSupported=d.isCanvasSupported();a.maxTextureWidth=a.isWebGLSupported?d.getMaxTextureWidth():4096;a.mouseWheelEvent=d.mouseWheelEvent();a.fullscreenEvent=d.fullscreenEvent();a.deviceOrientationSupported=d.isDeviceOrientationSupported();a.touchEnabled=d.isTouchEnabled()};c.prototype._setViewerSize=function(a){["width","height"].forEach(function(b){a[b]&&(/^[0-9.]+$/.test(a[b])&&(a[b]+="px"),this.parent.style[b]=a[b])},this)};c.prototype.textureCoordsToSphericalCoords=function(a){if(this.prop.isCubemap)throw new n("Unable to use texture coords with cubemap.");var b=(a.x+this.prop.pano_data.cropped_x)/this.prop.pano_data.full_width*d.TwoPI;return{longitude:b>=Math.PI?b-Math.PI:b+Math.PI,latitude:d.HalfPI-(a.y+this.prop.pano_data.cropped_y)/this.prop.pano_data.full_height*Math.PI}};c.prototype.sphericalCoordsToTextureCoords=function(a){if(this.prop.isCubemap)throw new n("Unable to use texture coords with cubemap.");var b=a.longitude/d.TwoPI*this.prop.pano_data.full_width,e=a.latitude/Math.PI*this.prop.pano_data.full_height;return{x:parseInt(a.longitude<Math.PI?b+this.prop.pano_data.full_width/2:b-this.prop.pano_data.full_width/2)-this.prop.pano_data.cropped_x,y:parseInt(this.prop.pano_data.full_height/2-e)-this.prop.pano_data.cropped_y}};c.prototype.sphericalCoordsToVector3=function(a){return new l.Vector3(c.SPHERE_RADIUS*-Math.cos(a.latitude)*Math.sin(a.longitude),c.SPHERE_RADIUS*Math.sin(a.latitude),c.SPHERE_RADIUS*Math.cos(a.latitude)*Math.cos(a.longitude))};c.prototype.vector3ToSphericalCoords=function(a){var b=Math.atan2(a.x,a.z);return{longitude:0>b?-b:d.TwoPI-b,latitude:d.HalfPI-Math.acos(a.y/Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z))}};c.prototype.viewerCoordsToVector3=function(a){a=new l.Vector2(2*a.x/this.prop.size.width-1,-2*a.y/this.prop.size.height+1);this.raycaster.setFromCamera(a,this.camera);a=this.raycaster.intersectObjects(this.scene.children);return 1===a.length?a[0].point:null};c.prototype.vector3ToViewerCoords=function(a){a=a.clone();a.project(this.camera);return{x:parseInt((a.x+1)/2*this.prop.size.width),y:parseInt((1-a.y)/2*this.prop.size.height)}};c.prototype.cleanPosition=function(a){a.hasOwnProperty("x")&&a.hasOwnProperty("y")&&d.deepmerge(a,this.textureCoordsToSphericalCoords(a));a.longitude=d.parseAngle(a.longitude);a.latitude=d.parseAngle(a.latitude,!0)};c.prototype.applyRanges=function(a){var b,e,c=[];this.config.longitude_range&&(b=d.clone(this.config.longitude_range),e=l.Math.degToRad(this.prop.hFov)/2,b[0]=d.parseAngle(b[0]+e),b[1]=d.parseAngle(b[1]-e),b[0]>b[1]?a.longitude>b[1]&&a.longitude<b[0]&&(a.longitude>b[0]/2+b[1]/2?(a.longitude=b[0],c.push("left")):(a.longitude=b[1],c.push("right"))):a.longitude<b[0]?(a.longitude=b[0],c.push("left")):a.longitude>b[1]&&(a.longitude=b[1],c.push("right")));this.config.latitude_range&&(b=d.clone(this.config.latitude_range),e=l.Math.degToRad(this.prop.vFov)/2,b[0]=d.parseAngle(Math.min(b[0]+e,b[1]),!0),b[1]=d.parseAngle(Math.max(b[1]-e,b[0]),!0),a.latitude<b[0]?(a.latitude=b[0],c.push("bottom")):a.latitude>b[1]&&(a.latitude=b[1],c.push("top")));return c};k.className=null;k.publicMethods=[];k.prototype.create=function(){this.container=document.createElement("div");this.constructor.className&&(this.container.className=this.constructor.className);this.parent.container.appendChild(this.container)};k.prototype.destroy=function(){this.parent.container.removeChild(this.container);this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(a){delete this.psv[a]},this);delete this.container;delete this.psv;delete this.parent};k.prototype.hide=function(){this.container.style.display="none";this.visible=!1};k.prototype.show=function(){this.container.style.display="";this.visible=!0};p.prototype=Object.create(k.prototype);p.prototype.constructor=p;p.className="psv-hud";p.publicMethods="addMarker removeMarker updateMarker clearMarkers getMarker getCurrentMarker gotoMarker hideMarker showMarker toggleMarker toggleMarkersList showMarkersList hideMarkersList".split(" ");p.prototype.create=function(){k.prototype.create.call(this);this.svgContainer=document.createElementNS(d.svgNS,"svg");this.svgContainer.setAttribute("class","psv-hud-svg-container");this.container.appendChild(this.svgContainer);this.container.addEventListener("mouseenter",this,!0);this.container.addEventListener("mouseleave",this,!0);this.container.addEventListener("mousemove",this,!0);this.psv.on("click",this);this.psv.on("dblclick",this);this.psv.on("render",this);this.psv.on("open-panel",this);this.psv.on("close-panel",this)};p.prototype.destroy=function(){this.clearMarkers(!1);this.container.removeEventListener("mouseenter",this);this.container.removeEventListener("mouseleave",this);this.container.removeEventListener("mousemove",this);this.psv.off("click",this);this.psv.off("dblclick",this);this.psv.off("render",this);this.psv.off("open-panel",this);this.psv.off("close-panel",this);delete this.svgContainer;k.prototype.destroy.call(this)};p.prototype.handleEvent=function(a){switch(a.type){case "mouseenter":this._onMouseEnter(a);break;case "mouseleave":this._onMouseLeave(a);break;case "mousemove":this._onMouseMove(a);break;case "click":this._onClick(a.args[0],a,!1);break;case "dblclick":this._onClick(a.args[0],a,!0);break;case "render":this.renderMarkers();break;case "open-panel":this._onPanelOpened();break;case "close-panel":this._onPanelClosed()}};p.prototype.addMarker=function(a,b){if(!a.id)throw new n("missing marker id");if(this.markers[a.id])throw new n('marker "'+a.id+'" already exists');var e=new u(a,this.psv);e.isNormal()?this.container.appendChild(e.$el):this.svgContainer.appendChild(e.$el);this.markers[e.id]=e;!1!==b&&this.renderMarkers();return e};p.prototype.getMarker=function(a){a="object"===typeof a?a.id:a;if(!this.markers[a])throw new n('cannot find marker "'+a+'"');return this.markers[a]};p.prototype.getCurrentMarker=function(){return this.currentMarker};p.prototype.updateMarker=function(a,b){var e=this.getMarker(a);e.update(a);!1!==b&&this.renderMarkers();return e};p.prototype.removeMarker=function(a,b){a=this.getMarker(a);a.isNormal()?this.container.removeChild(a.$el):this.svgContainer.removeChild(a.$el);this.hoveringMarker===a&&this.psv.tooltip.hideTooltip();a.destroy();delete this.markers[a.id];!1!==b&&this.renderMarkers()};p.prototype.clearMarkers=function(a){Object.keys(this.markers).forEach(function(a){this.removeMarker(a,!1)},this);!1!==a&&this.renderMarkers()};p.prototype.gotoMarker=function(a,b){a=this.getMarker(a);return this.psv.animate(a,b).then(function(){this.psv.trigger("goto-marker-done",a)}.bind(this))};p.prototype.hideMarker=function(a){this.getMarker(a).visible=!1;this.renderMarkers()};p.prototype.showMarker=function(a){this.getMarker(a).visible=!0;this.renderMarkers()};p.prototype.toggleMarker=function(a){this.getMarker(a).visible^=1;this.renderMarkers()};p.prototype.toggleMarkersList=function(){this.prop.panelOpened?this.hideMarkersList():this.showMarkersList()};p.prototype.showMarkersList=function(){var a=[];d.forEach(this.markers,function(b){a.push(b)});var b=this.psv.config.templates.markersList({markers:this.psv.change("render-markers-list",a),config:this.psv.config});this.prop.panelOpening=!0;this.psv.panel.showPanel(b,!0);this.psv.panel.container.querySelector(".psv-markers-list").addEventListener("click",this._onClickItem.bind(this))};p.prototype.hideMarkersList=function(){this.prop.panelOpened&&this.psv.panel.hidePanel()};p.prototype.renderMarkers=function(){if(this.visible){var a=this.psv.isGyroscopeEnabled()?l.Math.radToDeg(this.psv.camera.rotation.z):0;d.forEach(this.markers,function(b){var e=b.visible;if(e&&b.isPoly()){var c=this._getPolyPositions(b);if(e=c.length>(b.isPolygon()?2:1))b.position2D=this._getPolyDimensions(b,c),c=c.map(function(a){return a.x+","+a.y}).join(" "),b.$el.setAttributeNS(null,"points",c)}else if(e&&(c=this._getMarkerPosition(b),e=this._isMarkerVisible(b,c))){b.position2D=c;var f=b.getScale(this.psv.getZoomLevel());b.isSvg()?b.$el.setAttributeNS(null,"transform","translate("+c.x+", "+c.y+")"+(1!==f?" scale("+f+", "+f+")":"")+(!b.lockRotation&&a?" rotate("+a+")":"")):b.$el.style.transform="translate3D("+c.x+"px, "+c.y+"px, 0px)"+(1!==f?" scale("+f+", "+f+")":"")+(!b.lockRotation&&a?" rotateZ("+a+"deg)":"")}d.toggleClass(b.$el,"psv-marker--visible",e)}.bind(this))}};p.prototype._isMarkerVisible=function(a,b){return 0<a.position3D.dot(this.psv.prop.direction)&&0<=b.x+a.width&&b.x-a.width<=this.psv.prop.size.width&&0<=b.y+a.height&&b.y-a.height<=this.psv.prop.size.height};p.prototype._getMarkerPosition=function(a){if(a._dynamicSize){d.toggleClass(a.$el,"psv-marker--transparent",!0);var b=a.$el.style.transform;a.$el.style.transform=null;var e=a.$el.getBoundingClientRect();a.$el.style.transform=b;d.toggleClass(a.$el,"psv-marker--transparent",!1);a.width=e.right-e.left;a.height=e.bottom-e.top}b=this.psv.vector3ToViewerCoords(a.position3D);b.x-=a.width*a.anchor.left;b.y-=a.height*a.anchor.top;return b};p.prototype._getPolyPositions=function(a){var b=a.positions3D.length,e=a.positions3D.map(function(a){return{vector:a,visible:0<a.dot(this.psv.prop.direction)}},this),c=[];e.forEach(function(a,d){a.visible||[0===d?e[b-1]:e[d-1],d===b-1?e[0]:e[d+1]].forEach(function(b){b.visible&&c.push({visible:b,invisible:a,index:d})})});c.reverse().forEach(function(a){e.splice(a.index,0,{vector:this._getPolyIntermediaryPoint(a.visible.vector,a.invisible.vector),visible:!0})},this);return e.filter(function(a){return a.visible}).map(function(a){return this.psv.vector3ToViewerCoords(a.vector)},this)};p.prototype._getPolyIntermediaryPoint=function(a,b){var e=this.psv.prop.direction.clone().normalize(),d=(new l.Vector3).crossVectors(a,b).normalize(),d=(new l.Vector3).crossVectors(d,a).normalize(),d=(new l.Vector3).addVectors(a.clone().multiplyScalar(-e.dot(d)),d.clone().multiplyScalar(e.dot(a))).normalize(),e=(new l.Vector3).crossVectors(d,e);return d.applyAxisAngle(e,.01).multiplyScalar(c.SPHERE_RADIUS)};p.prototype._getPolyDimensions=function(a,b){var e=Infinity,c=Infinity,d=-Infinity,m=-Infinity;b.forEach(function(a){e=Math.min(e,a.x);c=Math.min(c,a.y);d=Math.max(d,a.x);m=Math.max(m,a.y)});a.width=d-e;a.height=m-c;return{x:e,y:c}};p.prototype._onMouseEnter=function(a){var b;a.target&&(b=a.target.psvMarker)&&!b.isPoly()&&(this.hoveringMarker=b,this.psv.trigger("over-marker",b),b.tooltip&&this.psv.tooltip.showTooltip({content:b.tooltip.content,position:b.tooltip.position,left:b.position2D.x,top:b.position2D.y,box:{width:b.width,height:b.height}}))};p.prototype._onMouseLeave=function(a){var b;!a.target||!(b=a.target.psvMarker)||b.isPoly()&&a.relatedTarget&&d.hasParent(a.relatedTarget,this.psv.tooltip.container)||(this.psv.trigger("leave-marker",b),this.hoveringMarker=null,this.psv.tooltip.hideTooltip())};p.prototype._onMouseMove=function(a){if(!this.psv.prop.moving){var b;if(a.target&&(b=a.target.psvMarker)&&b.isPoly()||a.target&&d.hasParent(a.target,this.psv.tooltip.container)&&(b=this.hoveringMarker)){this.hoveringMarker||(this.psv.trigger("over-marker",b),this.hoveringMarker=b);var e=this.psv.container.getBoundingClientRect();b.tooltip&&this.psv.tooltip.showTooltip({content:b.tooltip.content,position:b.tooltip.position,top:a.clientY-e.top-this.psv.config.tooltip.arrow_size/2,left:a.clientX-e.left-this.psv.config.tooltip.arrow_size,box:{width:2*this.psv.config.tooltip.arrow_size,height:2*this.psv.config.tooltip.arrow_size}})}else this.hoveringMarker&&this.hoveringMarker.isPoly()&&(this.psv.trigger("leave-marker",this.hoveringMarker),this.hoveringMarker=null,this.psv.tooltip.hideTooltip())}};p.prototype._onClick=function(a,b,e){var c;a.target&&(c=d.getClosest(a.target,".psv-marker"))&&c.psvMarker?(this.currentMarker=c.psvMarker,this.psv.trigger("select-marker",this.currentMarker,e),this.psv.config.click_event_on_marker?a.marker=c.psvMarker:b.stopPropagation()):this.currentMarker&&(this.psv.trigger("unselect-marker",this.currentMarker),this.currentMarker=null);c&&c.psvMarker&&c.psvMarker.content?this.psv.panel.showPanel(c.psvMarker.content):this.psv.panel.prop.opened&&(b.stopPropagation(),this.psv.panel.hidePanel())};p.prototype._onClickItem=function(a){var b;a.target&&(b=d.getClosest(a.target,"li"))&&b.dataset.psvMarker&&(a=this.getMarker(b.dataset.psvMarker),this.psv.trigger("select-marker-list",a),this.gotoMarker(a,1E3),this.psv.panel.hidePanel())};p.prototype._onPanelOpened=function(){this.prop.panelOpening?(this.prop.panelOpening=!1,this.prop.panelOpened=!0):this.prop.panelOpened=!1;this.prop.markersButton&&this.prop.markersButton.toggleActive(this.prop.panelOpened)};p.prototype._onPanelClosed=function(){this.prop.panelOpened=!1;this.prop.panelOpening=!1;this.prop.markersButton&&this.prop.markersButton.toggleActive(!1)};I.prototype=Object.create(k.prototype);I.prototype.constructor=I;I.className="psv-loader-container";I.prototype.create=function(){k.prototype.create.call(this);var a=c.SYSTEM.pixelRatio;this.loader=document.createElement("div");this.loader.className="psv-loader";this.container.appendChild(this.loader);this.canvas=document.createElement("canvas");this.canvas.className="psv-loader-canvas";this.canvas.width=this.loader.clientWidth*a;this.canvas.height=this.loader.clientWidth*a;this.loader.appendChild(this.canvas);this.tickness=(this.loader.offsetWidth-this.loader.clientWidth)/2*a;var b;this.psv.config.loading_img?(b=document.createElement("img"),b.className="psv-loader-image",b.src=this.psv.config.loading_img):this.psv.config.loading_txt&&(b=document.createElement("div"),b.className="psv-loader-text",b.innerHTML=this.psv.config.loading_txt);b&&(a=Math.round(Math.sqrt(2*Math.pow((this.canvas.width/2-this.tickness/2)/a,2))),b.style.maxWidth=a+"px",b.style.maxHeight=a+"px",this.loader.appendChild(b))};I.prototype.destroy=function(){delete this.loader;delete this.canvas;k.prototype.destroy.call(this)};I.prototype.setProgress=function(a){var b=this.canvas.getContext("2d");b.clearRect(0,0,this.canvas.width,this.canvas.height);b.lineWidth=this.tickness;b.strokeStyle=d.getStyle(this.loader,"color");b.beginPath();b.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2-this.tickness/2,-Math.PI/2,a/100*2*Math.PI-Math.PI/2);b.stroke()};B.prototype=Object.create(k.prototype);B.prototype.constructor=B;B.className="psv-navbar psv-navbar--open";B.publicMethods=["showNavbar","hideNavbar","toggleNavbar","getNavbarButton"];B.prototype.create=function(){k.prototype.create.call(this);this.config.forEach(function(a){if("object"===typeof a)this.items.push(new J(this,a));else switch(a){case y.id:this.items.push(new y(this));break;case r.id:this.items.push(new r(this));break;case G.id:this.items.push(new G(this));break;case H.id:this.items.push(new H(this));break;case x.id:this.items.push(new x(this));break;case A.id:this.items.push(new A(this));break;case z.id:this.items.push(new z(this));break;case "caption":this.items.push(new E(this,this.psv.config.caption));break;default:if(0===a.indexOf("spacer"))console.warn("warning: navbar spacers have been removed.");else throw new n("Unknown button "+a);}},this)};B.prototype.destroy=function(){this.items.forEach(function(a){a.destroy()});this.items.length=0;delete this.config;k.prototype.destroy.call(this)};B.prototype.getNavbarButton=function(a,b){var e=null;this.items.some(function(b){return b.id===a?(e=b,!0):!1});e||b||console.warn('warning: button "'+a+'" not found in the navbar.');return e};B.prototype.showNavbar=function(){this.toggleNavbar(!0)};B.prototype.hideNavbar=function(){this.toggleNavbar(!1)};B.prototype.toggleNavbar=function(a){d.toggleClass(this.container,"psv-navbar--open",a)};E.prototype=Object.create(k.prototype);E.prototype.constructor=E;E.className="psv-caption";E.publicMethods=["setCaption"];E.prototype.create=function(){k.prototype.create.call(this);this.button=new F(this);this.button.hide();this.content=document.createElement("div");this.content.className="psv-caption-content";this.container.appendChild(this.content);window.addEventListener("resize",this)};E.prototype.destroy=function(){window.removeEventListener("resize",this);delete this.content;k.prototype.destroy.call(this)};E.prototype.handleEvent=function(a){switch(a.type){case "resize":this._onResize()}};E.prototype.setCaption=function(a){this.prop.caption=a?a:"";this.content.innerHTML=this.prop.caption;this.content.style.display="";this.prop.width=this.content.offsetWidth;this._onResize()};E.prototype._onResize=function(){parseInt(d.getStyle(this.container,"width"))>=this.prop.width?(this.button.hide(),this.content.style.display=""):(this.button.show(),this.content.style.display="none")};C.prototype=Object.create(k.prototype);C.prototype.constructor=C;C.className="psv-notification";C.publicMethods=["showNotification","hideNotification","isNotificationVisible"];C.prototype.create=function(){k.prototype.create.call(this);this.content=document.createElement("div");this.content.className="psv-notification-content";this.container.appendChild(this.content);this.content.addEventListener("click",this.hideNotification.bind(this))};C.prototype.destroy=function(){delete this.content;k.prototype.destroy.call(this)};C.prototype.isNotificationVisible=function(){return this.container.classList.contains("psv-notification--visible")};C.prototype.showNotification=function(a){"string"===typeof a&&(a={content:a});this.content.innerHTML=a.content;this.container.classList.add("psv-notification--visible");this.psv.trigger("show-notification");a.timeout&&setTimeout(this.hideNotification.bind(this),a.timeout)};C.prototype.hideNotification=function(){this.isNotificationVisible()&&(this.container.classList.remove("psv-notification--visible"),this.psv.trigger("hide-notification"))};D.prototype=Object.create(k.prototype);D.prototype.constructor=D;D.className="psv-overlay";D.publicMethods=["showOverlay","hideOverlay","isOverlayVisible"];D.prototype.create=function(){k.prototype.create.call(this);this.image=document.createElement("div");this.image.className="psv-overlay-image";this.container.appendChild(this.image);this.text=document.createElement("div");this.text.className="psv-overlay-text";this.container.appendChild(this.text);this.subtext=document.createElement("div");this.subtext.className="psv-overlay-subtext";this.container.appendChild(this.subtext);this.container.addEventListener("click",this.hideOverlay.bind(this))};D.prototype.destroy=function(){delete this.image;delete this.text;delete this.subtext;k.prototype.destroy.call(this)};D.prototype.isOverlayVisible=function(){return this.visible};D.prototype.showOverlay=function(a){"string"===typeof a&&(a={text:a});this.image.innerHTML=a.image||"";this.text.innerHTML=a.text||"";this.subtext.innerHTML=a.subtext||"";this.show();this.psv.trigger("show-overlay")};D.prototype.hideOverlay=function(){this.isOverlayVisible()&&(this.hide(),this.psv.trigger("hide-overlay"))};v.prototype=Object.create(k.prototype);v.prototype.constructor=v;v.className="psv-panel";v.publicMethods=["showPanel","hidePanel"];v.prototype.create=function(){k.prototype.create.call(this);this.container.innerHTML='\x3cdiv class\x3d"psv-panel-resizer"\x3e\x3c/div\x3e\x3cdiv class\x3d"psv-panel-close-button"\x3e\x3c/div\x3e\x3cdiv class\x3d"psv-panel-content"\x3e\x3c/div\x3e';this.content=this.container.querySelector(".psv-panel-content");this.container.querySelector(".psv-panel-close-button").addEventListener("click",this.hidePanel.bind(this));this.psv.config.mousewheel&&this.container.addEventListener(c.SYSTEM.mouseWheelEvent,function(a){a.stopPropagation()});var a=this.container.querySelector(".psv-panel-resizer");a.addEventListener("mousedown",this);a.addEventListener("touchstart",this);this.psv.container.addEventListener("mouseup",this);this.psv.container.addEventListener("touchend",this);this.psv.container.addEventListener("mousemove",this);this.psv.container.addEventListener("touchmove",this)};v.prototype.destroy=function(){this.psv.container.removeEventListener("mousemove",this);this.psv.container.removeEventListener("touchmove",this);this.psv.container.removeEventListener("mouseup",this);this.psv.container.removeEventListener("touchend",this);delete this.prop;delete this.content;k.prototype.destroy.call(this)};v.prototype.handleEvent=function(a){switch(a.type){case "mousedown":this._onMouseDown(a);break;case "touchstart":this._onTouchStart(a);break;case "mousemove":this._onMouseMove(a);break;case "touchmove":this._onTouchMove(a);break;case "mouseup":this._onMouseUp(a);break;case "touchend":this._onMouseUp(a)}};v.prototype.showPanel=function(a,b){this.content.innerHTML=a;this.content.scrollTop=0;this.container.classList.add("psv-panel--open");d.toggleClass(this.content,"psv-panel-content--no-margin",!0===b);this.prop.opened=!0;this.psv.trigger("open-panel")};v.prototype.hidePanel=function(){this.content.innerHTML=null;this.prop.opened=!1;this.container.classList.remove("psv-panel--open");this.psv.trigger("close-panel")};v.prototype._onMouseDown=function(a){a.stopPropagation();this._startResize(a)};v.prototype._onTouchStart=function(a){a.stopPropagation();this._startResize(a.changedTouches[0])};v.prototype._onMouseUp=function(a){this.prop.mousedown&&(a.stopPropagation(),this.prop.mousedown=!1,this.content.classList.remove("psv-panel-content--no-interaction"))};v.prototype._onMouseMove=function(a){this.prop.mousedown&&(a.stopPropagation(),this._resize(a))};v.prototype._onTouchMove=function(a){this.prop.mousedown&&this._resize(a.touches[0])};v.prototype._startResize=function(a){this.prop.mouse_x=parseInt(a.clientX);this.prop.mouse_y=parseInt(a.clientY);this.prop.mousedown=!0;this.content.classList.add("psv-panel-content--no-interaction")};v.prototype._resize=function(a){var b=parseInt(a.clientX);a=parseInt(a.clientY);this.container.style.width=this.container.offsetWidth-(b-this.prop.mouse_x)+"px";this.prop.mouse_x=b;this.prop.mouse_y=a};t.prototype=Object.create(k.prototype);t.prototype.constructor=t;t.className="psv-tooltip";t.publicMethods=["showTooltip","hideTooltip","isTooltipVisible"];t.leftMap={0:"left","0.5":"center",1:"right"};t.topMap={0:"top","0.5":"center",1:"bottom"};t.prototype.create=function(){k.prototype.create.call(this);this.container.innerHTML='\x3cdiv class\x3d"psv-tooltip-arrow"\x3e\x3c/div\x3e\x3cdiv class\x3d"psv-tooltip-content"\x3e\x3c/div\x3e';this.container.style.top="-1000px";this.container.style.left="-1000px";this.content=this.container.querySelector(".psv-tooltip-content");this.arrow=this.container.querySelector(".psv-tooltip-arrow");this.psv.on("render",this)};t.prototype.destroy=function(){this.psv.off("render",this);delete this.config;delete this.prop;k.prototype.destroy.call(this)};t.prototype.handleEvent=function(a){switch(a.type){case "render":this.hideTooltip()}};t.prototype.isTooltipVisible=function(){return this.container.classList.contains("psv-tooltip--visible")};t.prototype.showTooltip=function(a){this.prop.timeout&&(window.clearTimeout(this.prop.timeout),this.prop.timeout=null);var b=this.isTooltipVisible(),e=this.container,c=this.content,f=this.arrow;a.position||(a.position=["top","center"]);a.box||(a.box={width:0,height:0});if("string"===typeof a.position){var m=d.parsePosition(a.position);if(!(m.left in t.leftMap&&m.top in t.topMap))throw new n('unable to parse tooltip position "'+a.position+'"');a.position=[t.topMap[m.top],t.leftMap[m.left]]}if("center"===a.position[0]&&"center"===a.position[1])throw new n('unable to parse tooltip position "center center"');if(b)for(m=e.classList.length-1;0<=m;m--){var q=e.classList.item(m);"psv-tooltip"!==q&&"psv-tooltip--visible"!==q&&e.classList.remove(q)}else e.className="psv-tooltip";a.className&&d.addClasses(e,a.className);c.innerHTML=a.content;e.style.top="0px";e.style.left="0px";c=e.getBoundingClientRect();c={posClass:a.position.slice(),width:c.right-c.left,height:c.bottom-c.top,top:0,left:0,arrow_top:0,arrow_left:0};this._computeTooltipPosition(c,a);m=!1;c.top<this.config.offset?(c.posClass[0]="bottom",m=!0):c.top+c.height>this.psv.prop.size.height-this.config.offset&&(c.posClass[0]="top",m=!0);c.left<this.config.offset?(c.posClass[1]="right",m=!0):c.left+c.width>this.psv.prop.size.width-this.config.offset&&(c.posClass[1]="left",m=!0);m&&this._computeTooltipPosition(c,a);e.style.top=c.top+"px";e.style.left=c.left+"px";f.style.top=c.arrow_top+"px";f.style.left=c.arrow_left+"px";e.classList.add("psv-tooltip--"+c.posClass.join("-"));b||(this.prop.timeout=window.setTimeout(function(){e.classList.add("psv-tooltip--visible");this.prop.timeout=null;this.psv.trigger("show-tooltip")}.bind(this),this.config.delay))};t.prototype.hideTooltip=function(){this.prop.timeout&&(window.clearTimeout(this.prop.timeout),this.prop.timeout=null);this.isTooltipVisible()&&(this.container.classList.remove("psv-tooltip--visible"),this.prop.timeout=window.setTimeout(function(){this.content.innerHTML=null;this.container.style.top="-1000px";this.container.style.left="-1000px";this.prop.timeout=null}.bind(this),this.config.delay),this.psv.trigger("hide-tooltip"))};t.prototype._computeTooltipPosition=function(a,b){var e=!1;switch(a.posClass[0]){case "bottom":a.top=b.top+b.box.height+this.config.offset+this.config.arrow_size;a.arrow_top=2*-this.config.arrow_size;e=!0;break;case "center":a.top=b.top+b.box.height/2-a.height/2;a.arrow_top=a.height/2-this.config.arrow_size;break;case "top":a.top=b.top-a.height-this.config.offset-this.config.arrow_size,a.arrow_top=a.height,e=!0}switch(a.posClass[1]){case "right":e?(a.left=b.left+b.box.width/2-this.config.offset-this.config.arrow_size,a.arrow_left=this.config.offset):(a.left=b.left+b.box.width+this.config.offset+this.config.arrow_size,a.arrow_left=2*-this.config.arrow_size);break;case "center":a.left=b.left+b.box.width/2-a.width/2;a.arrow_left=a.width/2-this.config.arrow_size;break;case "left":e?(a.left=b.left-a.width+b.box.width/2+this.config.offset+this.config.arrow_size,a.arrow_left=a.width-this.config.offset-2*this.config.arrow_size):(a.left=b.left-a.width-this.config.offset-this.config.arrow_size,a.arrow_left=a.width)}};g.prototype=Object.create(k.prototype);g.prototype.constructor=g;g.id=null;g.icon=null;g.iconActive=null;g.prototype.create=function(){k.prototype.create.call(this);this.constructor.icon&&this._setIcon(this.constructor.icon);this.id&&this.psv.config.lang[this.id]&&(this.container.title=this.psv.config.lang[this.id]);this.container.addEventListener("click",function(a){this.enabled&&this._onClick();a.stopPropagation()}.bind(this));var a=this.supported();"function"===typeof a.then?(this.hide(),a.then(function(a){a&&this.show()}.bind(this))):a||this.hide()};g.prototype.destroy=function(){k.prototype.destroy.call(this)};g.prototype.supported=function(){return!0};g.prototype.toggleActive=function(a){d.toggleClass(this.container,"psv-button--active",a);this.constructor.iconActive&&this._setIcon(a?this.constructor.iconActive:this.constructor.icon)};g.prototype.disable=function(){this.container.classList.add("psv-button--disabled");this.enabled=!1};g.prototype.enable=function(){this.container.classList.remove("psv-button--disabled");this.enabled=!0};g.prototype._setIcon=function(a,b){b||(b=this.container);a?(b.innerHTML=c.ICONS[a],b.querySelector("svg").setAttribute("class","psv-button-svg")):b.innerHTML=""};g.prototype._onClick=function(){};y.prototype=Object.create(g.prototype);y.prototype.constructor=y;y.id="autorotate";y.className="psv-button psv-button--hover-scale psv-autorotate-button";y.icon="play.svg";y.iconActive="play-active.svg";y.prototype.create=function(){g.prototype.create.call(this);this.psv.on("autorotate",this)};y.prototype.destroy=function(){this.psv.off("autorotate",this);g.prototype.destroy.call(this)};y.prototype.handleEvent=function(a){switch(a.type){case "autorotate":this.toggleActive(a.args[0])}};y.prototype._onClick=function(){this.psv.toggleAutorotate()};F.prototype=Object.create(g.prototype);F.prototype.constructor=F;F.id="markers";F.className="psv-button psv-button--hover-scale psv-caption-button";F.icon="info.svg";F.prototype.create=function(){g.prototype.create.call(this);this.psv.on("hide-notification",this)};F.prototype.destroy=function(){this.psv.off("hide-notification",this);g.prototype.destroy.call(this)};F.prototype.handleEvent=function(a){switch(a.type){case "hide-notification":this.toggleActive(!1)}};F.prototype._onClick=function(){this.psv.isNotificationVisible()?this.psv.hideNotification():(this.psv.showNotification(this.parent.prop.caption),this.toggleActive(!0))};J.prototype=Object.create(g.prototype);J.prototype.constructor=J;J.className="psv-button psv-custom-button";J.prototype.create=function(){g.prototype.create.call(this);this.config.className&&d.addClasses(this.container,this.config.className);this.config.title&&(this.container.title=this.config.title);this.config.content&&(this.container.innerHTML=this.config.content);!1!==this.config.enabled&&!0!==this.config.disabled||this.disable();!1!==this.config.visible&&!0!==this.config.hidden||this.hide()};J.prototype.destroy=function(){delete this.config;g.prototype.destroy.call(this)};J.prototype._onClick=function(){this.config.onClick&&this.config.onClick.apply(this.psv)};G.prototype=Object.create(g.prototype);G.prototype.constructor=G;G.id="download";G.className="psv-button psv-button--hover-scale psv-download-button";G.icon="download.svg";G.prototype._onClick=function(){var a=document.createElement("a");a.href=this.psv.config.panorama;a.download=this.psv.config.panorama;this.psv.container.appendChild(a);a.click()};x.prototype=Object.create(g.prototype);x.prototype.constructor=x;x.id="fullscreen";x.className="psv-button psv-button--hover-scale psv-fullscreen-button";x.icon="fullscreen-in.svg";x.iconActive="fullscreen-out.svg";x.prototype.create=function(){g.prototype.create.call(this);this.psv.on("fullscreen-updated",this)};x.prototype.destroy=function(){this.psv.off("fullscreen-updated",this);g.prototype.destroy.call(this)};x.prototype.supported=function(){return!!c.SYSTEM.fullscreenEvent};x.prototype.handleEvent=function(a){switch(a.type){case "fullscreen-updated":this.toggleActive(a.args[0])}};x.prototype._onClick=function(){this.psv.toggleFullscreen()};z.prototype=Object.create(g.prototype);z.prototype.constructor=z;z.id="gyroscope";z.className="psv-button psv-button--hover-scale psv-gyroscope-button";z.icon="compass.svg";z.prototype.create=function(){g.prototype.create.call(this);this.psv.on("gyroscope-updated",this)};z.prototype.destroy=function(){this.psv.off("gyroscope-updated",this);g.prototype.destroy.call(this)};z.prototype.supported=function(){return d.checkTHREE("DeviceOrientationControls")?c.SYSTEM.deviceOrientationSupported:!1};z.prototype.handleEvent=function(a){switch(a.type){case "gyroscope-updated":this.toggleActive(a.args[0])}};z.prototype._onClick=function(){this.psv.toggleGyroscopeControl()};H.prototype=Object.create(g.prototype);H.prototype.constructor=H;H.id="markers";H.className="psv-button psv-button--hover-scale psv-markers-button";H.icon="pin.svg";H.prototype._onClick=function(){this.psv.hud.toggleMarkersList()};A.prototype=Object.create(g.prototype);A.prototype.constructor=A;A.id="stereo";A.className="psv-button psv-button--hover-scale psv-stereo-button";A.icon="stereo.svg";A.prototype.create=function(){g.prototype.create.call(this);this.psv.on("stereo-updated",this)};A.prototype.destroy=function(){this.psv.off("stereo-updated",this);g.prototype.destroy.call(this)};A.prototype.supported=function(){return c.SYSTEM.fullscreenEvent&&d.checkTHREE("DeviceOrientationControls")?c.SYSTEM.deviceOrientationSupported:!1};A.prototype.handleEvent=function(a){switch(a.type){case "stereo-updated":this.toggleActive(a.args[0])}};A.prototype._onClick=function(){this.psv.toggleStereoView()};r.prototype=Object.create(g.prototype);r.prototype.constructor=r;r.id="zoom";r.className="psv-button psv-zoom-button";r.prototype.create=function(){g.prototype.create.call(this);var a=document.createElement("div");a.className="psv-zoom-button-minus";a.title=this.psv.config.lang.zoomOut;this._setIcon("zoom-out.svg",a);this.container.appendChild(a);var b=document.createElement("div");b.className="psv-zoom-button-range";this.container.appendChild(b);this.zoom_range=document.createElement("div");this.zoom_range.className="psv-zoom-button-line";b.appendChild(this.zoom_range);this.zoom_value=document.createElement("div");this.zoom_value.className="psv-zoom-button-handle";this.zoom_range.appendChild(this.zoom_value);b=document.createElement("div");b.className="psv-zoom-button-plus";b.title=this.psv.config.lang.zoomIn;this._setIcon("zoom-in.svg",b);this.container.appendChild(b);this.zoom_range.addEventListener("mousedown",this);this.zoom_range.addEventListener("touchstart",this);this.psv.container.addEventListener("mousemove",this);this.psv.container.addEventListener("touchmove",this);this.psv.container.addEventListener("mouseup",this);this.psv.container.addEventListener("touchend",this);a.addEventListener("mousedown",this._zoomOut.bind(this));b.addEventListener("mousedown",this._zoomIn.bind(this));this.psv.on("zoom-updated",this);this.psv.once("ready",function(){this._moveZoomValue(this.psv.prop.zoom_lvl)}.bind(this))};r.prototype.destroy=function(){this._stopZoomChange();this.psv.container.removeEventListener("mousemove",this);this.psv.container.removeEventListener("touchmove",this);this.psv.container.removeEventListener("mouseup",this);this.psv.container.removeEventListener("touchend",this);delete this.zoom_range;delete this.zoom_value;this.psv.off("zoom-updated",this);g.prototype.destroy.call(this)};r.prototype.handleEvent=function(a){switch(a.type){case "mousedown":this._initZoomChangeWithMouse(a);break;case "touchstart":this._initZoomChangeByTouch(a);break;case "mousemove":this._changeZoomWithMouse(a);break;case "touchmove":this._changeZoomByTouch(a);break;case "mouseup":this._stopZoomChange(a);break;case "touchend":this._stopZoomChange(a);break;case "zoom-updated":this._moveZoomValue(a.args[0])}};r.prototype._moveZoomValue=function(a){this.zoom_value.style.left=a/100*this.zoom_range.offsetWidth-this.zoom_value.offsetWidth/2+"px"};r.prototype._initZoomChangeWithMouse=function(a){this.enabled&&(this.prop.mousedown=!0,this._changeZoom(a.clientX))};r.prototype._initZoomChangeByTouch=function(a){this.enabled&&(this.prop.mousedown=!0,this._changeZoom(a.changedTouches[0].clientX))};r.prototype._zoomIn=function(){this.enabled&&(this.prop.buttondown=!0,this.psv.zoomIn(),this.prop.longPressTimeout=window.setTimeout(this._startLongPressInterval.bind(this,1),200))};r.prototype._zoomOut=function(){this.enabled&&(this.prop.buttondown=!0,this.psv.zoomOut(),this.prop.longPressTimeout=window.setTimeout(this._startLongPressInterval.bind(this,-1),200))};r.prototype._startLongPressInterval=function(a){this.prop.buttondown&&(this.prop.longPressInterval=window.setInterval(function(){this.psv.zoom(this.psv.prop.zoom_lvl+a)}.bind(this),50))};r.prototype._stopZoomChange=function(){this.enabled&&(window.clearInterval(this.prop.longPressInterval),window.clearTimeout(this.prop.longPressTimeout),this.prop.longPressInterval=null,this.prop.mousedown=!1,this.prop.buttondown=!1)};r.prototype._changeZoomWithMouse=function(a){this.enabled&&(a.preventDefault(),this._changeZoom(a.clientX))};r.prototype._changeZoomByTouch=function(a){this.enabled&&this._changeZoom(a.changedTouches[0].clientX)};r.prototype._changeZoom=function(a){this.prop.mousedown&&(a=(parseInt(a)-this.zoom_range.getBoundingClientRect().left)/this.zoom_range.offsetWidth*100,this.psv.zoom(a))};n.prototype=Object.create(Error.prototype);n.prototype.name="PSVError";n.prototype.constructor=n;c.Error=n;u.types="image html polygon_px polygon_rad polyline_px polyline_rad rect circle ellipse path".split(" ");u.getType=function(a,b){var e=[];u.types.forEach(function(b){a[b]&&e.push(b)});if(0===e.length&&!b)throw new n("missing marker content, either "+u.types.join(", "));if(1<e.length)throw new n("multiple marker content, either "+u.types.join(", "));return e[0]};u.prototype.destroy=function(){delete this.$el.psvMarker};u.prototype.isNormal=function(){return"image"===this.type||"html"===this.type};u.prototype.isPoly=function(){return this.isPolygon()||this.isPolyline()};u.prototype.isPolygon=function(){return"polygon_px"===this.type||"polygon_rad"===this.type};u.prototype.isPolyline=function(){return"polyline_px"===this.type||"polyline_rad"===this.type};u.prototype.isSvg=function(){return"rect"===this.type||"circle"===this.type||"ellipse"===this.type||"path"===this.type};u.prototype.getScale=function(a){return Array.isArray(this.scale)?this.scale[0]+(this.scale[1]-this.scale[0])*d.animation.easings.inQuad(a/100):"function"===typeof this.scale?this.scale(a):"number"===typeof this.scale?this.scale*d.animation.easings.inQuad(a/100):1};u.prototype.update=function(a){if(a&&a!==this){var b=u.getType(a,!0);if(void 0!==b&&b!==this.type)throw new n("cannot change marker type");d.deepmerge(this,a)}this.isNormal()?this.$el.setAttribute("class","psv-marker psv-marker--normal"):this.$el.setAttribute("class","psv-marker psv-marker--svg");this.className&&d.addClasses(this.$el,this.className);this.tooltip&&(d.addClasses(this.$el,"has-tooltip"),"string"===typeof this.tooltip&&(this.tooltip={content:this.tooltip}));this.style&&d.deepmerge(this.$el.style,this.style);this.anchor=d.parsePosition(this.anchor);this.isNormal()?this._updateNormal():this.isPolygon()?this._updatePoly("polygon_rad","polygon_px"):this.isPolyline()?this._updatePoly("polyline_rad","polyline_px"):this._updateSvg()};u.prototype._updateNormal=function(){this.width&&this.height?(this.$el.style.width=this.width+"px",this.$el.style.height=this.height+"px",this._dynamicSize=!1):this._dynamicSize=!0;this.image?this.$el.style.backgroundImage="url("+this.image+")":this.$el.innerHTML=this.html;this.$el.style.transformOrigin=100*this.anchor.left+"% "+100*this.anchor.top+"%";this.psv.cleanPosition(this);this.position3D=this.psv.sphericalCoordsToVector3(this)};u.prototype._updateSvg=function(){this._dynamicSize=!0;switch(this.type){case "rect":"number"===typeof this._def?this._def={x:0,y:0,width:this._def,height:this._def}:Array.isArray(this._def)?this._def={x:0,y:0,width:this._def[0],height:this._def[1]}:this._def.x=this._def.y=0;break;case "circle":"number"===typeof this._def?this._def={cx:this._def,cy:this._def,r:this._def}:Array.isArray(this._def)?this._def={cx:this._def[0],cy:this._def[0],r:this._def[0]}:this._def.cx=this._def.cy=this._def.r;break;case "ellipse":"number"===typeof this._def?this._def={cx:this._def,cy:this._def,rx:this._def,ry:this._def}:Array.isArray(this._def)?this._def={cx:this._def[0],cy:this._def[1],rx:this._def[0],ry:this._def[1]}:(this._def.cx=this._def.rx,this._def.cy=this._def.ry);break;case "path":"string"===typeof this._def&&(this._def={d:this._def})}Object.getOwnPropertyNames(this._def).forEach(function(a){this.$el.setAttributeNS(null,a,this._def[a])},this);this.svgStyle?Object.getOwnPropertyNames(this.svgStyle).forEach(function(a){this.$el.setAttributeNS(null,d.dasherize(a),this.svgStyle[a])},this):this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)");this.psv.cleanPosition(this);this.position3D=this.psv.sphericalCoordsToVector3(this)};u.prototype._updatePoly=function(a,b){this._dynamicSize=!0;this.svgStyle?(Object.getOwnPropertyNames(this.svgStyle).forEach(function(a){this.$el.setAttributeNS(null,d.dasherize(a),this.svgStyle[a])},this),this.isPolyline()&&!this.svgStyle.fill&&this.$el.setAttributeNS(null,"fill","none")):this.isPolygon()?this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline()&&(this.$el.setAttributeNS(null,"fill","none"),this.$el.setAttributeNS(null,"stroke","rgb(0,0,0)"));[this[a],this[b]].forEach(function(a){if(a&&"object"!==typeof a[0])for(var b=0;b<a.length;b++)a.splice(b,2,[a[b],a[b+1]])});this[a]=this[b]?this[b].map(function(a){a=this.psv.textureCoordsToSphericalCoords({x:a[0],y:a[1]});return[a.longitude,a.latitude]},this):this[a].map(function(a){return[d.parseAngle(a[0]),d.parseAngle(a[1],!0)]});this.longitude=this[a][0][0];this.latitude=this[a][0][1];this.positions3D=this[a].map(function(a){return this.psv.sphericalCoordsToVector3({longitude:a[0],latitude:a[1]})},this)};var d={};c.Utils=d;d.TwoPI=2*Math.PI;d.HalfPI=Math.PI/2;d.svgNS="http://www.w3.org/2000/svg";d.checkTHREE=function(a){for(var b=0,c=arguments.length;b<c;b++)if(!(arguments[b]in l))return!1;return!0};d.isCanvasSupported=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))};d.getWebGLCtx=function(){var a=document.createElement("canvas"),b=null;return a.getContext?["webgl","experimental-webgl","moz-webgl","webkit-3d"].some(function(c){try{return(b=a.getContext(c))&&"function"===typeof b.getParameter}catch(h){return!1}})?b:null:null};d.isWebGLSupported=function(){return!!window.WebGLRenderingContext&&null!==d.getWebGLCtx()};d.isDeviceOrientationSupported=function(){var a=w();if("DeviceOrientationEvent"in window){var b=function(c){c&&null!==c.alpha&&!isNaN(c.alpha)?a.resolve(!0):a.resolve(!1);window.removeEventListener("deviceorientation",b)};window.addEventListener("deviceorientation",b,!1);setTimeout(function(){a.promise.isPending()&&b(null)},2E3)}else a.resolve(!1);return a.promise};d.isTouchEnabled=function(){var a=w(),b=function(c){c?a.resolve():a.reject();window.removeEventListener("touchstart",b)};window.addEventListener("touchstart",b,!1);setTimeout(function(){a.promise.isPending()&&b(null)},1E4);return a.promise};d.getMaxTextureWidth=function(){var a=d.getWebGLCtx();return null!==a?a.getParameter(a.MAX_TEXTURE_SIZE):0};d.toggleClass=function(a,b,c){if(a.classList)void 0===c?a.classList.toggle(b):c&&!a.classList.contains(b)?a.classList.add(b):c||a.classList.remove(b);else{var e=a.getAttribute("class")||"",d=-1!==e.indexOf(b),m=new RegExp("(?:^|\\s)"+b+"(?:\\s|$)");void 0!==c&&!c||d?c||(e=e.replace(m," ")):e+=0<e.length?" "+b:b;a.setAttribute("class",e)}};d.addClasses=function(a,b){b&&b.split(" ").forEach(function(b){d.toggleClass(a,b,!0)})};d.removeClasses=function(a,b){b&&b.split(" ").forEach(function(b){d.toggleClass(a,b,!1)})};d.hasParent=function(a,b){do if(a===b)return!0;while(a=a.parentNode);return!1};d.getClosest=function(a,b){var c=a.matches||a.msMatchesSelector;do if(c.bind(a)(b))return a;while(a instanceof SVGElement?a=a.parentNode:a=a.parentElement);return null};d.mouseWheelEvent=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"};d.getEventKey=function(a){(a=a.key||d.getEventKey.KEYMAP[a.keyCode||a.which])&&d.getEventKey.MS_KEYMAP[a]&&(a=d.getEventKey.MS_KEYMAP[a]);return a};d.getEventKey.KEYMAP={13:"Enter",27:"Escape",32:" ",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete",107:"+",109:"-"};d.getEventKey.MS_KEYMAP={Add:"+",Del:"Delete",Down:"ArrowDown",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Subtract:"-",Up:"ArrowUp"};d.fullscreenEvent=function(){var a={exitFullscreen:"fullscreenchange",webkitExitFullscreen:"webkitfullscreenchange",mozCancelFullScreen:"mozfullscreenchange",msExitFullscreen:"MSFullscreenChange"},b;for(b in a)if(a.hasOwnProperty(b)&&b in document)return a[b];return null};d.bound=function(a,b,c){return Math.max(b,Math.min(c,a))};d.isInteger=Number.isInteger||function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a};d.sum=function(a){return a.reduce(function(a,c){return a+c},0)};d.dasherize=function(a){return a.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,function(a,c){return(0<c?"-":"")+a.toLowerCase()})};d.getXMPValue=function(a,b){var c;return null!==(c=a.match("\x3cGPano:"+b+"\x3e(.*)\x3c/GPano:"+b+"\x3e"))?c[1]:null!==(c=a.match("GPano:"+b+'\x3d"(.*?)"'))?c[1]:null};d.isFullscreenEnabled=function(a){return(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)===a};d.requestFullscreen=function(a){(a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen).call(a)};d.exitFullscreen=function(){(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document)};d.getStyle=function(a,b){return window.getComputedStyle(a,null)[b]};d.getShortestArc=function(a,b){return[0,d.TwoPI,-d.TwoPI].reduce(function(c,d){d=b-a+d;return Math.abs(d)<Math.abs(c)?d:c},Infinity)};d.parsePosition=function(a){if(!a)return{top:.5,left:.5};if("object"===typeof a)return a;a=a.toLocaleLowerCase().split(" ").slice(0,2);1===a.length&&(a=void 0!==d.parsePosition.positions[a[0]]?[a[0],"center"]:[a[0],a[0]]);var b="left"!==a[1]&&"right"!==a[1]&&"top"!==a[0]&&"bottom"!==a[0];a=a.map(function(a){return d.parsePosition.positions[a]||a});b||a.reverse();return(a=a.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/))?{left:a[1]/100,top:a[2]/100}:{top:.5,left:.5}};d.parsePosition.positions={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"};d.parseSpeed=function(a){if("string"===typeof a){a=a.toString().trim();var b=parseFloat(a.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));a=a.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();a.match(/(pm|per minute)$/)&&(b/=60);switch(a){case "dpm":case "degrees per minute":case "dps":case "degrees per second":a=l.Math.degToRad(b);break;case "radians per minute":case "radians per second":a=b;break;case "rpm":case "revolutions per minute":case "rps":case "revolutions per second":a=b*d.TwoPI;break;default:throw new n('unknown speed unit "'+a+'"');}}return a};d.parseAngle=function(a,b){if("string"===typeof a){var c=a.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!c)throw new n('unknown angle "'+a+'"');var h=parseFloat(c[1]);if(c=c[2])switch(c){case "deg":case "degs":a=l.Math.degToRad(h);break;case "rad":case "rads":a=h;break;default:throw new n('unknown angle unit "'+c+'"');}else a=h}a=(b?a+Math.PI:a)%d.TwoPI;0>a&&(a=d.TwoPI+a);return b?d.bound(a-Math.PI,-d.HalfPI,d.HalfPI):a};d.cleanTHREEScene=function(a){a.children.forEach(function(a){a instanceof l.Mesh&&(a.geometry&&(a.geometry.dispose(),a.geometry=null),a.material&&(a.material.materials?(a.material.materials.forEach(function(a){a.map&&(a.map.dispose(),a.map=null);a.dispose()}),a.material.materials.length=0):(a.material.map&&(a.material.map.dispose(),a.material.map=null),a.material.dispose()),a.material=null))});a.children.length=0};d.animation=function(a){function b(e){if(-1!==c.promise.getStatus()){null===h&&(h=e);e=(e-h)/a.duration;var d={},f;if(1>e){for(f in a.properties)d[f]=a.properties[f].start+(a.properties[f].end-a.properties[f].start)*a.easing(e);a.onTick(d,e);window.requestAnimationFrame(b)}else{for(f in a.properties)d[f]=a.properties[f].end;a.onTick(d,1);window.requestAnimationFrame(function(){c.resolve()})}}}var c=w(!1),h=null;a.easing&&"string"!==typeof a.easing||(a.easing=d.animation.easings[a.easing||"linear"]);void 0!==a.delay?window.setTimeout(function(){window.requestAnimationFrame(b)},a.delay):window.requestAnimationFrame(b);var f=c.promise;f.cancel=function(){c.reject()};return f};d.animation.easings={linear:function(a){return a},inQuad:function(a){return a*a},outQuad:function(a){return a*(2-a)},inOutQuad:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},inQuart:function(a){return a*a*a*a},outQuart:function(a){return 1- --a*a*a*a},inOutQuart:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return 1+--a*a*a*a*a},inOutQuint:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a},inSine:function(a){return 1-Math.cos(Math.PI/2*a)},outSine:function(a){return Math.sin(Math.PI/2*a)},inOutSine:function(a){return.5-.5*Math.cos(Math.PI*a)},inExpo:function(a){return Math.pow(2,10*(a-1))},outExpo:function(a){return 1-Math.pow(2,-10*a)},inOutExpo:function(a){a=2*a-1;return 0>a?.5*Math.pow(2,10*a):1-.5*Math.pow(2,-10*a)},inCirc:function(a){return 1-Math.sqrt(1-a*a)},outCirc:function(a){a--;return Math.sqrt(1-a*a)},inOutCirc:function(a){a*=2;return 1>a?.5-.5*Math.sqrt(1-a*a):.5+.5*Math.sqrt(1-(a-=2)*a)}};d.throttle=function(a,b){var c,d,f,m=null,q=0,g=function(){q=Date.now();m=null;f=a.apply(c,d);m||(c=d=null)};return function(){var e=Date.now();q||(q=e);var h=b-(e-q);c=this;d=arguments;0>=h||h>b?(m&&(clearTimeout(m),m=null),q=e,f=a.apply(c,d),m||(c=d=null)):m||(m=setTimeout(g,h));return f}};d.isPlainObject=function(a){return"object"===typeof a&&null!==a?"function"===typeof Object.getPrototypeOf?(a=Object.getPrototypeOf(a),a===Object.prototype||null===a):"[object Object]"===Object.prototype.toString.call(a):!1};d.deepmerge=function(a,b){return function h(a,c){if(Array.isArray(c))a&&Array.isArray(a)?a.length=0:a=[],c.forEach(function(b,c){a[c]=h(null,b)});else if("object"===typeof c){if(!a||Array.isArray(a))a={};Object.keys(c).forEach(function(f){"object"===typeof c[f]&&c[f]&&d.isPlainObject(c[f])?c[f]!=b&&(a[f]?h(a[f],c[f]):a[f]=h(null,c[f])):a[f]=c[f]})}else a=c;return a}(a,b)};d.clone=function(a){return d.deepmerge(null,a)};d.normalizeWheel=function(a){var b=0,c=0,d,f;"detail"in a&&(c=a.detail);"wheelDelta"in a&&(c=-a.wheelDelta/120);"wheelDeltaY"in a&&(c=-a.wheelDeltaY/120);"wheelDeltaX"in a&&(b=-a.wheelDeltaX/120);"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(b=c,c=0);d=10*b;f=10*c;"deltaY"in a&&(f=a.deltaY);"deltaX"in a&&(d=a.deltaX);(d||f)&&a.deltaMode&&(1===a.deltaMode?(d*=40,f*=40):(d*=800,f*=800));d&&!b&&(b=1>d?-1:1);f&&!c&&(c=1>f?-1:1);return{spinX:b,spinY:c,pixelX:d,pixelY:f}};d.forEach=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(a[c],c)};(function(a){a.requestAnimationFrame=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame;a.cancelAnimationFrame=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame;if(!a.requestAnimationFrame){var b=[],c=[],d=0,f;a.requestAnimationFrame=function(a){b.push([++d,a]);f||(f=setInterval(function(){if(b.length){var a=+new Date,d=c;c=b;for(b=d;c.length;)c.shift()[1](a)}else clearInterval(f),f=void 0},20));return d};a.cancelAnimationFrame=function(a){var d,e;d=0;for(e=b.length;d<e;d+=1)if(b[d][0]===a){b.splice(d,1);return}d=0;for(e=c.length;d<e;d+=1)if(c[d][0]===a){c.splice(d,1);break}}}})(window);c.ICONS["compass.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 100 100"\x3e\x3cpath d\x3d"M50 0a50 50 0 1 0 0 100A50 50 0 0 0 50 0zm0 88.81a38.86 38.86 0 0 1-38.81-38.8 38.86 38.86 0 0 1 38.8-38.82A38.86 38.86 0 0 1 88.82 50 38.87 38.87 0 0 1 50 88.81z"/\x3e\x3cpath d\x3d"M72.07 25.9L40.25 41.06 27.92 74.12l31.82-15.18v-.01l12.32-33.03zM57.84 54.4L44.9 42.58l21.1-10.06-8.17 21.9z"/\x3e\x3c!--Created by iconoci from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["download.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 100 100"\x3e\x3cpath d\x3d"M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/\x3e\x3cpath d\x3d"M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/\x3e\x3c!--Created by Michael Zenaty from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["fullscreen-in.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 100 100"\x3e\x3cpath d\x3d"M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/\x3e\x3c!--Created by Garrett Knoll from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["fullscreen-out.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 100 100"\x3e\x3cpath d\x3d"M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/\x3e\x3c!--Created by Garrett Knoll from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["gesture.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 100 100"\x3e\x3cpath d\x3d"M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z" fill\x3d"#000" fill-rule\x3d"evenodd"/\x3e\x3c!--Created by AomAm from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["info.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 64 64"\x3e\x3cpath d\x3d"M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/\x3e\x3ccircle cx\x3d"39.3" cy\x3d"9.2" r\x3d"8.2"/\x3e\x3c!--Created by Arafat Uddin from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["mobile-rotate.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 100 100"\x3e\x3cpath d\x3d"M66.7 19a14 14 0 0 1 13.8 12.1l-3.9-2.7c-.5-.3-1.1-.2-1.4.3-.3.5-.2 1.1.3 1.4l5.7 3.9.6.2c.3 0 .6-.2.8-.4l3.9-5.7c.3-.5.2-1.1-.3-1.4-.5-.3-1.1-.2-1.4.3l-2.4 3.5A16 16 0 0 0 66.7 17c-.6 0-1 .4-1 1s.4 1 1 1zM25 15h10c.6 0 1-.4 1-1s-.4-1-1-1H25c-.6 0-1 .4-1 1s.4 1 1 1zm-6.9 30H16l-2 .2a1 1 0 0 0-.8 1.2c.1.5.5.8 1 .8h.2l1.7-.2h2.1c.6 0 1-.4 1-1s-.5-1-1.1-1zm10 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zM84 45H55V16A11 11 0 0 0 44 5H16A11 11 0 0 0 5 16v68a11 11 0 0 0 11 11h68a11 11 0 0 0 11-11V56a11 11 0 0 0-11-11zM16 93c-5 0-9-4-9-9V53.2c.3-.1.6-.3.7-.6a9.8 9.8 0 0 1 2-3c.4-.4.4-1 0-1.4a1 1 0 0 0-1.4 0l-1.2 1.5V16c0-5 4-9 9-9h28c5 0 9 4 9 9v68c0 5-4 9-9 9H16zm77-9c0 5-4 9-9 9H50.3c2.8-2 4.7-5.3 4.7-9V47h29c5 0 9 4 9 9v28zM38.1 45h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.5-1-1-1zm9.9 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zm38 19c-.6 0-1 .4-1 1v10c0 .6.4 1 1 1s1-.4 1-1V65c0-.6-.4-1-1-1z"/\x3e\x3c!--Created by Anthony Bresset from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["pin.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 48 48"\x3e\x3cpath d\x3d"M24 0C13.8 0 5.5 8.3 5.5 18.5c0 10.07 17.57 28.64 18.32 29.42a.25.25 0 0 0 .36 0c.75-.78 18.32-19.35 18.32-29.42C42.5 8.3 34.2 0 24 0zm0 7.14a10.35 10.35 0 0 1 0 20.68 10.35 10.35 0 0 1 0-20.68z"/\x3e\x3c!--Created by Daniele Marucci from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["play-active.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 41 41"\x3e\x3cpath d\x3d"M40.5 14.1c-.1-.1-1.2-.5-2.898-1-.102 0-.202-.1-.202-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.399 2.7.899.1 0 .2.101.2.199C6.3 34.4 12.9 39 20.5 39c7.602 0 14.102-4.6 16.9-11.1 0-.102.1-.102.199-.2 1.699-.601 2.699-1 2.801-1l.6-.3V14.3l-.5-.2zM6.701 11.5C9.7 7 14.8 4 20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.799-1-8.799-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5zM25.1 20.3L18.7 24c-.3.2-.7 0-.7-.5v-7.4c0-.4.4-.6.7-.4l6.399 3.8c.301.1.301.6.001.8zm9.4 8.901A16.421 16.421 0 0 1 20.5 37c-5.9 0-11.1-3.1-14-7.898-.2-.302.1-.602.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.602-2 .298-.1.5.198.398.499z"/\x3e\x3c!--Created by Nick Bluth from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["play.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 41 41"\x3e\x3cpath d\x3d"M40.5 14.1c-.1-.1-1.2-.5-2.899-1-.101 0-.2-.1-.2-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.4 2.7.9.1 0 .2.1.2.199C6.3 34.4 12.9 39 20.5 39c7.601 0 14.101-4.6 16.9-11.1 0-.101.1-.101.2-.2 1.699-.6 2.699-1 2.8-1l.6-.3V14.3l-.5-.2zM20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.8-1-8.8-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5C9.7 7 14.8 4 20.5 4zm0 33c-5.9 0-11.1-3.1-14-7.899-.2-.301.1-.601.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.601-2 .3-.1.5.2.399.5A16.422 16.422 0 0 1 20.5 37zm18.601-12.1c0 .1-.101.3-.2.3-2.5.9-10.4 3.6-18.4 3.6-7.1 0-15.6-2.699-18.3-3.6C2.1 25.2 2 25 2 24.9V16c0-.1.1-.3.2-.3 2.6-.9 10.6-3.6 18.2-3.6 7.5 0 15.899 2.7 18.5 3.6.1 0 .2.2.2.3v8.9z"/\x3e\x3cpath d\x3d"M18.7 24l6.4-3.7c.3-.2.3-.7 0-.8l-6.4-3.8c-.3-.2-.7 0-.7.4v7.4c0 .5.4.7.7.5z"/\x3e\x3c!--Created by Nick Bluth from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["stereo.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 -2 16 16"\x3e\x3cpath d\x3d"M13.104 0H2.896C2.332 0 1 .392 1 .875h14C15 .392 13.668 0 13.104 0zM15 1H1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h3.534a2 2 0 0 0 1.821-1.172l1.19-2.618a.5.5 0 0 1 .91 0l1.19 2.618A2 2 0 0 0 11.466 11H15a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM4 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/\x3e\x3c!--Created by Idev\u00e3 Batista from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["zoom-in.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 20 20"\x3e\x3cpath d\x3d"M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/\x3e\x3cpath d\x3d"M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/\x3e\x3c!--Created by Ryan Canning from the Noun Project--\x3e\x3c/svg\x3e';c.ICONS["zoom-out.svg"]='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 20 20"\x3e\x3cpath d\x3d"M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/\x3e\x3cpath d\x3d"M4.006 6.746h7.459V8.73H4.006z"/\x3e\x3c!--Created by Ryan Canning from the Noun Project--\x3e\x3c/svg\x3e';return c});