!function(u,q,v){function S(){var a=u.L;e.noConflict=function(){return u.L=a,this};u.L=e;u.LD=Q;u.IMAP=Q}function D(a,d,f){this.z=a;this.x=d;this.y=f}function T(a,d,f){this.url=a;this.Je=d;this.XA=f;this.Vg=this.Mu=!1}function F(a,d){var f=P;return function(){return f.call(this,a,d)}}function P(a,d){a.hS=+new Date;a.loaded=d;clearTimeout(a.gQ);var f=a.IN;f.nh.remove(a.url)&&f.FH();f=a.pN?a.Ua:a.X;a.Ua=null;(d||a.XA)&&a.Je(d?f:null,a);a.KB?(a.KB.tk(),a.KB=null):f&&(f.onload=null,f.onerror=null,f.onabort=null,a.X=null)}var e={version:"1.0.0-rc.1 (31fe582)"},Q={version:"3.6.5"};"object"==typeof module&&"object"==typeof module.exports?module.exports=e:"function"==typeof define&&define.amd&&define(e);"undefined"!=typeof u&&S();e.Util={extend:function(a){var d,f,e,h;f=1;for(e=arguments.length;e>f;f++)for(d in h=arguments[f],h)a[d]=h[d];return a},create:Object.create||function(){function a(){}return function(d){return a.prototype=d,new a}}(),bind:function(a,d){var f=Array.prototype.slice;if(a.bind)return a.bind.apply(a,f.call(arguments,1));var e=f.call(arguments,2);return function(){return a.apply(d,e.length?e.concat(f.call(arguments)):arguments)}},stamp:function(a){return a._leaflet_id=a._leaflet_id||++e.Util.lastId,a._leaflet_id},lastId:0,throttle:function(a,d,f){var e,h,k,l;return l=function(){e=!1;h&&(k.apply(f,h),h=!1)},k=function(){e?h=arguments:(a.apply(f,arguments),setTimeout(l,d),e=!0)}},wrapNum:function(a,d,f){var e=d[1];d=d[0];var h=e-d;return a===e&&f?a:((a-d)%h+h)%h+d},falseFn:function(){return!1},formatNum:function(a,d){var f=Math.pow(10,d||5);return Math.round(a*f)/f},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return e.Util.trim(a).split(/\s+/)},setOptions:function(a,d){a.hasOwnProperty("options")||(a.options=a.options?e.Util.create(a.options):{});for(var f in d)a.options[f]=d[f];return a.options},getParamString:function(a,d,f){var e=[],h;for(h in a)e.push(encodeURIComponent(f?h.toUpperCase():h)+"\x3d"+encodeURIComponent(a[h]));return(d&&-1!==d.indexOf("?")?"\x26":"?")+e.join("\x26")},template:function(a,d){return a.replace(e.Util.templateRe,function(a,e){var f=d[e];if(f===v)throw Error("No value provided for variable "+a);return"function"==typeof f&&(f=f(d)),f})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},indexOf:function(a,d){for(var f=0;f<a.length;f++)if(a[f]===d)return f;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d"};(function(){function a(a){return u["webkit"+a]||u["moz"+a]||u["ms"+a]}function d(a){var d=+new Date,e=Math.max(0,16-(d-f));return f=d+e,u.setTimeout(a,e)}var f=0,g=u.requestAnimationFrame||a("RequestAnimationFrame")||d,h=u.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){u.clearTimeout(a)};e.Util.requestAnimFrame=function(a,f,h){return h&&g===d?void a.call(f):g.call(u,e.bind(a,f))};e.Util.cancelAnimFrame=function(a){a&&h.call(u,a)}})();e.extend=e.Util.extend;e.bind=e.Util.bind;e.stamp=e.Util.stamp;e.setOptions=e.Util.setOptions;e.Class=function(){};e.Class.extend=function(a){var d=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},f=d.__super__=this.prototype,g=e.Util.create(f);g.constructor=d;d.prototype=g;for(var h in this)this.hasOwnProperty(h)&&"prototype"!==h&&(d[h]=this[h]);return a.statics&&(e.extend(d,a.statics),delete a.statics),a.includes&&(e.Util.extend.apply(null,[g].concat(a.includes)),delete a.includes),g.options&&(a.options=e.Util.extend(e.Util.create(g.options),a.options)),e.extend(g,a),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,d=g._initHooks.length;d>a;a++)g._initHooks[a].call(this)}},d};e.Class.include=function(a){return e.extend(this.prototype,a),this};e.Class.mergeOptions=function(a){return e.extend(this.prototype.options,a),this};e.Class.addInitHook=function(a){var d=Array.prototype.slice.call(arguments,1);return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push("function"==typeof a?a:function(){this[a].apply(this,d)}),this};e.Evented=e.Class.extend({on:function(a,d,f){if("object"==typeof a)for(var g in a)this._on(g,a[g],d);else{a=e.Util.splitWords(a);g=0;for(var h=a.length;h>g;g++)this._on(a[g],d,f)}return this},off:function(a,d,f){if(a)if("object"==typeof a)for(var g in a)this._off(g,a[g],d);else{a=e.Util.splitWords(a);g=0;for(var h=a.length;h>g;g++)this._off(a[g],d,f)}else delete this._events;return this},_on:function(a,d,f){this._events=this._events||{};var e=this._events[a];e||(e=[],this._events[a]=e);f===this&&(f=v);a={fn:d,ctx:f};for(var h=e,k=0,l=h.length;l>k;k++)if(h[k].fn===d&&h[k].ctx===f)return;h.push(a);e.count++},_off:function(a,d,f){var g,h,k;if(this._events&&(g=this._events[a])){if(!d){h=0;for(k=g.length;k>h;h++)g[h].fn=e.Util.falseFn;return void delete this._events[a]}if(f===this&&(f=v),g)for(h=0,k=g.length;k>h;h++){var l=g[h];if(l.ctx===f&&l.fn===d)return l.fn=e.Util.falseFn,this._firingCount&&(this._events[a]=g=g.slice()),void g.splice(h,1)}}},fire:function(a,d,f){if(!this.listens(a,f))return this;d=e.Util.extend({},d,{type:a,target:this});if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var g=0,h=a.length;h>g;g++){var k=a[g];k.fn.call(k.ctx||this,d)}this._firingCount--}return f&&this._propagateEvent(d),this},listens:function(a,d){var f=this._events&&this._events[a];if(f&&f.length)return!0;if(d)for(var e in this._eventParents)if(this._eventParents[e].listens(a,d))return!0;return!1},once:function(a,d,f){if("object"==typeof a){for(var g in a)this.once(g,a[g],d);return this}var h=e.bind(function(){this.off(a,d,f).off(a,h,f)},this);return this.on(a,d,f).on(a,h,f)},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[e.stamp(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[e.stamp(a)],this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,e.extend({layer:a.target},a),!0)}});var C=e.Evented.prototype;C.addEventListener=C.on;C.removeEventListener=C.clearAllEventListeners=C.off;C.addOneTimeEventListener=C.once;C.fireEvent=C.fire;C.hasEventListeners=C.listens;e.Mixin={Events:C};(function(){var a=navigator.userAgent.toLowerCase(),d=q.documentElement,f="ActiveXObject"in u,g=-1!==a.indexOf("webkit"),h=-1!==a.indexOf("phantom"),k=-1!==a.search("android [23]"),l=-1!==a.indexOf("chrome"),m=-1!==a.indexOf("gecko")&&!g&&!u.opera&&!f,n=0===navigator.platform.indexOf("Win"),p="undefined"!=typeof orientation||-1!==a.indexOf("mobile"),t=!u.PointerEvent&&u.MSPointerEvent,r=u.PointerEvent||t,A=f&&"transition"in d.style,G="WebKitCSSMatrix"in u&&"m11"in new u.WebKitCSSMatrix&&!k,E="MozPerspective"in d.style,d="OTransition"in d.style,y=!u.L_NO_TOUCH&&(r||"ontouchstart"in u||u.DocumentTouch&&q instanceof u.DocumentTouch);e.Browser={ie:f,ielt9:f&&!q.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in q),webkit:g,gecko:m,android:-1!==a.indexOf("android"),android23:k,chrome:l,safari:!l&&-1!==a.indexOf("safari"),win:n,ie3d:A,webkit3d:G,gecko3d:E,opera12:d,any3d:!u.L_DISABLE_3D&&(A||G||E)&&!d&&!h,mobile:p,mobileWebkit:p&&g,mobileWebkit3d:p&&G,mobileOpera:p&&u.opera,mobileGecko:p&&m,touch:!!y,msPointer:!!t,pointer:!!r,retina:1<(u.devicePixelRatio||u.screen.deviceXDPI/u.screen.logicalXDPI)}})();e.Point=function(a,d,f){this.x=f?Math.round(a):a;this.y=f?Math.round(d):d};e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},add:function(a){return this.clone()._add(e.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(e.point(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new e.Point(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new e.Point(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(a){a=e.point(a);var d=a.x-this.x;a=a.y-this.y;return Math.sqrt(d*d+a*a)},equals:function(a){return a=e.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=e.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+e.Util.formatNum(this.x)+", "+e.Util.formatNum(this.y)+")"}};e.point=function(a,d,f){return a instanceof e.Point?a:e.Util.isArray(a)?new e.Point(a[0],a[1]):a===v||null===a?a:"object"==typeof a&&"x"in a&&"y"in a?new e.Point(a.x,a.y):new e.Point(a,d,f)};e.Bounds=function(a,d){if(a)for(var f=d?[a,d]:a,e=0,h=f.length;h>e;e++)this.extend(f[e])};e.Bounds.prototype={extend:function(a){return a=e.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new e.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new e.Point(this.min.x,this.max.y)},getTopRight:function(){return new e.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d,f;return a="number"==typeof a[0]||a instanceof e.Point?e.point(a):e.bounds(a),a instanceof e.Bounds?(d=a.min,f=a.max):d=f=a,d.x>=this.min.x&&f.x<=this.max.x&&d.y>=this.min.y&&f.y<=this.max.y},intersects:function(a){a=e.bounds(a);var d=this.min,f=this.max,g=a.min;a=a.max;var h=a.y>=d.y&&g.y<=f.y;return a.x>=d.x&&g.x<=f.x&&h},overlaps:function(a){a=e.bounds(a);var d=this.min,f=this.max,g=a.min;a=a.max;var h=a.y>d.y&&g.y<f.y;return a.x>d.x&&g.x<f.x&&h},isValid:function(){return!(!this.min||!this.max)}};e.bounds=function(a,d){return!a||a instanceof e.Bounds?a:new e.Bounds(a,d)};e.Transformation=function(a,d,f,e){this._a=a;this._b=d;this._c=f;this._d=e};e.Transformation.prototype={transform:function(a,d){return this._transform(a.clone(),d)},_transform:function(a,d){return d=d||1,a.x=d*(this._a*a.x+this._b),a.y=d*(this._c*a.y+this._d),a},untransform:function(a,d){return d=d||1,new e.Point((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};e.DomUtil={get:function(a){return"string"==typeof a?q.getElementById(a):a},getStyle:function(a,d){var f=a.style[d]||a.currentStyle&&a.currentStyle[d];f&&"auto"!==f||!q.defaultView||(f=(f=q.defaultView.getComputedStyle(a,null))?f[d]:null);return"auto"===f?null:f},create:function(a,d,f){a=q.createElement(a);return a.className=d||"",f&&f.appendChild(a),a},remove:function(a){var d=a.parentNode;d&&d.removeChild(a)},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},toFront:function(a){a.parentNode.appendChild(a)},toBack:function(a){var d=a.parentNode;d.insertBefore(a,d.firstChild)},hasClass:function(a,d){if(a.classList!==v)return a.classList.contains(d);var f=e.DomUtil.getClass(a);return 0<f.length&&(new RegExp("(^|\\s)"+d+"(\\s|$)")).test(f)},addClass:function(a,d){if(a.classList!==v)for(var f=e.Util.splitWords(d),g=0,h=f.length;h>g;g++)a.classList.add(f[g]);else e.DomUtil.hasClass(a,d)||(f=e.DomUtil.getClass(a),e.DomUtil.setClass(a,(f?f+" ":"")+d))},removeClass:function(a,d){a.classList!==v?a.classList.remove(d):e.DomUtil.setClass(a,e.Util.trim((" "+e.DomUtil.getClass(a)+" ").replace(" "+d+" "," ")))},setClass:function(a,d){a.className.baseVal===v?a.className=d:a.className.baseVal=d},getClass:function(a){return a.className.baseVal===v?a.className:a.className.baseVal},setOpacity:function(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&e.DomUtil._setOpacityIE(a,d)},_setOpacityIE:function(a,d){var f=!1;try{f=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(g){if(1===d)return}d=Math.round(100*d);f?(f.Enabled=100!==d,f.Opacity=d):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+d+")"},testProp:function(a){for(var d=q.documentElement.style,f=0;f<a.length;f++)if(a[f]in d)return a[f];return!1},setTransform:function(a,d,f){d=d||new e.Point(0,0);a.style[e.DomUtil.TRANSFORM]=(e.Browser.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(f?" scale("+f+")":"")},setPosition:function(a,d){a._leaflet_pos=d;e.Browser.any3d?e.DomUtil.setTransform(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")},getPosition:function(a){return a._leaflet_pos||new e.Point(0,0)}};(function(){e.DomUtil.TRANSFORM=e.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var a=e.DomUtil.TRANSITION=e.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(e.DomUtil.TRANSITION_END="webkitTransition"===a||"OTransition"===a?a+"End":"transitionend","onselectstart"in q)e.DomUtil.disableTextSelection=function(){e.DomEvent.on(u,"selectstart",e.DomEvent.preventDefault)},e.DomUtil.enableTextSelection=function(){e.DomEvent.off(u,"selectstart",e.DomEvent.preventDefault)};else{var d=e.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);e.DomUtil.disableTextSelection=function(){if(d){var a=q.documentElement.style;this._userSelect=a[d];a[d]="none"}};e.DomUtil.enableTextSelection=function(){d&&(q.documentElement.style[d]=this._userSelect,delete this._userSelect)}}e.DomUtil.disableImageDrag=function(){e.DomEvent.on(u,"dragstart",e.DomEvent.preventDefault)};e.DomUtil.enableImageDrag=function(){e.DomEvent.off(u,"dragstart",e.DomEvent.preventDefault)};e.DomUtil.preventOutline=function(a){for(;-1===a.tabIndex;)a=a.parentNode;a&&a.style&&(e.DomUtil.restoreOutline(),this._outlineElement=a,this._outlineStyle=a.style.outline,a.style.outline="none",e.DomEvent.on(u,"keydown",e.DomUtil.restoreOutline,this))};e.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,e.DomEvent.off(u,"keydown",e.DomUtil.restoreOutline,this))}})();e.LatLng=function(a,d,f){if(isNaN(a)||isNaN(d))throw Error("Invalid LatLng object: ("+a+", "+d+")");this.lat=+a;this.lng=+d;f!==v&&(this.alt=+f)};e.LatLng.prototype={equals:function(a,d){if(!a)return!1;a=e.latLng(a);return(d===v?1E-9:d)>=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))},toString:function(a){return"LatLng("+e.Util.formatNum(this.lat,a)+", "+e.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){return e.CRS.Earth.distance(this,e.latLng(a))},wrap:function(){return e.CRS.Earth.wrapLatLng(this)},toBounds:function(a){a=180*a/40075017;var d=a/Math.cos(Math.PI/180*this.lat);return e.latLngBounds([this.lat-a,this.lng-d],[this.lat+a,this.lng+d])},clone:function(){return new e.LatLng(this.lat,this.lng,this.alt)}};e.latLng=function(a,d,f){return a instanceof e.LatLng?a:e.Util.isArray(a)&&"object"!=typeof a[0]?3===a.length?new e.LatLng(a[0],a[1],a[2]):2===a.length?new e.LatLng(a[0],a[1]):null:a===v||null===a?a:"object"==typeof a&&"lat"in a?new e.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===v?null:new e.LatLng(a,d,f)};e.LatLngBounds=function(a,d){if(a)for(var f=d?[a,d]:a,e=0,h=f.length;h>e;e++)this.extend(f[e])};e.LatLngBounds.prototype={extend:function(a){var d,f,g=this._southWest,h=this._northEast;if(a instanceof e.LatLng)f=d=a;else{if(!(a instanceof e.LatLngBounds))return a?this.extend(e.latLng(a)||e.latLngBounds(a)):this;if(d=a._southWest,f=a._northEast,!d||!f)return this}return g||h?(g.lat=Math.min(d.lat,g.lat),g.lng=Math.min(d.lng,g.lng),h.lat=Math.max(f.lat,h.lat),h.lng=Math.max(f.lng,h.lng)):(this._southWest=new e.LatLng(d.lat,d.lng),this._northEast=new e.LatLng(f.lat,f.lng)),this},pad:function(a){var d=this._southWest,f=this._northEast,g=Math.abs(d.lat-f.lat)*a;a*=Math.abs(d.lng-f.lng);return new e.LatLngBounds(new e.LatLng(d.lat-g,d.lng-a),new e.LatLng(f.lat+g,f.lng+a))},getCenter:function(){return new e.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new e.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new e.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof e.LatLng?e.latLng(a):e.latLngBounds(a);var d,f,g=this._southWest,h=this._northEast;return a instanceof e.LatLngBounds?(d=a.getSouthWest(),f=a.getNorthEast()):d=f=a,d.lat>=g.lat&&f.lat<=h.lat&&d.lng>=g.lng&&f.lng<=h.lng},intersects:function(a){a=e.latLngBounds(a);var d=this._southWest,f=this._northEast,g=a.getSouthWest();a=a.getNorthEast();var h=a.lng>=d.lng&&g.lng<=f.lng;return a.lat>=d.lat&&g.lat<=f.lat&&h},overlaps:function(a){a=e.latLngBounds(a);var d=this._southWest,f=this._northEast,g=a.getSouthWest();a=a.getNorthEast();var h=a.lng>d.lng&&g.lng<f.lng;return a.lat>d.lat&&g.lat<f.lat&&h},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){return a?(a=e.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}};e.latLngBounds=function(a,d){return a instanceof e.LatLngBounds?a:new e.LatLngBounds(a,d)};e.Projection={};e.Projection.LonLat={project:function(a){return new e.Point(a.lng,a.lat)},unproject:function(a){return new e.LatLng(a.y,a.x)},bounds:e.bounds([-180,-90],[180,90])};e.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,f=this.MAX_LATITUDE,f=Math.sin(Math.max(Math.min(f,a.lat),-f)*d);return new e.Point(this.R*a.lng*d,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(a){var d=180/Math.PI;return new e.LatLng((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:function(){var a=6378137*Math.PI;return e.bounds([-a,-a],[a,a])}()};e.CRS={latLngToPoint:function(a,d){var f=this.projection.project(a),e=this.scale(d);return this.transformation._transform(f,e)},pointToLatLng:function(a,d){var f=this.scale(d),f=this.transformation.untransform(a,f);return this.projection.unproject(f)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,f=this.scale(a);a=this.transformation.transform(d.min,f);d=this.transformation.transform(d.max,f);return e.bounds(a,d)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?e.Util.wrapNum(a.lng,this.wrapLng,!0):a.lng,f=this.wrapLat?e.Util.wrapNum(a.lat,this.wrapLat,!0):a.lat;return e.latLng(f,d,a.alt)}};e.CRS.Simple=e.extend({},e.CRS,{projection:e.Projection.LonLat,transformation:new e.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,d){var f=d.lng-a.lng,e=d.lat-a.lat;return Math.sqrt(f*f+e*e)},infinite:!0});e.CRS.Earth=e.extend({},e.CRS,{wrapLng:[-180,180],R:6371E3,distance:function(a,d){var f=Math.PI/180,e=a.lat*f,h=d.lat*f;return this.R*Math.acos(Math.min(Math.sin(e)*Math.sin(h)+Math.cos(e)*Math.cos(h)*Math.cos((d.lng-a.lng)*f),1))}});e.CRS.EPSG3857=e.extend({},e.CRS.Earth,{code:"EPSG:3857",projection:e.Projection.SphericalMercator,transformation:function(){var a=.5/(Math.PI*e.Projection.SphericalMercator.R);return new e.Transformation(a,.5,-a,.5)}()});e.CRS.EPSG900913=e.extend({},e.CRS.EPSG3857,{code:"EPSG:900913"});e.CRS.EPSG4326=e.extend({},e.CRS,e.CRS.Earth,{code:"EPSG:4326",projection:e.Projection.LonLat,transformation:new e.Transformation(1/360,.5,-1/360,.5)});e.Map=e.Evented.extend({options:{crs:e.CRS.EPSG3857,center:v,zoom:v,minZoom:v,maxZoom:v,layers:[],maxBounds:v,renderer:v,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=e.setOptions(this,d);this._initContainer(a);this._initLayout();this._onResize=e.bind(this._onResize,this);this._initEvents();d.maxBounds&&this.setMaxBounds(d.maxBounds);d.zoom!==v&&(this._zoom=this._limitZoom(d.zoom));d.center&&d.zoom!==v&&this.setView(e.latLng(d.center),d.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();(this._zoomAnimated=e.DomUtil.TRANSITION&&e.Browser.any3d&&!e.Browser.mobileOpera&&this.options.zoomAnimation)&&(this._createAnimProxy(),e.DomEvent.on(this._proxy,e.DomUtil.TRANSITION_END,this._catchTransitionEnd,this));this._addLayers(this.options.layers)},setView:function(a,d,f){if(d=d===v?this._zoom:this._limitZoom(d),a=this._limitCenter(e.latLng(a),d,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&!0!==f)if(f.animate!==v&&(f.zoom=e.extend({animate:f.animate},f.zoom),f.pan=e.extend({animate:f.animate,duration:f.duration},f.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,f.zoom):this._tryAnimatedPan(a,f.pan))return clearTimeout(this._sizeTimer),this;return this._resetView(a,d),this},setZoom:function(a,d){return this._loaded?this.setView(this.getCenter(),a,{zoom:d}):(this._zoom=a,this)},zoomIn:function(a,d){return a=a||(e.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){return a=a||(e.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,f){var g=this.getZoomScale(d),h=this.getSize().divideBy(2);a=(a instanceof e.Point?a:this.latLngToContainerPoint(a)).subtract(h).multiplyBy(1-1/g);h=this.containerPointToLatLng(h.add(a));return this.setView(h,d,{zoom:f})},_getBoundsCenterZoom:function(a,d){d=d||{};a=a.getBounds?a.getBounds():e.latLngBounds(a);var f=e.point(d.paddingTopLeft||d.padding||[0,0]),g=e.point(d.paddingBottomRight||d.padding||[0,0]),h=this.getBoundsZoom(a,!1,f.add(g)),h="number"==typeof d.maxZoom?Math.min(d.maxZoom,h):h,f=g.subtract(f).divideBy(2),g=this.project(a.getSouthWest(),h),k=this.project(a.getNorthEast(),h);return{center:this.unproject(g.add(k).divideBy(2).add(f),h),zoom:h}},fitBounds:function(a,d){if(a=e.latLngBounds(a),!a.isValid())throw Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(a,d);return this.setView(f.center,f.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,d){return this.setView(a,this._zoom,{pan:d})},panBy:function(a,d){if(a=e.point(a).round(),d=d||{},!a.x&&!a.y)return this.fire("moveend");if(!0!==d.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new e.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),!1!==d.animate){e.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,f,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,f){function g(a){a=(G*G-A*A+(a?-1:1)*x*x*q*q)/(2*(a?G:A)*x*q);a=Math.sqrt(a*a+1)-a;return 1E-9>a?-18:Math.log(a)}function h(a){return(Math.exp(a)+Math.exp(-a))/2}function k(a){return A*(h(w)/h(w+u*a))}function l(a){var d=A,f=h(w);a=w+u*a;a=(Math.exp(a)-Math.exp(-a))/2/h(a);return d*(f*a-(Math.exp(w)-Math.exp(-w))/2)/x}function m(){var f=(Date.now()-B)/z,g=(1-Math.pow(1-f,1.5))*H;1>=f?(this._flyToFrame=e.Util.requestAnimFrame(m,this),this._move(this.unproject(n.add(p.subtract(n).multiplyBy(l(g)/q)),r),this.getScaleZoom(A/k(g),r),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}if(f=f||{},!1===f.animate||!e.Browser.any3d)return this.setView(a,d,f);this._stop();var n=this.project(this.getCenter()),p=this.project(a),t=this.getSize(),r=this._zoom;a=e.latLng(a);d=d===v?r:d;var A=Math.max(t.x,t.y),G=A*this.getZoomScale(r,d),q=p.distanceTo(n)||1,u=1.42,x=u*u,w=g(0),B=Date.now(),H=(g(1)-w)/u,z=f.duration?1E3*f.duration:800*H;return this._moveStart(!0),m.call(this),this},flyToBounds:function(a,d){var f=this._getBoundsCenterZoom(a,d);return this.flyTo(f.center,f.zoom,d)},setMaxBounds:function(a){return a=e.latLngBounds(a),a.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(a){return this.options.minZoom=a,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){return this.options.maxZoom=a,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var f=this.getCenter(),g=this._limitCenter(f,this._zoom,e.latLngBounds(a));return f.equals(g)||this.panTo(g,d),this._enforcingBounds=!1,this},invalidateSize:function(a){if(!this._loaded)return this;a=e.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var f=this.getSize(),g=d.divideBy(2).round(),h=f.divideBy(2).round(),g=g.subtract(h);return g.x||g.y?(a.animate&&a.pan?this.panBy(g):(a.pan&&this._rawPanBy(g),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(e.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:f})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=e.extend({timeout:1E4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=e.bind(this._handleGeolocationResponse,this),f=e.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,f,a):navigator.geolocation.getCurrentPosition(d,f,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var d=a.code;a=a.message||(1===d?"permission denied":2===d?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:d,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var d=new e.LatLng(a.coords.latitude,a.coords.longitude),f=d.toBounds(a.coords.accuracy),g=this._locateOptions;if(g.setView){var h=this.getBoundsZoom(f);this.setView(d,g.maxZoom?Math.min(h,g.maxZoom):h)}var d={latlng:d,bounds:f,timestamp:a.timestamp},k;for(k in a.coords)"number"==typeof a.coords[k]&&(d[k]=a.coords[k]);this.fire("locationfound",d)},addHandler:function(a,d){if(!d)return this;var f=this[a]=new d(this);return this._handlers.push(f),this.options[a]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(d){this._containerId=this._container._leaflet_id=v}e.DomUtil.remove(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var a in this._layers)this._layers[a].remove();return this},createPane:function(a,d){var f="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),f=e.DomUtil.create("div",f,d||this._mapPane);return a&&(this._panes[a]=f),f},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new e.LatLngBounds(d,a)},getMinZoom:function(){return this.options.minZoom===v?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===v?this._layersMaxZoom===v?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,f){a=e.latLngBounds(a);f=e.point(f||[0,0]);var g=this.getZoom()||0,h=this.getMinZoom(),k=this.getMaxZoom(),l=a.getNorthWest();a=a.getSouthEast();f=this.getSize().subtract(f);l=this.project(a,g).subtract(this.project(l,g));a=e.Browser.any3d?this.options.zoomSnap:1;return g=this.getScaleZoom(Math.min(f.x/l.x,f.y/l.y),g),a&&(g=a/100*Math.round(g/(a/100)),g=d?Math.ceil(g/a)*a:Math.floor(g/a)*a),Math.max(h,Math.min(k,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new e.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,d){var f=this._getTopLeftPoint(a,d);return new e.Bounds(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===v?this.getZoom():a)},getPane:function(a){return"string"==typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,d){var f=this.options.crs;return d=d===v?this._zoom:d,f.scale(a)/f.scale(d)},getScaleZoom:function(a,d){var f=this.options.crs;d=d===v?this._zoom:d;f=f.zoom(a*f.scale(d));return isNaN(f)?1/0:f},project:function(a,d){return d=d===v?this._zoom:d,this.options.crs.latLngToPoint(e.latLng(a),d)},unproject:function(a,d){return d=d===v?this._zoom:d,this.options.crs.pointToLatLng(e.point(a),d)},layerPointToLatLng:function(a){a=e.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(e.latLng(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(e.latLng(a))},distance:function(a,d){return this.options.crs.distance(e.latLng(a),e.latLng(d))},containerPointToLayerPoint:function(a){return e.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return e.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(e.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(e.latLng(a)))},mouseEventToContainerPoint:function(a){return e.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=e.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet_id)throw Error("Map container is already initialized.");e.DomEvent.addListener(a,"scroll",this._onScroll,this);this._containerId=e.Util.stamp(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&e.Browser.any3d;e.DomUtil.addClass(a,"leaflet-container"+(e.Browser.touch?" leaflet-touch":"")+(e.Browser.retina?" leaflet-retina":"")+(e.Browser.ielt9?" leaflet-oldie":"")+(e.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=e.DomUtil.getStyle(a,"position");"absolute"!==d&&"relative"!==d&&"fixed"!==d&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);e.DomUtil.setPosition(this._mapPane,new e.Point(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(e.DomUtil.addClass(a.markerPane,"leaflet-zoom-hide"),e.DomUtil.addClass(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d){e.DomUtil.setPosition(this._mapPane,new e.Point(0,0));var f=!this._loaded;this._loaded=!0;d=this._limitZoom(d);this.fire("viewprereset");var g=this._zoom!==d;this._moveStart(g)._move(a,d)._moveEnd(g);this.fire("viewreset");f&&this.fire("load")},_moveStart:function(a){return a&&this.fire("zoomstart"),this.fire("movestart")},_move:function(a,d,f){d===v&&(d=this._zoom);var e=this._zoom!==d;return this._zoom=d,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),(e||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return e.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){e.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){e.DomEvent&&(this._targets={},this._targets[e.stamp(this._container)]=this,a=a?"off":"on",e.DomEvent[a](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e.DomEvent[a](u,"resize",this._onResize,this),e.Browser.any3d&&this.options.transform3DLimit&&this[a]("moveend",this._onMoveEnd))},_onResize:function(){e.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=e.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var f,g=[],h="mouseout"===d||"mouseover"===d,k=a.target||a.srcElement,l=!1;k;){if(f=this._targets[e.stamp(k)],f&&("click"===d||"preclick"===d)&&!a._simulated&&this._draggableMoved(f)){l=!0;break}if(f&&f.listens(d,!0)){if(h&&!e.DomEvent._isExternalTarget(k,a))break;if(g.push(f),h)break}if(k===this._container)break;k=k.parentNode}return g.length||l||h||!e.DomEvent._isExternalTarget(k,a)||(g=[this]),g},_handleDOMEvent:function(a){if(this._loaded&&!e.DomEvent._skipped(a)){var d="keypress"===a.type&&13===a.keyCode?"click":a.type;"mousedown"===d&&e.DomUtil.preventOutline(a.target||a.srcElement);this._fireDOMEvent(a,d)}},_fireDOMEvent:function(a,d,f){if("click"===a.type){var g=e.Util.extend({},a);g.type="preclick";this._fireDOMEvent(g,g.type,f)}if(!a._stopped&&(f=(f||[]).concat(this._findEventTargets(a,d)),f.length)){var h=f[0];"contextmenu"===d&&h.listens(d,!0)&&e.DomEvent.preventDefault(a);g={originalEvent:a};if("keypress"!==a.type){var k=h instanceof e.Marker;g.containerPoint=k?this.latLngToContainerPoint(h.getLatLng()):this.mouseEventToContainerPoint(a);g.layerPoint=this.containerPointToLayerPoint(g.containerPoint);g.latlng=k?h.getLatLng():this.layerPointToLatLng(g.layerPoint)}for(a=0;a<f.length&&!(f[a].fire(d,g,!0),g.originalEvent._stopped||f[a].options.nonBubblingEvents&&-1!==e.Util.indexOf(f[a].options.nonBubblingEvents,d));a++);}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,d=this._handlers.length;d>a;a++)this._handlers[a].disable()},whenReady:function(a,d){return this._loaded?a.call(d||this,{target:this}):this.on("load",a,d),this},_getMapPanePos:function(){return e.DomUtil.getPosition(this._mapPane)||new e.Point(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,d){return(a&&d!==v?this._getNewPixelOrigin(a,d):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,d){var f=this.getSize()._divideBy(2);return this.project(a,d)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,d,f){f=this._getNewPixelOrigin(f,d);return this.project(a,d)._subtract(f)},_latLngBoundsToNewLayerBounds:function(a,d,f){f=this._getNewPixelOrigin(f,d);return e.bounds([this.project(a.getSouthWest(),d)._subtract(f),this.project(a.getNorthWest(),d)._subtract(f),this.project(a.getSouthEast(),d)._subtract(f),this.project(a.getNorthEast(),d)._subtract(f)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,f){if(!f)return a;var g=this.project(a,d),h=this.getSize().divideBy(2),h=new e.Bounds(g.subtract(h),g.add(h));f=this._getBoundsOffset(h,f,d);return f.round().equals([0,0])?a:this.unproject(g.add(f),d)},_limitOffset:function(a,d){if(!d)return a;var f=this.getPixelBounds(),f=new e.Bounds(f.min.add(a),f.max.add(a));return a.add(this._getBoundsOffset(f,d))},_getBoundsOffset:function(a,d,f){f=e.bounds(this.project(d.getNorthEast(),f),this.project(d.getSouthWest(),f));d=f.min.subtract(a.min);f=f.max.subtract(a.max);a=this._rebound(d.x,-f.x);d=this._rebound(d.y,-f.y);return new e.Point(a,d)},_rebound:function(a,d){return 0<a+d?Math.round(a-d)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(d))},_limitZoom:function(a){var d=this.getMinZoom(),f=this.getMaxZoom(),g=e.Browser.any3d?this.options.zoomSnap:1;return g&&(a=Math.round(a/g)*g),Math.max(d,Math.min(f,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){e.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,d){var f=this._getCenterOffset(a)._floor();return!0===(d&&d.animate)||this.getSize().contains(f)?(this.panBy(f,d),!0):!1},_createAnimProxy:function(){var a=this._proxy=e.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a);this.on("zoomanim",function(d){var f=e.DomUtil.TRANSFORM,g=a.style[f];e.DomUtil.setTransform(a,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1));g===a.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var d=this.getCenter(),f=this.getZoom();e.DomUtil.setTransform(a,this.project(d,f),this.getZoomScale(f,1))},this)},_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||!1===f.animate||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(d),g=this._getCenterOffset(a)._divideBy(1-1/g);return!0===f.animate||this.getSize().contains(g)?(e.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(a,d,!0)},this),!0):!1},_animateZoom:function(a,d,f,g){f&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,e.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"));this.fire("zoomanim",{center:a,zoom:d,noUpdate:g});setTimeout(e.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(e.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),e.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}});e.map=function(a,d){return new e.Map(a,d)};e.Layer=e.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[e.stamp(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[e.stamp(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var d=a.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var f=this.getEvents();d.on(f,this);this.once("remove",function(){d.off(f,this)},this)}this.onAdd(d);this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution());this.fire("add");d.fire("layeradd",{layer:this})}}});e.Map.include({addLayer:function(a){var d=e.stamp(a);return this._layers[d]?this:(this._layers[d]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var d=e.stamp(a);return this._layers[d]?(this._loaded&&a.onRemove(this),a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution()),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return!!a&&e.stamp(a)in this._layers},eachLayer:function(a,d){for(var f in this._layers)a.call(d,this._layers[f]);return this},_addLayers:function(a){a=a?e.Util.isArray(a)?a:[a]:[];for(var d=0,f=a.length;f>d;d++)this.addLayer(a[d])},_addZoomLimit:function(a){!isNaN(a.options.maxZoom)&&isNaN(a.options.minZoom)||(this._zoomBoundLayers[e.stamp(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){a=e.stamp(a);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,d=-(1/0),f=this._getZoomSpan(),e;for(e in this._zoomBoundLayers)var h=this._zoomBoundLayers[e].options,a=h.minZoom===v?a:Math.min(a,h.minZoom),d=h.maxZoom===v?d:Math.max(d,h.maxZoom);this._layersMaxZoom=d===-(1/0)?v:d;this._layersMinZoom=a===1/0?v:a;f!==this._getZoomSpan()&&this.fire("zoomlevelschange");this.options.maxZoom===v&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom);this.options.minZoom===v&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});e.Http={};e.Http.Request=e.Evented.extend({options:{callback:"callback",type:"json",charset:"utf-8"},initialize:function(a,d){e.Util.setOptions(this,d);this.send(a)},send:function(a){var d=e.DomUtil.create("script");d.type="text/javascript";d.charset=this.options.charset;var f=this;e.Browser.ielt9?d.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||f.emit("complete")}:(d.onload=function(){f.emit("complete")},d.onerror=function(){f.emit("error",{status:0,info:"service error",url:a})});d.src=a;q.getElementsByTagName("head")[0].appendChild(d)}});e.Http.JSONP=e.Http.Request.extend({send:function(a){var d=e.Util.getGuid("_",5)+"_",f=e.DomUtil.create("script");f.type="text/javascript";f.charset=this.options.charset;var g=this;f.onerror=function(){g.emit("error",{status:0,info:"service error",url:a});q.getElementsByTagName("head")[0].removeChild(f)};u[d]=function(a){g.emit("complete",a);e[d]=null;u[d]=null;q.getElementsByTagName("head")[0].removeChild(f)};f.src=a+"\x26"+this.options.callback+"\x3dwindow."+d;q.getElementsByTagName("head")[0].appendChild(f)}});e.Util.trim=function(a){return a?a.trim?a.trim():a.replace(/^\s+|\s+$/g,""):""};e.Util.getGuid=function(a,d){return(a||"")+Math.round(Math.random()*Math.pow(10,d||6))};e.Util.extend(e.Evented.prototype,{has_events:function(a,d,f){var e=this._events;if(d&&f){if(e&&a in e)for(var h=0;h<e[a].length;h++)if(e[a].fn===d&&e[a].context===f)return!0;return!1}return e&&a in e&&e[a]&&0<e[a].length},emit:function(a,d){if(!this.has_events(a))return this;for(var f=e.extend({type:a},d),g=[].concat(this._events[a]),h=0;h<g.length;h++)g[h].fn&&(g[h].fn.call(g[h].context||this,f),g[h].once&&this._events[a].splice(h,1));return this}});(function(){var a=navigator.userAgent.toLowerCase(),d=-1!==a.indexOf("android"),f=-1!==a.indexOf("windows nt"),g=-1!==a.indexOf("macintosh"),h=-1!==a.indexOf("ipad;"),k=-1!==a.indexOf("ipod touch;"),a=-1!==a.indexOf("iphone;");e.Browser.pf=d?"android":a||h||k?"ios":f?"windows":g?"mac":"other"})();e.DomUtil.removeClass=function(a,d){d&&(a.classList!==v?a.classList.remove(d):e.DomUtil.setClass(a,e.Util.trim((" "+e.DomUtil.getClass(a)+" ").replace(" "+d+" "," "))))};e.DomUtil.setTransform=function(a,d,f,g){d=d||new e.Point(0,0);a.style[e.DomUtil.TRANSFORM]=(e.Browser.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0) rotate("+(g||0)+"deg)")+(f?" scale("+f+")":"")};e.DomUtil.setPosition=function(a,d,f){a&&(a._leaflet_pos=d,e.Browser.any3d?e.DomUtil.setTransform(a,d,null,f):(a.style.left=d.x+"px",a.style.top=d.y+"px",a.style.position="absolute"))};e.DomUtil.hexToRgba=function(a,d){var f,e,h,k=/^#/.test(a)?a.slice(1):a,l="transparent"===a?0:Math.ceil(d);return k=/^[0-9a-f]{3}|[0-9a-f]{6}$/i.test(k)?k:"fffff",3===k.length&&(k=k.replace(/(\w)(\w)(\w)/gi,"$1$1$2$2$3$3")),f=k.slice(0,2),e=k.slice(2,4),h=k.slice(4,6),f=parseInt(f,16),e=parseInt(e,16),h=parseInt(h,16),{hex:"#"+k,alpha:l,rgba:"rgba("+f+", "+e+", "+h+", "+(l/100).toFixed(2)+")"}};e.Util.extend(e.Point.prototype,{scaleBy:function(a,d){return new e.Point(this.x*a.x,"EPSG:3857_360"==d?-(this.y*a.y)+Math.pow(2,this.z)*a.y-256:this.y*a.y)}});e.Util.extend(e.Layer.prototype,{options:e.Util.extend(e.Layer.prototype.options,{visible:!0}),_layerAdd:function(a){a=a.target;a.hasLayer(this)&&(this._map=a,this._zoomAnimated=a._zoomAnimated,this.options.visible&&this.getEvents&&a.on(this.getEvents(),this),this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this}))}});e.Map.include({addLayer:function(a){var d=e.stamp(a);return this._layers[d]?a:(this._layers[d]=a,0==a.type&&(this._baseLayer&&this.removeLayer(this._baseLayer,!0),this._baseLayer=a),a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a,d,f){var g=e.stamp(a);return this._layers[g]?(0!=a.type||d||delete this._baseLayer,this._loaded&&a.onRemove(this,f),a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution()),a.getEvents&&this.off(a.getEvents(),a),d||(delete this._layers[g],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove"))),a._map=a._mapToAdd=null,this):this},getBGLayerIds:function(){var a=[],d=this._layers,f;for(f in d)0==d[f].type&&a.push(e.stamp(d[f]));return a},changeBGLayer:function(a){if(0==a.type){var d=e.stamp(a);return this._layers[d]?(this._baseLayer=a,a.beforeAdd(this)):this.addLayer(a),!0}return!1},getLayer:function(a){return this._layers[a]?this._layers[a]:null},layerToTop:function(a){if(a){var d,f=0,e;for(e in this._layers){var h=this._layers[e];0!=h.type&&(e==a&&(d=h),h.getZIndex()>f&&(f=h.getZIndex()))}d&&d.setZIndex(f+1)}}});e.Util.extend(e.Map.prototype,{options:{crs:e.CRS.EPSG3857,center:v,zoom:v,minZoom:v,maxZoom:v,layers:[],maxBounds:v,renderer:v,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0,scaleX:1,scaleY:1},initialize:function(a,d){d=e.setOptions(this,d);this._initContainer(a);this._initLayout();this._onResize=e.bind(this._onResize,this);this._initEvents();d.maxBounds&&this.setMaxBounds(d.maxBounds);d.zoom!==v&&(this._zoom=this._limitZoom(d.zoom));d.center&&d.zoom!==v&&this.setView(e.latLng(d.center),d.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();(this._zoomAnimated=e.DomUtil.TRANSITION&&e.Browser.any3d&&!e.Browser.mobileOpera&&this.options.zoomAnimation)&&(this._createAnimProxy(),e.DomEvent.on(this._proxy,e.DomUtil.TRANSITION_END,this._catchTransitionEnd,this));this._addLayers(this.options.layers);this.setScale(this.options.scaleX,this.options.scaleY)},setScale:function(a,d){e.DomEvent.getMousePosition=function(f,g){if(!g)return new e.Point(f.clientX,f.clientY);var h=g.getBoundingClientRect();return new e.Point((f.clientX-h.left-g.clientLeft)/a,(f.clientY-h.top-g.clientTop)/d)}},inertia:function(a){this.options.inertia=a},setZoom:function(a,d){d=d||{};return this._loaded?this.setView(d.center||this.getCenter(),a,{zoom:d}):(this._zoom=a,this)},panBy:function(a){return this.fire("movestart"),this._rawPanBy(e.point(a)),this.fire("move").fire("change"),this.fire("moveend").fire("changed")},setMaxBounds:function(a){return a=e.latLngBounds(a),this.options.maxBounds=a,a?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):this.off("moveend",this._panInsideMaxBounds)},setZoomLevels:function(a,d,f){return this.options.maxZoom=d,this.options.minZoom=a,f?void 0:this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(d):this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},invalidateSize:function(a){if(!this._loaded)return this;a=e.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var f=this.getSize(),g=d.divideBy(2).round(),h=f.divideBy(2).round(),g=g.subtract(h);return g.x||g.y?(a.animate&&a.pan?this.panBy(g):(a.pan&&this._rawPanBy(g),this.fire("move").fire("change"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(e.bind(this.fire,this,"moveend"),200)):this.fire("moveend").fire("changed")),this.fire("resize",{oldSize:d,newSize:f})):this},plugin:function(a,d,f){if("string"==typeof a&&(a=[a]),0===a.length)return d(),this;f=f||this.options.pUrl||"pluginUrl not config~";a=f+a.join(",").replace(/LD\.|IMAP\./g,"plugins/");a=new e.Http.Request(a);return a.on("complete",function(){d()}),a.on("error",function(){throw"Plugin service error!";}),this},latLngToProjectedPoint:function(a){return this.project(e.latLng(a))._round()},projectedPointToLatlng:function(a){return this.unproject(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&e.Browser.any3d;e.DomUtil.addClass(a,"leaflet-container"+(e.Browser.touch?" leaflet-touch":"")+(e.Browser.retina?" leaflet-retina":"")+(e.Browser.ielt9?" leaflet-oldie":"")+(e.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));this.options.backgoundImg?a.style.backgroundImage="url("+this.options.backgoundImg+")":a.style.background="#fcf9f2";var d=e.DomUtil.getStyle(a,"position");"absolute"!==d&&"relative"!==d&&"fixed"!==d&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_move:function(a,d,f){d===v&&(d=this._zoom);var e=this._zoom!==d;return this._zoom=d,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),e&&this.fire("zoom",f),this.fire("move",f).fire("change")},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend").fire("changed")},_fireDOMEvent:function(a,d,f){if(!a._stopped&&(f=(f||[]).concat(this._findEventTargets(a,d)),f.length)){var g=f[0];if("contextmenu"===d&&e.DomEvent.preventDefault(a),"click"!==a.type&&"preclick"!==a.type||a._simulated||!this._draggableMoved(g)){var h={originalEvent:a};if("keypress"!==a.type){var k=g instanceof e.Marker;h.containerPoint=k?this.latLngToContainerPoint(g.getLatLng()):this.mouseEventToContainerPoint(a);h.layerPoint=this.containerPointToLayerPoint(h.containerPoint);h.latlng=k?g.getLatLng():this.layerPointToLatLng(h.layerPoint)}for(a=0;a<f.length&&!(f[a].fire(d,h,!0),h.originalEvent._stopped||f[a].options.nonBubblingEvents&&-1!==e.Util.indexOf(f[a].options.nonBubblingEvents,d));a++);}}},_limitCenter:function(a,d,f){if(!f)return a;a=this.project(a,d);var g=this.getSize().divideBy(2),g=new e.Bounds(a.subtract(g),a.add(g));f=this._getBoundsOffset(g,f,d);return this.unproject(a.add(f),d)},_getBoundsOffset:function(a,d,f){var g=this.project(d.getNorthWest(),f).subtract(a.min);d=this.project(d.getSouthEast(),f).subtract(a.max);a=this._rebound(g.x,-d.x);g=this._rebound(g.y,-d.y);return new e.Point(a,g)},_getTileId:function(a){a=this.project(a,this._zoom).floor().unscaleBy(this._baseLayer.getTileSize()).floor();return a.y=-(a.y+1-Math.pow(2,this._zoom)),a.z=this._zoom,a}});e.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:e.bounds([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),project:function(a){var d=Math.PI/180,f=this.R,g=a.lat*d,h=this.R_MINOR/f,h=Math.sqrt(1-h*h),k=h*Math.sin(g);return g=-f*Math.log(Math.max(Math.tan(Math.PI/4-g/2)/Math.pow((1-k)/(1+k),h/2),1E-10)),new e.Point(a.lng*d*f,g)},unproject:function(a){var d,f=180/Math.PI,g=this.R,h=this.R_MINOR/g,h=Math.sqrt(1-h*h),k=Math.exp(-a.y/g),l=Math.PI/2-2*Math.atan(k),m=0;for(d=.1;15>m&&1E-7<Math.abs(d);m++)d=h*Math.sin(l),d=Math.pow((1-d)/(1+d),h/2),d=Math.PI/2-2*Math.atan(k*d)-l,l+=d;return new e.LatLng(l*f,a.x*f/g)}};e.CRS.EPSG3395=e.extend({},e.CRS.Earth,{code:"EPSG:3395",projection:e.Projection.Mercator,transformation:function(){var a=.5/(Math.PI*e.Projection.Mercator.R);return new e.Transformation(a,.5,-a,.5)}()});e.GridLayer=e.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:e.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:v,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){e.setOptions(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();e.DomUtil.remove(this._container);a._removeZoomLimit(this);this._tileZoom=this._container=null},bringToFront:function(){return this._map&&(e.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(e.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=e.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return q.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof e.Point?a:new e.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==v&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d,f=this.getPane().children,e=-a(-(1/0),1/0),h=0,k=f.length;k>h;h++)d=f[h].style.zIndex,f[h]!==this._container&&d&&(e=a(e,+d));isFinite(e)&&(this.options.zIndex=e+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!e.Browser.ielt9){e.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,d=!1,f=!1,g;for(g in this._tiles){var h=this._tiles[g];if(h.current&&h.loaded){var k=Math.min(1,(a-h.loaded)/200);e.DomUtil.setOpacity(h.el,k);1>k?d=!0:(h.active&&(f=!0),h.active=!0)}}f&&!this._noPrune&&this._pruneTiles();d&&(e.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=e.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=e.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a===v)return v;for(var f in this._levels)this._levels[f].el.children.length||f===a?this._levels[f].el.style.zIndex=d-Math.abs(a-f):(e.DomUtil.remove(this._levels[f].el),this._removeTilesAtZoom(f),delete this._levels[f]);f=this._levels[a];var g=this._map;return f||(f=this._levels[a]={},f.el=e.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=d,f.origin=g.project(g.unproject(g.getPixelOrigin()),a).round(),f.zoom=a,this._setZoomTransform(f,g.getCenter(),g.getZoom()),e.Util.falseFn(f.el.offsetWidth)),this._level=f,f},_pruneTiles:function(){if(this._map){var a,d,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom)return void this._removeAllTiles();for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)if(d=this._tiles[a],d.current&&!d.active)f=d.coords,this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2);for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var d in this._tiles)this._tiles[d].coords.z===a&&this._removeTile(d)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)e.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles();this._tileZoom=null},_retainParent:function(a,d,f,g){a=Math.floor(a/2);d=Math.floor(d/2);--f;var h=new e.Point(+a,+d);h.z=+f;h=this._tileCoordsToKey(h);return(h=this._tiles[h])&&h.active?(h.retain=!0,!0):(h&&h.loaded&&(h.retain=!0),f>g?this._retainParent(a,d,f,g):!1)},_retainChildren:function(a,d,f,g){for(var h=2*a;2*a+2>h;h++)for(var k=2*d;2*d+2>k;k++){var l=new e.Point(h,k);l.z=f+1;l=this._tileCoordsToKey(l);(l=this._tiles[l])&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),g>f+1&&this._retainChildren(h,k,f+1,g))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_setView:function(a,d,f,e){var g=Math.round(d);(this.options.maxZoom!==v&&g>this.options.maxZoom||this.options.minZoom!==v&&g<this.options.minZoom)&&(g=v);var k=this.options.updateWhenZooming&&g!==this._tileZoom;(!e||k)&&(this._tileZoom=g,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),g!==v&&this._update(a),f||this._pruneTiles(),this._noPrune=!!f);this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var f in this._levels)this._setZoomTransform(this._levels[f],a,d)},_setZoomTransform:function(a,d,f){var g=this._map.getZoomScale(f,a.zoom);d=a.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(d,f)).round();e.Browser.any3d?e.DomUtil.setTransform(a.el,d,g):e.DomUtil.setPosition(a.el,d)},_resetGrid:function(){var a=this._map,d=a.options.crs,f=this._tileSize=this.getTileSize(),e=this._tileZoom,h=this._map.getPixelWorldBounds(this._tileZoom);h&&(this._globalTileRange=this._pxBoundsToTileRange(h));this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],e).x/f.x),Math.ceil(a.project([0,d.wrapLng[1]],e).x/f.y)];this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],e).y/f.x),Math.ceil(a.project([d.wrapLat[1],0],e).y/f.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var d=this._map,f=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),f=d.getZoomScale(f,this._tileZoom);a=d.project(a,this._tileZoom).floor();d=d.getSize().divideBy(2*f);return new e.Bounds(a.subtract(d),a.add(d))},_update:function(a){var d=this._map;if(d){var f=d.getZoom();if(a===v&&(a=d.getCenter()),this._tileZoom!==v){var d=this._getTiledPixelBounds(a),g=this._pxBoundsToTileRange(d),h=g.getCenter(),d=[],k=this.options.keepBuffer,k=new e.Bounds(g.getBottomLeft().subtract([k,-k]),g.getTopRight().add([k,-k])),l;for(l in this._tiles){var m=this._tiles[l].coords;m.z===this._tileZoom&&k.contains(e.point(m.x,m.y))||(this._tiles[l].current=!1)}if(1<Math.abs(f-this._tileZoom))return void this._setView(a,f);for(f=g.min.y;f<=g.max.y;f++)for(a=g.min.x;a<=g.max.x;a++)if(l=new e.Point(a,f),l.z=this._tileZoom,this._isValidTile(l))(k=this._tiles[this._tileCoordsToKey(l)])?k.current=!0:d.push(l);if(d.sort(function(a,d){return a.distanceTo(h)-d.distanceTo(h)}),0!==d.length){this._loading||(this._loading=!0,this.fire("loading"));g=q.createDocumentFragment();for(a=0;a<d.length;a++)this._addTile(d[a],g);this._level.el.appendChild(g)}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var f=this._globalTileRange;if(!d.wrapLng&&(a.x<f.min.x||a.x>f.max.x)||!d.wrapLat&&(a.y<f.min.y||a.y>f.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return e.latLngBounds(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var d=this._map,f=this.getTileSize(),g=a.scaleBy(f),f=g.add(f),g=d.unproject(g,a.z);a=d.unproject(f,a.z);return this.options.noWrap||(g=d.wrapLatLng(g),a=d.wrapLatLng(a)),new e.LatLngBounds(g,a)},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=a.split(":");var d=new e.Point(+a[0],+a[1]);return d.z=+a[2],d},_removeTile:function(a){var d=this._tiles[a];d&&(e.DomUtil.remove(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){e.DomUtil.addClass(a,"leaflet-tile");var d=this.getTileSize();a.style.width=d.x+"px";a.style.height=d.y+"px";a.onselectstart=e.Util.falseFn;a.onmousemove=e.Util.falseFn;e.Browser.ielt9&&1>this.options.opacity&&e.DomUtil.setOpacity(a,this.options.opacity);e.Browser.android&&!e.Browser.android23&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,d){var f=this._getTilePos(a),g=this._tileCoordsToKey(a),h=this.createTile(this._wrapCoords(a),e.bind(this._tileReady,this,a));this._initTile(h);2>this.createTile.length&&e.Util.requestAnimFrame(e.bind(this._tileReady,this,a,null,h));e.DomUtil.setPosition(h,f);this._tiles[g]={el:h,coords:a,current:!0};d.appendChild(h);this.fire("tileloadstart",{tile:h,coords:a})},_tileReady:function(a,d,f){this._map&&(d&&this.fire("tileerror",{error:d,tile:f,coords:a}),f=this._tileCoordsToKey(a),(f=this._tiles[f])&&(f.loaded=+new Date,this._map._fadeAnimated?(e.DomUtil.setOpacity(f.el,0),e.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=e.Util.requestAnimFrame(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),d||(e.DomUtil.addClass(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),e.Browser.ielt9||!this._map._fadeAnimated?e.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(e.bind(this._pruneTiles,this),250))))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var d=new e.Point(this._wrapX?e.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?e.Util.wrapNum(a.y,this._wrapY):a.y);return d.z=a.z,d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new e.Bounds(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});e.gridLayer=function(a){return new e.GridLayer(a)};e.Util.extend(e.GridLayer.prototype,{options:e.Util.extend(e.GridLayer.prototype.options,{visible:!0,zIndex:2}),onAdd:function(){this._initContainer();this._levels={};this._tiles={};this.options.visible&&(this._resetView(),this._update())},visible:function(a){this.options.visible=a;this._container&&this.options.visible!==v&&null!==this.options.visible&&(this._container.style.display=a?"block":"none")},getVisible:function(){return this.options.visible},getOpacity:function(){return this.options.opacity},getZIndex:function(a){return this.options.zIndex},_initContainer:function(){this._container||(this._container=e.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this._container.style.display=this.options.visible?"block":"none",this.getPane().appendChild(this._container))},_getTiledPixelBounds:function(a){var d=this._map;a=d.project(a,this._tileZoom).floor();d=d.getSize().divideBy(2);return new e.Bounds(a.subtract(d),a.add(d))},_update:function(a){var d=this._map;if(d){var f=d.getZoom();if(a===v&&(a=d.getCenter()),this._tileZoom!==v){var d=this._getTiledPixelBounds(a),g=this._pxBoundsToTileRange(d),h=g.getCenter(),d=[],k;for(k in this._tiles)this._tiles[k].current=!1;if(1<Math.abs(f-this._tileZoom))return void this._setView(a,f);for(f=g.min.y;f<=g.max.y;f++)for(a=g.min.x;a<=g.max.x;a++)if(k=new e.Point(a,f),k.z=this._tileZoom,this._isValidTile(k)){var l=this._tiles[this._tileCoordsToKey(k)];l?l.current=!0:d.push(k)}if(d.sort(function(a,d){return a.distanceTo(h)-d.distanceTo(h)}),0!==d.length){this._loading||(this._loading=!0,this.fire("loading"));g=q.createDocumentFragment();for(a=0;a<d.length;a++)this._addTile(d[a],g);this._level.el.appendChild(g)}}}},_getTilePos:function(a){var d=this._map;return a.scaleBy(this.getTileSize(),d.options.crs.code).subtract(this._level.origin)}});e.TileLayer=e.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,d){this._url=a;d=e.setOptions(this,d);d.detectRetina&&e.Browser.retina&&0<d.maxZoom&&(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom++):(d.zoomOffset++,d.maxZoom--),d.minZoom=Math.max(0,d.minZoom));"string"==typeof d.subdomains&&(d.subdomains=d.subdomains.split(""));e.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){return this._url=a,d||this.redraw(),this},createTile:function(a,d){var f=q.createElement("img");return e.DomEvent.on(f,"load",e.bind(this._tileOnLoad,this,d,f)),e.DomEvent.on(f,"error",e.bind(this._tileOnError,this,d,f)),this.options.crossOrigin&&(f.crossOrigin=""),f.alt="",f.setAttribute("role","presentation"),f.src=this.getTileUrl(a),f},getTileUrl:function(a){var d={r:e.Browser.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(d.y=a),d["-y"]=a);return e.Util.template(this._url,e.extend(d,this.options))},_tileOnLoad:function(a,d){e.Browser.ielt9?setTimeout(e.bind(a,this,null,d),0):a(null,d)},_tileOnError:function(a,d,f){var e=this.options.errorTileUrl;e&&(d.src=e);a(f,d)},getTileSize:function(){var a=this._map,d=e.GridLayer.prototype.getTileSize.call(this),f=this._tileZoom+this.options.zoomOffset,g=this.options.minNativeZoom,h=this.options.maxNativeZoom;return null!==g&&g>f?d.divideBy(a.getZoomScale(g,f)).round():null!==h&&f>h?d.divideBy(a.getZoomScale(h,f)).round():d},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,d=this.options.maxZoom,f=this.options.zoomOffset,e=this.options.minNativeZoom,h=this.options.maxNativeZoom;return this.options.zoomReverse&&(a=d-a),a+=f,null!==e&&e>a?e:null!==h&&a>h?h:a},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,d;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=e.Util.falseFn,d.onerror=e.Util.falseFn,d.complete||(d.src=e.Util.emptyImageUrl,e.DomUtil.remove(d)))}});e.tileLayer=function(a,d){return new e.TileLayer(a,d)};e.Util.extend(e.TileLayer.prototype,{options:e.Util.extend(e.TileLayer.prototype.options,{tileSize:256}),createTile:function(a,d){var f=q.createElement("img");return e.DomEvent.on(f,"load",e.bind(this._tileOnLoad,this,d,f)),e.DomEvent.on(f,"error",e.bind(this._tileOnError,this,d,f)),this.options.crossOrigin&&(f.crossOrigin=""),f.alt="",f.src=this.getTileUrl(a.x,a.y,this._getZoomForUrl(),a),f},getTileUrl:function(a,d,f,g){return e.Util.template(this._url,e.extend({r:this.options.detectRetina&&e.Browser.retina&&0<this.options.maxZoom?"@2x":"",s:this._getSubdomain(g),x:a,y:this.options.tms?this._globalTileRange.max.y-d:d,z:f},this.options))},setTileUrlFunc:function(a){this.getTileUrl=a}});e.GridVectorLayer=e.Layer.extend({options:{pane:"tilePane",tileSize:256,opacity:1,visible:!0,zIndex:2,updateWhenIdle:e.Browser.mobile,updateInterval:200,attribution:null,bounds:null,minZoom:0},initialize:function(a){e.setOptions(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._deltTiles=[];this._resetView();this._update();this._firstRequest()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){e.DomUtil.remove(this._container);a._removeZoomLimit(this);this._tileZoom=this._container=null},bringToFront:function(){return this._map&&(e.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(e.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},visible:function(a){this.options.visible=a;this._container&&this.options.visible!==v&&null!==this.options.visible&&(this._container.style.display=a?"block":"none")},getVisible:function(){return this.options.visible},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},getOpacity:function(){return this.options.opacity},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getZIndex:function(a){return this.options.zIndex},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var a={viewreset:this._resetAll,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=e.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return q.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof e.Point?a:new e.Point(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==v&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d,f=this.getPane().children,e=-a(-(1/0),1/0),h=0,k=f.length;k>h;h++)d=f[h].style.zIndex,f[h]!==this._container&&d&&(e=a(e,+d));isFinite(e)&&(this.options.zIndex=e+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!e.Browser.ielt9&&this._map._fadeAnimated){e.DomUtil.setOpacity(this._container,this.options.opacity);var a=+new Date,d=!1,f=!1,g;for(g in this._tiles){var h=this._tiles[g];if(h.current&&h.loaded){var k=Math.min(1,(a-h.loaded)/200);e.DomUtil.setOpacity(h.el,k);1>k?d=!0:(h.active&&(f=!0),h.active=!0)}}f&&!this._noPrune&&this._pruneTiles();d&&(e.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=e.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=e.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),this._container.style.display=this.options.visible?"block":"none",this.getPane().appendChild(this._container),this._labelCanvas=this._createLabelCanvas(),this._initCanvasRenderer(),this._bindMapContainerEvent())},_bindMapContainerEvent:function(){var a,d=this._map,f=d._panes.mapPane.parentNode,e=this;d._panes.mapPane.parentNode&&d.addEventListener("resize",function(d){a=d.newSize;e._labelCanvas.width=a.x;e._labelCanvas.height=a.y;e._labelCanvas.style.width=a.x+"px";e._labelCanvas.style.height=a.y+"px";z.updateSize(a);z.yd()},f);this._map.on("canvas",this._pruneTiles,this)},_createLabelCanvas:function(){var a=this._map.getSize(),d=q.createElement("canvas");return d.width=a.x,d.height=a.y,d.style.position="absolute",d.style.zIndex="19",d.style.width=a.x+"px",d.style.height=a.y+"px",d.style.left="0px",d.style.top="0px",this._container.appendChild(d),d},_initCanvasRenderer:function(){z.init(this._map,this._url);var a=this._map,d=a.getCenter(),f=a.getZoom();z.setContainer(this._container,this._labelCanvas,f,a.getSize(),this._tiles,d.lng,d.lat)},_normalRequest:function(a,d){var f=this._map,e=f.getCenter();d=d||f.getZoom();if(z.updateCenter(e.lng,e.lat,d),a.length){var e={},h;for(h in a)f=a[h].x+":"+a[h].y+":"+a[h].z,e[f]=this._tiles[f];z.loadTile(e,d)}else z.yd()},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a===v)return v;for(var f in this._levels)this._levels[f].el.children.length||f===a?this._levels[f].el.style.zIndex=d-Math.abs(a-f):(e.DomUtil.remove(this._levels[f].el),delete this._levels[f]);f=this._levels[a];var g=this._map;return f||(f=this._levels[a]={},f.el=e.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),f.el.style.zIndex=d,f.origin=g.project(g.unproject(g.getPixelOrigin()),a).round(),f.zoom=a,this._setZoomTransform(f,g.getCenter(),g.getZoom()),e.Util.falseFn(f.el.offsetWidth)),this._level=f,f},_pruneTiles:function(){if(this._map){var a,d,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom)return this._removeAllTiles();for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)if(d=this._tiles[a],d.current&&!d.active)f=d.coords,this._retainParent(f.x,f.y,f.z,f.z-5)||this._retainChildren(f.x,f.y,f.z,f.z+2);for(a in this._tiles)this._tiles[a].retain||(this._removeTile(a),z.tiles.cl(a))}},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_resetAll:function(){for(var a in this._levels)e.DomUtil.remove(this._levels[a].el),delete this._levels[a];this._removeAllTiles();this._tileZoom=null;this._resetView()},_retainParent:function(a,d,f,e){a=Math.floor(a/2);d=Math.floor(d/2);--f;var g=this._tiles[a+":"+d+":"+f];return g&&g.active?(g.retain=!0,!0):(g&&g.loaded&&(g.retain=!0),f>e?this._retainParent(a,d,f,e):!1)},_retainChildren:function(a,d,f,e){for(var g=2*a;2*a+2>g;g++)for(var k=2*d;2*d+2>k;k++){var l=this._tiles[g+":"+k+":"+(f+1)];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),e>f+1&&this._retainChildren(g,k,f+1,e))}},_resetView:function(a){a=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){z.init(null,this._url);this._setView(a.center,a.zoom,!0,a.noUpdate)},_firstRequest:function(a){var d=this._map,f=d.getCenter();a=a||d.getZoom();z.setContainer(this._container,this._labelCanvas,a,d.getSize(),this._tiles,f.lng,f.lat);z.loadTile(this._tiles,a)},_setView:function(a,d,f,e){var g=Math.round(d);(this.options.maxZoom!==v&&g>this.options.maxZoom||this.options.minZoom!==v&&g<this.options.minZoom)&&(g=v);var k=g!==this._tileZoom;(!e||k)&&(this._tileZoom=g,this._updateLevels(),this._resetGrid(),g!==v&&this._update(a),this._noPrune=!!f);this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var f in this._levels)this._setZoomTransform(this._levels[f],a,d)},_setZoomTransform:function(a,d,f){var g=this._map.getZoomScale(f,a.zoom);d=a.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(d,f)).round();e.Browser.any3d?e.DomUtil.setTransform(a.el,d,g):e.DomUtil.setPosition(a.el,d)},_resetGrid:function(){var a=this._map,d=a.options.crs,f=this._tileSize=this.getTileSize(),e=this._tileZoom,h=this._map.getPixelWorldBounds(this._tileZoom);h&&(this._globalTileRange=this._pxBoundsToTileRange(h));this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],e).x/f.x),Math.ceil(a.project([0,d.wrapLng[1]],e).x/f.y)];this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],e).y/f.x),Math.ceil(a.project([d.wrapLat[1],0],e).y/f.y)]},_onMoveEnd:function(a){if(this._map&&!this._map._animatingZoom&&(a.originalEvent,"move"==a.type&&(z.__isDrawLabel=!1),this._resetView(),"moveend"==a.type)){z.__isDrawLabel=!0;a=e.DomUtil.getStyle(this._map._panes.mapPane,"transform").match(/\-?[0-9]+/g);var d=-parseInt(a[1]),f=-parseInt(a[2]);isNaN(d)||isNaN(f)?(d=-parseInt(a[0]),f=-parseInt(a[1]),e.DomUtil.setPosition(this._labelCanvas,{x:d,y:f})):e.DomUtil.setPosition(this._labelCanvas,{x:d,y:f});this._normalRequest([],this._tileZoom);z.updateTiles(this._tiles);this._normalRequest([].concat(this._deltTiles),this._tileZoom);this._deltTiles=[]}},_getTiledPixelBounds:function(a){var d=this._map;a=d.project(a,this._tileZoom).floor();d=d.getSize();return new e.Bounds(a.subtract(d),a.add(d))},_update:function(a){var d=this._map;if(d){var f=d.getZoom();if(a===v&&(a=d.getCenter()),this._tileZoom!==v){var d=this._getTiledPixelBounds(a),g=this._pxBoundsToTileRange(d),h=g.getCenter(),d=[],k;for(k in this._tiles)this._tiles[k].current=!1;if(1<Math.abs(f-this._tileZoom))return void this._setView(a,f);for(f=g.min.y;f<=g.max.y;f++)for(a=g.min.x;a<=g.max.x;a++)if(k=new e.Point(a,f),k.z=this._tileZoom,this._isValidTile(k)){var l=this._tiles[this._tileCoordsToKey(k)];l?l.current=!0:d.push(k)}if(d.sort(function(a,d){return a.distanceTo(h)-d.distanceTo(h)}),0!==d.length){this._loading||(this._loading=!0,this.fire("loading"));g=q.createDocumentFragment();for(a=0;a<d.length;a++)this._addTile(d[a],this._level.el);this._level.el.appendChild(g)}this._deltTiles=this._deltTiles.concat(d)}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var f=this._globalTileRange;if(!d.wrapLng&&(a.x<f.min.x||a.x>f.max.x)||!d.wrapLat&&(a.y<f.min.y||a.y>f.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return e.latLngBounds(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var d=this._map,f=this.getTileSize(),g=a.scaleBy(f),f=g.add(f),g=d.wrapLatLng(d.unproject(g,a.z));a=d.wrapLatLng(d.unproject(f,a.z));return new e.LatLngBounds(g,a)},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){a=a.split(":");var d=new e.Point(+a[0],+a[1]);return d.z=+a[2],d},_removeTile:function(a){var d=this._tiles[a];d&&(e.DomUtil.remove(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){var d=this.getTileSize();a.width=d.x;a.height=d.y;a.style.width=d.x+"px";a.style.height=d.y+"px"},_getkey:function(a){a=this._tileCoordsToKey(a).split(",");return e.g.kt(a[1],a[2],a[0])},_addTile:function(a,d){var f=this._getTilePos(a),g=this._tileCoordsToKey(a),h=this.createTile(this._wrapCoords(a),e.bind(this._tileReady,this,a));if(this._initTile(h),2>this.createTile.length&&e.Util.requestAnimFrame(e.bind(this._tileReady,this,a,null,h)),e.DomUtil.setPosition(h,f),z.S.sa)h.width=h.height=2*this.options.tileSize/(18<a.z?Math.pow(2,18-a.z):1);this._tiles[g]={el:h,coords:a,current:!0};d.appendChild(h);this.fire("tileloadstart",{tile:h,coords:a})},_tileReady:function(a,d,f){this._map&&(d&&this.fire("tileerror",{error:d,tile:f,coords:a}),d=this._tileCoordsToKey(a),(f=this._tiles[d])&&(f.loaded=+new Date,this._map._fadeAnimated?(e.DomUtil.setOpacity(f.el,0),e.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=e.Util.requestAnimFrame(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),e.DomUtil.addClass(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:a}),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"))))},_getTilePos:function(a){var d=this._map;return a.scaleBy(this.getTileSize(),d.options.crs.code).subtract(this._level.origin)},_wrapCoords:function(a){var d=new e.Point(this._wrapX?e.Util.wrapNum(a.x,this._wrapX):a.x,this._wrapY?e.Util.wrapNum(a.y,this._wrapY):a.y);return d.z=a.z,d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new e.Bounds(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});e.gridLayer=function(a){return new e.GridLayer(a)};e=e||{};rb={};e.k={localStorage:!0,Ag:"1.3.12.1",key:""};(function(){function a(a){return-1!==d.indexOf(a)}config=["608d75903d29ad471362f8c58c550daf",[115.423411,39.442758,117.514625,41.060816,116.405285,39.904989],"",1,"1.3",null,"110000","",!0,!0];var d=navigator.userAgent.toLowerCase(),f=u,g=a("ucbrowser"),h=a("micromessenger"),k=a("mqqbrowser"),l="ActiveXObject"in f,m=l&&!f.XMLHttpRequest,n=l&&!q.querySelector,p=l&&!q.addEventListener,t=l&&a("ie 9"),r=l&&a("rv:11"),A=f.navigator&&f.navigator.msPointerEnabled&&!!f.navigator.msMaxTouchPoints,G=A||a("touch")||"ontouchstart"in q,E=a("webkit"),v=a("chrome"),x=a("firefox"),w=a("android"),B=-1!==d.search(/android [123]/),H=w&&!B,z=a("windows phone"),C="devicePixelRatio"in f&&1<f.devicePixelRatio||l&&"matchMedia"in f&&f.matchMedia("(min-resolution:144dpi)")&&f.matchMedia("(min-resolution:144dpi)").matches,L=a("ipad;"),D=L&&C,F=a("ipod touch;"),N=a("iphone;"),L=N||L||F,P=a("safari"),Q=L&&-1===d.search(/ os [456]_/),J=w||L||z||a("mobile")||"undefined"!=typeof orientation,O=q.documentElement,Y=l&&"transition"in O.style,Z=!!q.createElementNS&&!!q.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,V=!!q.createElement("canvas").getContext,W="WebKitCSSMatrix"in f&&"m11"in new u.WebKitCSSMatrix,aa="MozPerspective"in O.style,O="OTransition"in O.style,S=Y||W||aa||O,X=a("windows nt"),T=!J&&X&&-1!==d.search(/nt [1-5]\./),ba=a("baidubrowser"),R;(R=!V)||(R=t)||((H=w&&!(H&&(-1!==d.search(/m351|firefox/)?0:h&&k?-1===d.search(/hm note|gt-|m1 note/):a("gt-n710")&&-1!==d.search(/android( |\/)4\.1/)?0:-1!==d.search(/ucbrowser\/((9\.[0-5]\.)|(10\.))/)?-1===d.search(/huawei( p6|h30)/):a("baidubrowser")?-1===d.search(/hm201|sm-g900/):-1!==d.search(/lbbrowser|360|liebao|oupeng|mqqbrowser|sogou|micromessenger|chrome/)||!a("ucbrowser")&&-1!==d.search(/sm-n900|(gt-(n710|i95|p[67]))|(mi( [1-4]|-one))|(huawei( p6|_c8813|h30| g750))|lenovo k900|coolpad_9150/))))||(N&&(N=screen.width,N=!(Q&&(g||h?!(375<N):P))),H=N||F||D||z||J&&x||X&&a("version")),R=H);h=R;z=!1;try{z="undefined"!=typeof f.localStorage}catch(da){}D=void 0!==config[8]?config[8]:!0;F=void 0!==config[9]?config[9]:!0;config.h={size:200,kp:a("macintosh"),EQ:X,Ns:ba,tT:k,Fk:l,td:m,zm:n,Oc:p,gN:l&&!r,BQ:E,jp:z,Sd:w,ER:B,Zp:g,chrome:v,QA:x,LS:Y,CQ:W,jS:aa,lT:O,HK:S,Y:J,iT:J&&E,ON:J&&W,hT:J&&f.opera,zB:L,uc:G,aC:A,MS:t,sa:C,eh:Z,Gk:V,RS:!!f.eR,yC:h,hg:D&&!h&&!T,Xt:F&&!!f.WebSocket&&!ba,xC:!Z&&J&&V};config.h.xu=config.h.Sd?"android":config.h.zB?"ios":config.h.EQ?"windows":config.h.kp?"mac":"other";f=u;f="http map anip layers overlay0 brender mrender".split(" ");config.vd="main";config.h.uc&&(f+=",touch",config.vd+="t");config.h.Y||(f+=",mouse",config.vd+="m");config.vd+="c";config.h.hg&&(config.vd+="v",f+=",vectorlayer,overlay",f+=",vp",config.vd+="p");config[7]&&(f+=","+config[7],config.vd+=config[7].replace(",","").replace(eval("/AMap./gi"),""));config.bE=(f+",sync").split(",");u.AMap=u.AMap||{};u.AMap.Ag="1.3.12.1";(function(a){e.h=a.h;e.vd=a.vd;a.h=null;e.k.Va=a[2].split(",")[0];"https"===(e.k.Ic=e.k.Va.split(":")[0])&&(e.k.jE="wss",e.k.Jb=e.k.Jb.replace("http","https"),e.k.mp=e.k.mp.replace("http","https"),e.k.Pu=e.k.Pu.replace("http","https"),e.k.Nu=e.k.Nu.replace("http","https"),e.k.Vp=e.k.Vp.replace("http","https"),e.k.bn=e.k.bn.replace("http","https"));var d=u.location.href;0!==d.indexOf("http")&&u.parent&&u.parent!==u&&(d=u.parent.location.href);d=encodeURIComponent(d);e.k.zo=d;e.k.ih=e.k.Va+"/theme/v1.3/markers/"+(e.h.sa?"b":"n");e.k.mode=Number(a[3]);e.k.Af=a[1];e.k.key=a[0];e.k.zz=a[4];e.k.Je=a[5];e.k.vK=a[6]})(config)})();e.VectorLayer=e.GridVectorLayer.extend({options:{maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tileSize:256,maxNativeZoom:null,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,d){this._url=a;d=e.setOptions(this,d);d.detectRetina&&e.Browser.retina&&0<d.maxZoom&&(d.tileSize=Math.floor(d.tileSize/2),d.zoomOffset++,d.minZoom=Math.max(0,d.minZoom),d.maxZoom--);"string"==typeof d.subdomains&&(d.subdomains=d.subdomains.split(""));e.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){return this._url=a,d||this.redraw(),this},createTile:function(a,d){var f=q.createElement("canvas");return this._canvasCtxCache=f.getContext("2d"),this.options.crossOrigin&&(f.crossOrigin=""),f.alt="",f.width="",f},_drawContext:function(a,d){this._level.zoom;this._tileids},getTileUrl:function(a,d,f,g){return e.Util.template(this._url,e.extend({r:this.options.detectRetina&&e.Browser.retina&&0<this.options.maxZoom?"@2x":"",s:this._getSubdomain(g),x:a,y:this.options.tms?this._globalTileRange.max.y-d:d,z:f},this.options))},_tileOnLoad:function(a,d){e.Browser.ielt9?setTimeout(e.bind(a,this,null,d),0):a(null,d)},setTileUrlFunc:function(a){this.getTileUrl=a},_tileOnError:function(a,d,f){var e=this.options.errorTileUrl;e&&(d.src=e);a(f,d)},getTileSize:function(){var a=this._map,d=e.GridLayer.prototype.getTileSize.call(this),f=this._tileZoom+this.options.zoomOffset,g=this.options.maxNativeZoom;return null!==g&&f>g?d.divideBy(a.getZoomScale(g,f)).round():d},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this.options,d=this._tileZoom;return a.zoomReverse&&(d=a.maxZoom-d),d+=a.zoomOffset,null!==a.maxNativeZoom?Math.min(d,a.maxNativeZoom):d},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,d;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=e.Util.falseFn,d.onerror=e.Util.falseFn,d.complete||(d.src=e.Util.emptyImageUrl,e.DomUtil.remove(d)))}});e.vectorLayer=function(a,d){return new e.VectorLayer(a,d)};e.__Class=function(){};e.__Class.extend=e.__Class.extend=function(a){function d(){}function f(){this.r&&(this.r.apply(this,arguments),this.CLASS_NAME&&e.BuryPoint.add(this.CLASS_NAME))}d.prototype=this.prototype;var g=new d;g.constructor=f;f.prototype=g;for(var h in this)this.hasOwnProperty(h)&&"prototype"!==h&&(f[h]=this[h]);return a.ID&&(e.__extend(f,a.ID),delete a.ID),a.jb&&(e.__extend.apply(null,[g].concat(a.jb)),delete a.jb),a.F&&g.F&&(a.F=e.__extend({},g.F,a.F)),e.__extend(g,a),a.toString&&(g.toString=a.toString),f.Dd=this.prototype,f};e.__extend=function(a){var d,f,e,h,k=Array.prototype.slice.call(arguments,1);f=0;for(e=k.length;e>f;f+=1)for(d in h=k[f]||{})Object.prototype.hasOwnProperty.call(h,d)&&("function"==typeof h[d]&&"function"==typeof a[d]&&(h[d].Sa=a[d]),a[d]=h[d]);return a};e.g={Qp:[],Wa:4.007501668557849E7,gL:"ASDFGHJKLQWERTYUIO!sdfghjkl",qb:function(a){if("object"==typeof a){var d,f={};for(d in a)a.hasOwnProperty(d)&&(f[d]=e.g.qb(a[d]));return f}return a},CB:function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&1===a.nodeType&&"string"==typeof a.nodeName},decryptionLngLats:function(a){var d,f,e,h,k;f=[];e=NaN;h=0;for(k=a.length;k>h;h+=1)d=a[h],d=this.gL.indexOf(d),isNaN(e)?e=27*d:(f.push(e+d-333),e=NaN);return f},CP:function(a,d){for(var f=Math.ceil(d.length/8),e=0;f>e;e+=1){var h=8*e,k=h+8;for(k>d.length&&(k=d.length);k>h;h+=1)a(d[h])}},kt:function(a,d,f){var e,h;return e=Math.floor(f/2),h=f-e,e=(1<<e)-1<<h,h=(1<<h)-1,[f,a&e|d&h,d&e|a&h]},gj:function(a){return a?encodeURIComponent(a):""},gc:function(a,d,f,e){if(f=a[d].i[f],"undefined"==typeof f)return null;if(a=a[d].s,"number"==typeof f)return a[f];for(;"undefined"==typeof f[e.toString()]&&(--e,!(3>e)););return e=f[e.toString()],"number"==typeof e?a[e]:null},decryptionColor:function(a){for(var d=[],f=0,e=a.length;e>f;f+=2)d.push(parseInt(a.substr(f,2),16));return d.push((d.shift()/255).toFixed(2)),"rgba("+d.join(",")+")"},Ik:function(a){for(var d in a)if(a.hasOwnProperty(d))return!1;return!0},km:function(a,d){return 0>d?a:a.slice(0,d).concat(a.slice(d+1,a.length))},indexOf:function(a,d){if(a&&!a.length)return-1;if(a.indexOf)return a.indexOf(d);for(var f=0;f<a.length;f+=1)if(a[f]===d)return f;return-1},bind:function(a,d){var f=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(d,f||arguments)}},Na:function(a,d){return d=d||{},a.F=e.extend({},a.F,d),a.F},LA:function(){return!1},KM:function(a,d){return(a||"")+Math.round(Math.random()*Math.pow(10,d||6))},Vb:function(){var a=0;return function(d){return d._amap_id||(a+=1,d._amap_id=a),d._amap_id}}(),lM:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d",mj:Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},ZS:function(a,d,f,e){var g;if(e){var k,l=0,m=this.mj;g=function(){return k=m(),d>k-l?!1:(l=k,void a.apply(f,arguments))}}else{var n,p,t;t=function(){n=!1;p&&(g.apply(f,p),p=!1)};g=function(){n?p=arguments:(n=!0,a.apply(f,arguments),setTimeout(t,d))}}return g},Ff:function(a,d){return Number(Number(a).toFixed(d||0))},isArray:function(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)},KD:function(a){var d=0;if(0===a.length)return d;for(var f,e=0,h=a.length;h>e;e+=1)f=a.charCodeAt(e),d=(d<<5)-d+f,d&=d;return d},iC:function(a){return"undefined"!=typeof JSON&&JSON.stringify?e.g.KD(JSON.stringify(a)):null},MT:function(a,d){if(d||!a.hasOwnProperty("_amap_hash")){var f=e.g.iC(a);f&&(a._amap_hash=f)}return a._amap_hash},iepngFix:function(a){function d(){for(var a;f.length;)a=f.shift(),u.DD_belatedPNG.fixPng(a);g.Wt=!0}this.QC||(this.QC=[],this.Wt=!1);var f=this.QC,g=this;if("img"===a.tagName.toLowerCase())f.push(a);else{a=a.getElementsByTagName("*");for(var h=0;h<a.length;h+=1)f.push(a[h])}u.DD_belatedPNG&&this.Wt?setTimeout(function(){d()},100):this.Wt||e.Ya.load("AMap.FixPng",d)},ka:function(a){if(e.g.isArray(a))if(e.g.isArray(a[0]))for(var d=0;d<a.length;d+=1)a[d]=e.g.ka(a[d]);else if(d=typeof a[0],"string"===d||"number"===d)return new e.LngLat(a[0],a[1]);return a},ii:function(a){return e.g.isArray(a)?new e.Size(a[0],a[1]):a}};(function(){function a(a){u.clearTimeout(a)}function d(a){var d,f,e=["webkit","moz","o","ms"];for(d=0;d<e.length&&!f;d+=1)f=u[e[d]+a];return f}function f(a){var d=+new Date,f=Math.max(0,40-(d-g));return g=d+f,u.setTimeout(a,f)}var g=0,h=u.requestAnimationFrame||d("RequestAnimationFrame")||f,k=u.cancelAnimationFrame||d("CancelAnimationFrame")||d("CancelRequestAnimationFrame")||a;e.g.yg=function(a,d,f){return a=e.g.bind(a,d),f?void a():h.call(u,a,void 0)};e.g.Go=function(a){a&&k.call(u,a)}})();e.oa={e:function(a,d,f,e,h){if(this.Xd(a,d,f||this))return this;var g=this.Rf=this.Rf||{};return g[a]=g[a]||[],h?g[a].unshift({xa:d,he:f||this,mh:e}):g[a].push({xa:d,he:f||this,mh:e}),"complete"===a&&this.Ab&&this.q(a),this},Xd:function(a,d,f){var e=this.Rf;if(d&&f){if(e&&a in e&&e[a])for(var h=0;h<e[a].length;h+=1)if(e[a][h].xa===d&&e[a][h].he===f)return!0;return!1}return e&&a in e&&e[a]&&0<e[a].length},D:function(a,d,f){if(!this.Xd(a))return this;var e=this.Rf;if(e&&e[a])for(var h=0;h<e[a].length;h+=1)if(!(e[a][h].xa!==d&&"mv"!==d||f&&e[a][h].he!==f)){e[a].splice(h,1);e[a].length||delete e[a];break}return this},q:function(a,d){if(!this.Xd(a))return this;for(var f=e.extend({type:a},d),g=[].concat(this.Rf[a]),h=0;h<g.length;h+=1)g[h].xa&&(g[h].xa.call(g[h].he||this,f),g[h].mh&&this.Rf[a]&&this.Rf[a].splice(h,1));return this}};e.oa.on||(e.oa.on=e.oa.e);e.oa.off||(e.oa.off=e.oa.D);e.oa.emit||(e.oa.emit=e.oa.q);e.d={get:function(a){return"string"==typeof a?q.getElementById(a):a},bT:function(a,d){var f=q.head||q.getElementsByTagName("head")[0];if(f){var e=q.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("type","text/css");e.setAttribute("href",a);d?f.appendChild(e):f.insertBefore(e,f.firstChild)}else q.write("\x3clink rel\x3d'stylesheet' href\x3d'"+a+"'/\x3e")},gc:function(a,d){var f=a.style[d];return!f&&a.currentStyle&&(f=a.currentStyle[d]),f&&"auto"!==f||!q.defaultView||(f=(f=q.defaultView.getComputedStyle(a,null))?f[d]:null),f&&"auto"!==f||"height"!==d||(f=a.clientHeight+"px"),f&&"auto"!==f||"width"!==d||(f=a.clientWidth+"px"),"auto"===f?null:f},tm:function(a){return a?new e.Size(a.clientWidth||q.body.clientWidth,a.clientHeight||(e.h.Fk&&"CSS1Compat"===q.compatMode?q.documentElement.clientHeight:q.body.clientHeight),!0):void 0},Ht:function(a){var d,f=0,g=0,h=a,k=q.body,l=q.documentElement,m=e.h.zm;do{if(f+=h.offsetTop||0,g+=h.offsetLeft||0,f+=parseInt(e.d.gc(h,"borderTopWidth"),10)||0,g+=parseInt(e.d.gc(h,"borderLeftWidth"),10)||0,d=e.d.gc(h,"position"),h.offsetParent===k&&"absolute"===d)break;if("fixed"===d){f+=k.scrollTop||l.scrollTop||0;g+=k.scrollLeft||l.scrollLeft||0;break}h=h.offsetParent}while(h);h=a;do{if(h===k)break;f-=h.scrollTop||0;g-=h.scrollLeft||0;e.d.XL()||!e.h.BQ&&!m||(g+=h.scrollWidth-h.clientWidth,m&&"hidden"!==e.d.gc(h,"overflow-y")&&"hidden"!==e.d.gc(h,"overflow")&&(g+=17));h=h.parentNode}while(h);return new e.Pixel(g,f)},XL:function(){return e.d.uG||(e.d.uG=!0,e.d.tG="ltr"===e.d.gc(q.body,"direction")),e.d.tG},create:function(a,d,f){return a=q.createElement(a),f&&(a.className=f),d&&d.appendChild(a),a},zA:function(){q.selection&&q.selection.empty&&q.selection.empty();this.MI||(this.MI=q.onselectstart,q.onselectstart=e.g.LA)},FA:function(){},Ek:function(a,d){return a&&d?0<a.className.length&&RegExp("(^|\\s)"+d+"(\\s|$)").test(a.className):void 0},Qb:function(a,d){a&&d&&!e.d.Ek(a,d)&&(a.className+=(a.className?" ":"")+d)},Nb:function(a,d){function f(a,f){return f===d?"":a}a&&d&&(a.className=a.className.replace(/(\S+)\s*/g,f).replace(/(^\s+|\s+$)/,""))},RM:function(a,d){return 1===d?"":"opacity"in a.style?"opacity:"+d:8<=q.documentMode?"-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+Math.ceil(100*d)+")'":"filter:alpha(opacity\x3d"+Math.ceil(100*d)+")"},mi:function(a,d){if("opacity"in a.style)a.style.opacity=d;else if("filter"in a.style){a=a.childNodes.length?a.childNodes:[a];for(var f=Math.round(100*d),e=0;e<a.length;e+=1)a[e].childNodes&&a[e].childNodes.length?this.mi(a[e],d):a[e].style&&(a[e].style.filter="",100!==f&&(a[e].style.filter=" progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"+f+")"))}},fv:function(a){for(var d=q.documentElement.style,f=0;f<a.length;f+=1)if(a[f]in d)return a[f];return!1},iB:function(a){var d=e.h.CQ;return"translate"+(d?"3d":"")+"("+a.x+"px,"+a.y+"px"+((d?",0":"")+")")},AS:function(a,d){return e.d.iB(d.add(d.multiplyBy(-1*a)))+(" scale("+a+") ")},IT:function(a,d,f){a.Od=d;!f&&e.h.HK?(d=e.d.iB(d),f=a.style[e.d.Zc].split("rotate"),1<f.length?(f[0]=d,a.style[e.d.Zc]=f.join("rotate")):a.style[e.d.Zc]=d,e.h.ON&&(a.style.WebkitBackfaceVisibility="hidden")):(a.style.left=d.x+"px",a.style.top=d.y+"px")},dd:function(a){return a.Od||(a.Od=a.style.left?new e.Pixel(parseInt(a.style.left),parseInt(a.style.top)):new e.Pixel(0,0)),a.Od},GT:function(a,d){a=a instanceof Array?a:[a];for(var f=0;f<a.length;f+=1)a[f].style.cssText=d},pD:function(a,d){return";"!==d[d.length-1]&&(d+=";"),d.toLowerCase()!==a.style.cssText.replace(/ /g,"").toLowerCase()?(a.style.cssText=d,!0):!1},Z:function(a,d){a=a instanceof Array?a:[a];for(var f=0;f<a.length;f+=1)for(var e in d)d.hasOwnProperty(e)&&(a[f].style[e]=d[e]);return this},SO:function(a){for(;a.childNodes.length;)a.removeChild(a.childNodes[0])},remove:function(a){a&&a.parentNode&&a.parentNode.removeChild(a)},rotate:function(a,d,f){var g=e.d.Zc;if(f=f||{x:a.clientWidth/2,y:a.clientHeight/2},g){var h;h=""+(" translate("+(f.x-a.clientWidth/2)+"px,"+(f.y-a.clientHeight/2)+"px)");h=h+(" rotate("+d+"deg)")+(" translate("+(a.clientWidth/2-f.x)+"px,"+(a.clientHeight/2-f.y)+"px)");a.style[g]=h}else g=Math.cos(d*Math.PI/180),d=Math.sin(d*Math.PI/180),a.style.filter="progid:DXImageTransform.Microsoft.Matrix()",0<a.filters.length&&(a=a.filters.item(0),a.PQ=-f.x*g+f.y*d+f.x,a.QQ=-f.x*d-f.y*g+f.y,a.M11=a.M22=g,a.M12=-(a.M21=d))},VM:function(a,d,f){var g=e.d.Zc;if(f=f||{x:a.clientWidth/2,y:a.clientHeight/2},g){var h;return h=""+(" translate("+(f.x-a.clientWidth/2)+"px,"+(f.y-a.clientHeight/2)+"px)"),h=h+(" rotate("+d+"deg)")+(" translate("+(a.clientWidth/2-f.x)+"px,"+(a.clientHeight/2-f.y)+"px)"),e.d.al[g]+":"+h}return""},Rm:function(a,d,f){a.width=d;a.height=f},getElementsByClassName:function(a,d,f){if(d=d||"*",f=f||q,f.getElementsByClassName)return f.getElementsByClassName(a);d=f.getElementsByTagName(d);a=RegExp("(^|\\s)"+a+"(\\s|$)");f=[];for(var e,h=0;h<d.length;h++)e=d[h],a.test(e.className)&&f.push(e);return f},fillText:function(a,d){return a?(void 0!==a.textContent?a.textContent=d:void 0!==a.innerText?a.innerText=d:a.innerHTML=d,a):void 0}};(function(){var a,d=e.d.fv(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);e.extend(e.d,{zA:function(){if(e.l.e(u,"selectstart",e.l.preventDefault),d){var f=q.documentElement.style;"none"!==f[d]&&(a=f[d],f[d]="none")}},FA:function(){e.l.D(u,"selectstart",e.l.preventDefault);d&&"none"!==a&&(q.documentElement.style[d]=a,a="none")},SL:function(){e.l.e(u,"dragstart",e.l.preventDefault)},mM:function(){e.l.D(u,"dragstart",e.l.preventDefault)}})})();e.d.Zc=e.d.fv(["WebkitTransform","OTransform","MozTransform","msTransform","transform"]);e.d.al={transform:"transform",WebkitTransform:"-webkit-transform",OTransform:"-o-transform",MozTransform:"-moz-transform",msTransform:"-ms-transform"};e.d.nq=e.d.fv(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);e.d.ZQ="webkitTransition"===e.d.nq||"OTransition"===e.d.nq?e.d.nq+"End":"transitionend";e.g.Qm=u.Qm?u.Qm.bind(u):function(a){var d=Date.now();return setTimeout(function(){a({xA:!1,ZD:function(){return Math.max(0,70-(Date.now()-d))}})},0)};e.g.cm=u.cm?u.cm.bind(u):function(a){clearTimeout(a)};(function(a){var d=a.__Class.extend({jb:[a.oa],r:function(){}});a.mn=new d})(e);(function(a){var d=a.Class.extend({jb:[a.oa],r:function(){this.qH()},qH:function(){a.mn&&a.mn.e("vecTileParsed.buildings",this.kH,this)},FB:function(a){return a.map.Ax},rD:function(a,d){if(d){var f=d.map;f&&f.Ax!==a&&(f.Ax=a,f.set("display",0))}},iR:function(){},xx:function(a,d){for(var f=0,e=a.length;e>f;f++){var g=a[f].Ss;0>d.indexOf(g)&&d.push(g)}},PA:function(a){if(!a)return null;a=a.getLayers();for(var d=0,f=a.length;f>d;d++)if(a[d]&&a[d]instanceof K)return a[d];return null},xM:function(a){if(a=this.PA(a)){if(!(a=a.get("tiles",null,!0))||(a=a[0],!a||!a.length))return null;for(var d=[],f=0,e=a.length;e>f;f++){var l=a[f];l.Ue&&l.Ue.Ts&&this.xx(l.Ue.Ts,d)}return d}},kH:function(a){if(a.hv&&a.hv.Ue&&(a=a.hv.Ue.Ts)){var d=[];this.xx(a,d);this.q("vecTileParsed.builds.found",{aL:d})}}});a.Qe=new d})(e);e.Pixel=e.Class.extend({initialize:function(a,d,f){if(isNaN(a)||isNaN(d))throw"Invalid Object: Pixel("+a+", "+d+")";this.x=f?Math.round(a):Number(a);this.y=f?Math.round(d):Number(d)},getX:function(){return this.x},getY:function(){return this.y},add:function(a,d){return new e.Pixel(this.x+a.x,this.y+a.y,d)},subtract:function(a,d){return new e.Pixel(this.x-a.x,this.y-a.y,d)},divideBy:function(a,d){return new e.Pixel(this.x/a,this.y/a,d)},multiplyBy:function(a,d){return new e.Pixel(this.x*a,this.y*a,d)},distance:function(a){var d=a.x-this.x;return a=a.y-this.y,Math.sqrt(d*d+a*a)},floor:function(){return new e.Pixel(Math.floor(this.x),Math.floor(this.y))},round:function(){return new e.Pixel(this.x,this.y,!0)},equals:function(a){return a instanceof e.Pixel&&this.x===a.x&&this.y===a.y},qb:function(){return new e.Pixel(this.x,this.y)},toString:function(){return this.x+","+this.y}});e.PixelBounds=e.Class.extend({initialize:function(){if(2===arguments.length)this.kb=arguments[0],this.Mb=arguments[1];else{if(!(1===arguments.length&&arguments[0]instanceof Array||4===arguments.length))throw"Invalid Object: PixelBounds("+arguments.join(",")+")";var a=arguments[0]instanceof Array?arguments[0]:arguments;this.kb=new e.Pixel(a[0],a[1]);this.Mb=new e.Pixel(a[2],a[3])}},getCenter:function(a){return new e.Pixel((this.kb.x+this.Mb.x)/2,(this.kb.y+this.Mb.y)/2,a)},contains:function(a){var d;return a instanceof e.PixelBounds?(d=a.kb,a=a.Mb):d=a,d.x>this.kb.x&&a.x<this.Mb.x&&d.y>this.kb.y&&a.y<this.Mb.y},getWidth:function(){return this.Mb.x-this.kb.x},getHeight:function(){return this.Mb.y-this.kb.y},intersects:function(a){var d=this.kb,f=this.Mb,e=a.kb;a=a.Mb;var h=a.y>=d.y-20&&e.y<=f.y+20;return a.x>=d.x-20&&e.x<=f.x+20&&h},toString:function(){return this.kb+";"+this.Mb},qb:function(){return new e.PixelBounds(this.kb.qb(),this.Mb.qb())}});e.xn=e.Class.extend({initialize:function(a,d,f,e){this.nw=a;this.uw=d;this.xw=f;this.Pw=e},transform:function(a,d){return this.sz(a.qb(),d)},sz:function(a,d){return d=d||1,a.x=d*(this.nw*a.x+this.uw),a.y=d*(this.xw*a.y+this.Pw),a},pQ:function(a,d){return d=d||1,new e.Pixel((a.x/d-this.uw)/this.nw,(a.y/d-this.Pw)/this.xw)}});e.Dg=e.Class.extend({initialize:function(a){this.gq=a.MAX_LATITUDE||85.0511287798;a.project&&a.unproject&&(this.project=a.project,this.unproject=a.unproject)}});e.Dg.Rv={project:function(a){return new e.Pixel(a.B,a.G)},unproject:function(a,d){return new e.LngLat(a.x,a.y,d)}};e.Dg.XE=new e.Dg({MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,f=this.gq,f=Math.max(Math.min(f,a.G),-f);return a=a.B*d,d=Math.log(Math.tan(Math.PI/4+f*d/2)),new e.Pixel(a,d,!1)},unproject:function(a,d){var f=180/Math.PI;return new e.LngLat(a.x*f,(2*Math.atan(Math.exp(a.y))-Math.PI/2)*f,d)}});e.Dg.Sv={gq:85.0840591556,kq:6356752.3142,jq:6378137,project:function(a){var d=Math.PI/180,f=this.gq,g=Math.max(Math.min(f,a.G),-f),h=this.jq,f=this.kq;return a=a.B*d*h,d*=g,h=f/h,h=Math.sqrt(1-h*h),g=h*Math.sin(d),g=Math.pow((1-g)/(1+g),.5*h),d=-f*Math.log(Math.tan(.5*(.5*Math.PI-d))/g),new e.Pixel(a,d)},unproject:function(a,d){for(var f=180/Math.PI,g=this.jq,h=this.kq,k=a.x*f/g,g=h/g,g=Math.sqrt(1-g*g),h=Math.exp(-a.y/h),l=Math.PI/2-2*Math.atan(h),m=15,n=.1;1E-7<Math.abs(n)&&(--m,0<m);)n=g*Math.sin(l),n=Math.PI/2-2*Math.atan(h*Math.pow((1-n)/(1+n),.5*g))-l,l+=n;return new e.LngLat(k,l*f,d)}};e.Pe={};e.Pe.hn={hp:function(a,d){var f=this.hd.project(a),e=this.scale(d);return this.Zm.sz(f,e)},yu:function(a,d,f){return d=this.scale(d),a=this.Zm.pQ(a,d),this.hd.unproject(a,f)},project:function(a){return this.hd.project(a)},scale:function(a){return 256*Math.pow(2,a)},If:function(a){return 12756274*Math.PI/(256*Math.pow(2,a))}};e.Pe.xE=e.extend({},e.Pe.hn,{code:"EPSG:3857",hd:e.Dg.XE,Zm:new e.xn(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(a){return this.hd.project(a).multiplyBy(6378137)}});e.S={};e.S.ye=e.Class.extend({jb:[e.oa,e.Kc],initialize:function(a,d){this.xyzObject=a;this.vc=[3,18];this.vq=e.g.Vb(this);a&&this.cd(["opacity","visible","zIndex","zooms"],a);this.w=d;this.J("display",d)},ef:function(){this.Hc&&this.kA();var a=this.Ca;if(a){if(a.length)for(var d=0;d<a.length;d+=1)a[d].parentNode&&a[d].parentNode.removeChild(a[d]);else a.parentNode&&a.parentNode.removeChild(a);this.Ca=null}this.xyzObject.ef&&this.xyzObject.ef();this.xyzObject.Cf=!1;this.xyzObject.S=null;this.bl();this.P&&(this.P.bl(),this.P.K=null,this.P.Un=null,this.P.w=null,this.P.bl(),this.P.Ew&&this.P.Ew(),this.P=null)},ia:function(a,d){this.xyzObject.q(a,d)},visibleChanged:function(){this.set("display",0)},zIndexChanged:function(){this.set("display",0)},Vu:function(a){e.d.mi(a,this.opacity)},opacityChanged:function(){var a=this.get("opacity");if(this.opacity=Math.min(Math.max(0,a),1),a=this.Ca)if(a.length)for(var d=0;d<a.length;d+=1)this.Vu(a[d]);else this.Vu(a)},Yo:function(){var a=this.get("bounds");if(a){if(a instanceof e.Bounds){var d=a.getNorthWest(),f=a.getSouthEast(),g=this.w.wb(new e.LngLat(180,0)).x,h=this.w.wb(d),k=this.w.wb(f),l=this.w.get("center");d.B>f.B?0<l.B?k.x+=g:h.x-=g:0<l.B?(0>d.B&&(h.x+=g),0>f.B&&(k.x+=g)):(0<d.B&&(h.x-=g),0<f.B&&(k.x-=g));this.j=[h.x,h.y,k.x,k.y]}return a instanceof e.PixelBounds&&(this.j=[a.kb.x,a.kb.y,a.Mb.x,a.Mb.y]),this.j}return null}});D.prototype.qb=function(){return new D(this.z,this.x,this.y)};D.prototype.toString=function(){return[this.z,this.x,this.y].join("/")};e.tile=function(a,d){this.xyzObject=a;this.key=a.toString();this.url=d};e.xyzObject=D;e.S.tile=e.S.ye.extend({r:function(a,d){arguments.callee.Sa.apply(this,arguments);this.J("tileSize",a);this.J("tiles",a);this.cd(["zooms","type","detectRetina","tileFun","errorUrl"],a);this.J("lang",d,!0);var f="overlayer"===a.get("type");this.Sf=!f&&!e.h.Y;(e.h.Oc||e.h.lU)&&(this.Sf=!1);var g=d.get("size"),g=g.width*g.height/65536;e.h.sa&&e.h.Y&&9<g&&(this.Sf=!1);this.Wf=!f;this.Xf=!f;this.J("reload",a)},ei:function(){return{yb:this.get("tileSize"),visible:this.get("visible"),j:this.Yo(),vc:this.get("zooms"),Bo:this.Sf,Wf:this.Wf,Xf:this.Xf,opacity:this.get("opacity"),af:this.get("tileFun"),sa:this.get("detectRetina")&&e.h.sa&&e.h.Y}},Yh:function(a){return e.P.$b.Eg?new e.P.$b.Eg(this,a):void 0}});e.S.Buildings=e.S.ye.extend({r:function(a,d){this.map=d;this.Kj=0;this.Jf=!1;this.ug=this.tg=0;this.Nk=[];arguments.callee.Sa.apply(this,arguments);this.uj=[];this.ne=new e.S.Hv;a&&(this.J("style",a),this.WP=a.get("stable")||!1,this.J("dataSources",a),this.J("bubble",a));this.J("display",d);this.AF()},ei:function(){return{visible:this.get("visible"),vc:this.get("zooms"),opacity:this.get("opacity"),zIndex:this.get("zIndex"),FK:this.xyzObject.get("alwaysRender")||!1}},dataSourcesChanged:function(){var a=this.get("dataSources");a&&("string"==typeof a?(new e.ga.pa(a)).e("complete",function(a){this.JC(a.data);this.dj=a.data;this.Jf=!0;this.set("display");this.Ab=!0;this.xyzObject.q("complete")},this):a.length&&(this.JC(a),this.dj=a,this.Jf=!0,this.set("display"),this.Ab=!0,this.xyzObject.q("complete")))},getDatas:function(){return this.dj},rQ:function(){if(this.xyzObject.dh){var a=this.Pp;this.tg=a.size.width+a.anchor.x;this.ug=a.size.height+a.anchor.y}},ia:function(a,d){var f={type:a,data:"mouseout"===a?this.EH||null:d.nk.lb,target:this.xyzObject};this.EH="mouseout"===a?null:d.nk.lb;this.xyzObject.q(a,f)},tR:function(){},$a:function(a){this.ia(a.type,a)},AF:function(){this.e("click",this.$a);this.e("dblclick",this.$a);this.e("mousedown",this.$a);this.e("mouseup",this.$a);this.e("mouseover",this.$a);this.e("mouseout",this.$a);this.e("touchstart",this.$a);this.e("touchend",this.$a)},xR:function(){this.D("click",this.$a);this.D("dblclick",this.$a);this.D("mousedown",this.$a);this.D("mouseup",this.$a);this.D("mouseover",this.$a);this.D("mouseout",this.$a);this.D("touchstart",this.$a);this.D("touchend",this.$a)},styleChanged:function(){this.Pp=this.get("style");this.rQ();this.set("display",0)},JC:function(a){if(a){this.clear();for(var d=this.map.get("resolution",18),f=0;f<a.length;f+=1){var g=a[f].lnglat;a[f].lnglat=e.g.ka(g);g=this.map.wb(g,18,d);g=new e.kd({name:"point-"+e.g.Vb(this),ja:new e.W.Bd([g.x,g.y],!0)});g.Mh=this;g.lb=a[f];this.xo(g)}}},dB:function(a){return"geojson"===a?new e.BE({map:this.map}):"topjson"===a?new e.aR({map:this.map}):"subway"===a?new e.YQ({map:this.map}):void 0},EO:function(a){if(a){var d,f={};if(a.rules){d=a.rules;for(var g=0,h=d.length;h>g;g+=1){for(var k=[],l=d[g].symbolizers,m=0,n=l.length;n>m;m+=1)l[m].fill&&(k[m]=new e.style.Bc.Iv(l[m].fill)),l[m].stroke&&(k[m]=new e.style.Bc.Yv(l[m].stroke));l=k;d[g].Rp=l;d[g]=new e.style.SE(d[g])}f.rules=d}if(a.symbolizers){d=a.symbolizers;a=0;for(g=d.length;g>a;a+=1)d[a].fill&&(d[a]=new e.style.Bc.Iv(d[a].fill)),d[a].stroke&&(d[a]=new e.style.Bc.Yv(d[a].stroke));f.Rp=d}a=new e.mq(f)}else a=new e.mq({});return this.set("style",a),a},wR:function(a,d){if(-1===e.g.indexOf(a,e.k.Va)){var f=new e.ga.pa(a);f.e("complete",function(f){f=this.Ua[a]=this.dB(d).wp(f);this.Ui(f);this.ia("complete")},this);f.e("error",this.Ka,this)}else(new e.ga.XMLHttpRequest(a)).e("complete",function(f){f=eval("("+f.data+")");f=this.Ua[a]=this.dB(d).wp(f);this.Ui(f)},this)},OO:function(a){a.Cj>this.jh&&(this.jh=a.Cj)},xo:function(a){if(this.ne.add(a),!this.Ro&&!this.xyzObject.dh){0===a.name.indexOf("circle")&&(a.e("rad",this.OO,this),this.jh||(this.jh=a.get("radius")),a.Cj>this.jh&&(this.jh=a.get("radius")));var d=a.get("strokeWeight")||0;(!this.Mk||d>this.Mk)&&(this.Mk=d)}this.WP||a.J("feature",this,!0)},Ui:function(a){this.Jf=!0;for(var d=0,f=a.length;f>d;d+=1)this.xo(a[d])},clear:function(){this.Jf=!0;this.ne.clear()},Gf:function(a){var d;return 0>a[0]?(d=[a[0]+e.g.Wa,a[1],e.g.Wa,a[3]],a=[0,a[1],a[2],a[3]],d=this.ne.Gf(d),a=this.ne.Gf(a),e.extend(d,a)):a[2]>e.g.Wa?(d=[a[0],a[1],e.g.Wa,a[3]],a=[0,a[1],a[2]-e.g.Wa,a[3]],d=this.ne.Gf(d),a=this.ne.Gf(a),e.extend(d,a)):this.ne.Gf(a)},vS:function(a){var d,f=this.get("style"),g=a.Oe;return f instanceof e.mq||(f=this.EO(f)),g&&0<g.length?d=f.pA(g,a):((f.kD.length||f.Oe.length)&&(d=f.HL(a)),d||(d=a.DM())),d},kB:function(a){function d(a,d){return a.Uo-d.Uo}var f,e,h,k,l,m=[],n={};for(f in a)if(a.hasOwnProperty(f)){h=a[f];k=h.get("zIndex");for(e in n)if(n.hasOwnProperty(e)&&(l=m[n[e]][2],l===k))break;"undefined"==typeof n[k]&&(m.push([[],[],k]),n[k]=m.length-1);k=m[n[k]];k[0].push(h)}m.sort(this.SP);a=0;for(f=m.length;f>a;a+=1)m[a][0].sort(d);return m},featureChanged:function(a){this.Jf=!0;var d=a.target,f=d.ja;0!==this.ne.FM([e.g.Vb(d)]).length&&(this.ne.remove(d,a.vj),f&&!a.QL&&this.ne.add(d))},XC:function(a){this.Jf=!0;for(var d,f=0,e=a.length;e>f;f+=1)d=a[f],d.ja.vj=null,d.bi(!0),d.Lj("feature")},LT:function(a,d){return a[1].zIndex===d[1].zIndex?e.g.Vb(a[1])-e.g.Vb(d[1]):a[1].zIndex-d[1].zIndex},SP:function(a,d){return a[2]-d[2]},ET:function(a){return a.zS()===e.S.cR.WQ},Yh:function(a){return this.Ro?new e.P.hi.wi(this,a):e.h.Gk&&e.P.canvas.wi?new e.P.canvas.wi(this,a):e.P.$b.wi&&!e.h.xC?new e.P.$b.wi(this,a):null}});e.S.Hv=e.Class.extend({r:function(){this.clear()},clear:function(){this.nj=[];this.Fu=new e.ze},add:function(a){var d=e.g.Vb(a),f=a.ja;this.nj[d]||(this.count+=1,this.nj[d]=a,f&&!e.j.equals(f.getBounds(),[1/0,1/0,-(1/0),-(1/0)])&&this.Fu.bp(f.getBounds(),a))},sS:function(){return this.nj},Gf:function(a){return this.Fu.zP(a)},FM:function(a){var d,f=a.length,e=[];for(d=0;f>d;d+=1)this.nj[a[d]]&&e.push(this.nj[a[d]]);return e},remove:function(a,d){var f=e.g.Vb(a).toString(),g=a.ja;this.nj[f]&&(delete this.nj[f],g&&(f="undefined"!=typeof d?d:g.getBounds(),this.Fu.remove(f,a)))}});e.Lv=e.Class.extend({hR:"assets/image/blank.gif",r:function(a,d,f){this.timeout=d||15E3;this.Bj=new e.Ad(1024);this.nh=new e.Ad(1024);this.nA=a;this.HA=f},zw:function(a){for(a&&this.nh.count>=this.nA&&(a=this.nh.hb.ya.value,a.Vg&&(this.nh.remove(a.url),this.ow(a)));this.Bj.count&&!(this.nh.count>=this.nA);)this.qG(this.Bj.shift())},FH:function(){if(!this.Bw){this.Bw=!0;var a=this;setTimeout(function(){a.Bw=!1;a.zw()},0)}},qG:function(a){var d=q.createElement("img");d.src=a.url;a.X=d;a.IN=this;a.startTime=+new Date;a.Mu=!0;d.complete?P(a,!0):(this.nh.set(a.url,a),d.onload=F(a,!0),d.onerror=F(a,!1),d.onabort=F(a,!1),a.gQ=setTimeout(F(a,!1),this.timeout))},ow:function(a){a.Mu&&(P(a,!1),a.Vg=!0,a.AR=!0)},aT:function(a,d,f){return this.QB(a.url,d,f,!0,a.xyzObject.z+"_"+a.xyzObject.x+"_"+a.xyzObject.y)},QB:function(a,d,f,g,h){var k=this.nh.get(a);if(k&&k.Vg)k.Vg=!1,k.Je=d,k.XA=f;else{if(k=new T(a,d,f),k.pN=g,k.key=h,this.Bj.get(e.g.Vb(k)))return;this.Bj.set(e.g.Vb(k),k);this.zw(!0)}return k},cL:function(a){a.Vg||(a.Vg=!0,this.Bj.remove(e.g.Vb(a)))},clear:function(a){if(this.Bj.forEach(function(a){a.Vg=!0}),this.Bj.clear(),a)for(;a=this.nh.pop();)this.ow(a);else this.nh.forEach(function(a){a.Vg=!0})}});var ca=function(){function a(a){return this.rq[e.g.Vb(a)]=a,this}function d(a){return delete this.rq[e.g.Vb(a)],this}return function(){function f(){var a,d,e=f.rq,l=[];for(d in e)Object.prototype.hasOwnProperty.call(e,d)&&l.push(e[d]);for(e=l.length-1;0<=e;--e)d=l[e].apply(this,arguments),void 0!==d&&(a=d);return a}return f.rq={},f.BR=a,f.xT=d,f}}(),z={init:function(a,d){this._map=a||this._map;this.La=new e.P.canvas.pf.Buildings;this.dataUrl=d||"vdata.amap.com";this.VD=2;this.Zh=0;this.yb=256;this.S=e.h;this.S.VD=2;this.Wm=[new e.Ad,new e.Ad,new e.Ad,new e.Ad,new e.Ad];this.dataProcesObjectArray=[{type:"region",show:!0,dataProcesObject:new e.region(this),Hc:0},{type:"road",show:!0,dataProcesObject:new e.road(this),Hc:0},{type:"building",show:!0,dataProcesObject:new e.building(this),Hc:0},{type:"roadlabel",show:!0,dataProcesObject:new e.roadlabel(this),Hc:1},{type:"poilabel",show:!0,dataProcesObject:new e.poilabel(this),Hc:1}];this.tiles=new e.Ov({size:200,Zu:.7,qt:2,Yu:300});this.__isDrawLabel=!0;this._La&&(this._La.__loadedImg__={});this.Ti&&this.size&&(this.Ti.width=this.size.x,this.Ti.height=this.size.y)},_formatTileIds:function(a,d){var f,g="",h=[],k;for(k in a)f=k.split(":"),h.push(k),g+=e.g.kt(f[0],f[1],f[2])+";";return 0==g.length?[g,h]:[g.substring(0,g.length-1),h]},loadTile:function(a,d){function f(g,h){var n=1;null==h&&(h="|",n=0);var k=g.indexOf(h);if(-1==k)m+=g;else{m+=g.substring(0,k+n);var p=JSON.parse(m);if(!p["x-vd-v"]){var t=p[0].split("-"),q=t[0]+":"+t[1]+":"+t[2],u=t[1]+":"+t[2]+":"+t[0];l.tiles.get(q)||(t=new e.tile(new D(t[0],t[1],t[2]),""),t.key=q,l.tiles.set(q,t));a[u]&&(l.tiles.get(q).Dc=a[u].el,l.parseTileData(p,d,q))}m="";f(g.substring(k+n+1),"]|[")}}var g=this._formatTileIds(a,d)[0],h=new XMLHttpRequest,g="http://"+this.dataUrl+"/tiles?mapType\x3dnormal\x26v\x3d2\x26style\x3d5\x26t\x3d"+g+"\x26lv\x3d"+d,k=0,l=this,m="";h.sT="";var n=18<d?Math.pow(2,d-18):1;h.onreadystatechange=function(){3===h.readyState?h.wG||(f(h.responseText.substring(k)),k=h.responseText.length,h.hG=!0):4===h.readyState&&(h.startTime&&(e.jd.RA=new Date-h.startTime,e.jd.sM=h.responseText.length/2,l.K.aE("first"),h.hG||l.wl(a,d,n)),c=h.responseText.substring(k),f(c),h.sx=!0,l._map.fire("canvas"))};h.open("GET",g,!0);h.send()},parseTileData:function(a,d,f){var e=a[0].split("-"),h=e[3];e.splice(0,3).join("/");f=this.tiles.get(f);this.aE(a,f,d,h)},aE:function(a,d,f,e){if("first"===a)this.Wm[4].push(["co",6,b]);else if(d.Ab&&d.pb)d.pb.Ab||(d.pb.Dc=d.Dc,d.pb.X=d.pb.gg=d.pb.Ab=!0);else{d.Ua||(d.Ua=[]);d.typeDatas||(d.typeDatas={},d.hc=f,d.xyzObject.L1=this.L1);var g;switch(e){case "region":g=0;break;case "road":g=1;break;case "building":g=2;break;case "roadlabel":g=3;break;case "poilabel":g=4}(0===g||4===g||1!==a.length)&&(this.Wm[g].ov(["co",g,d]),this.dataProcesObjectArray[g].show&&this.Wm[g].ov([a.slice(1),g,d]),this.Zh>g&&(this.Zh=g));3===g&&(this.Wm[3].ov(["co",5,d]),2<this.Zh&&(this.Zh=2));this.FD()}},FD:function(){this.IC||(this.IC=e.g.yg(function(){var a=new Date,d;do if(d=this.parse(),new Date-a>=this.zE)break;while(!d);this.IC=null;d||this.FD();this.yd()},this))},parse:function(){var a,d=!1,f=this.Zh,g=this.Wm[this.Zh];if(!g.Ik()){if(a=g.WN(),!a)return d;if(6===a[1]){if(!this.Ab){var h=this;this.Ab=!0;e.g.yg(function(){h.SA||(e.jd.SA=new Date-e.jd.TA,e.jd.Fs=new Date-e.jd.xB);h.ia("complete")})}}else{var k,l=a[2],m=l.hc,n=l.key+(18<m?":"+m:"");if(!this.tiles.ac(n))return d;if("co"===a[0])if(0===a[1])this.Cu(l),l.typeDatas.region&&"v4"!==this.xQ||(m=this.La.tb.getContext("2d"),m.fillStyle=this.yF,m.fillRect(0,0,l.Dc.width,l.Dc.height)),l.typeDatas.region&&(this.La.dD(l.typeDatas.region,0,l.xyzObject.z),l.typeDatas.region=null),l.X=!0,l.pb&&(l.pb.X=!0);else if(2===a[1]&&l.typeDatas&&l.typeDatas.building)this.Cu(l),this.La.dD(l.typeDatas.building,1,l.xyzObject.z,void 0,v),l.typeDatas.building=null;else if(1===a[1])this.Cu(l),l.typeDatas.road&&(this.La.oP(l.typeDatas.road,l.xyzObject.z),l.typeDatas.road=null),l.gg=!0,l.pb&&(l.pb.gg=!0);else if(4===a[1]){if(18<m){a=l.xyzObject;k=Math.pow(2,m-18);for(var p=0;k>p;p+=1)for(var t=0;k>t;t+=1){var r=this.tiles.get(m+":"+(k*a.x+p)+":"+(k*a.y+t));r&&(r.Ab=!0,r.eC=!0)}this.tiles.cl(n)}else l.Ab=!0,l.eC=!0;l.gg=!0;l.pb&&(l.pb.Ab=!0,l.pb.eC=!0,l.pb.gg=!0)}else{if(5===a[1])if(l.typeDatas=null,l.X=!0,18<m)for(a=l.xyzObject,n=this.yb,k=Math.pow(2,m-18),p=0;k>p;p+=1)for(t=0;k>t;t+=1)(r=this.tiles.get(m+":"+(k*a.x+p)+":"+(k*a.y+t)))&&!r.X&&(r.Dc=this.GL(),r.Dc.width=r.Dc.height=n,r.Dc.getContext("2d").drawImage(l.Dc,-p*n,-t*n),r.status="loaded",r.gg=!0,r.Ab=!0,r.X=!0,this.en&&0===(r.xyzObject.x+r.xyzObject.y)%2&&r.Dc.getContext("2d").drawImage(this.en,0,0));else this.en&&0===(l.xyzObject.x+l.xyzObject.y)%2&&l.Dc.getContext("2d").drawImage(this.en,0,0)}else m=this.dataProcesObjectArray[a[1]],m.dataProcesObject.map=this.w,k=m.dataProcesObject.getParsedDatas(l,a[0],m),3!==a[1]&&4!==a[1]&&(l.typeDatas[m.type]=k)}g.Ik()&&(1===f&&2===f||!1)}return g.Ik()&&(4===f&&(d=!0),this.Zh=(this.Zh+1)%5),d},Cu:function(a){var d=18<a.hc?Math.pow(2,18-a.hc):1;a.Dc||(a.Dc=q.createElement("canvas"),a.Dc.width=a.Dc.height=this.yb/d,a.gg=!1);this.La.tb=a.Dc;this.La.nb=d},setContainer:function(a,d,f,g,h,k,l){this.Ca=this.Ca||a;this.Ti=this.Ti||d;this._La=this._La||new e.P.canvas.pf.Buildings(this.Ti);this._La.__isExtract=!0;this.K={sa:this.S.sa,lf:!1,hf:2};this.zoom=f;this.L1=e.Pe.xE.If(f);this.center={G:l,B:k,lng:k,lat:l};this.rotation=0;this.centerCoords=e.Pe.xE.hp(this.center,f).multiplyBy(this.L1);this.size={width:g.x,height:g.y};this._tiles=h||this._tiles;this._La.__loadedImg__=this._La.__loadedImg__||{}},updateCenter:function(a,d,f){this.zoom=f;this.center={G:d,B:a,lng:a,lat:d};this.L1=e.Pe.xE.If(f);this.centerCoords=e.Pe.xE.hp(this.center,f).multiplyBy(this.L1)},updateTiles:function(a){this._tiles=a},updateSize:function(a){this.size={width:a.x,height:a.y}},Bp:function(a){var d=this.Ti,f=this._La;f.lf=this.lf;var g=this.K.sa?this.K.hf:1;0!==a.va.rotation?e.d.Rm(d,2*Math.floor(a.Ea.mb.x)*g,2*Math.floor(a.Ea.mb.y)*g,!0):e.d.Rm(d,a.size.width*g,a.size.height*g,!0);f.Eb=[a.Ea.kb.x,a.Ea.kb.y];this._La.nb=this.L1*(this.K.sa?1/this.K.hf:1);var h,k,l;for(l in this._tiles)if(h=l.split(":"),k=this.tiles.get(h[2]+":"+h[0]+":"+h[1]),k&&(this.Hg={ak:[k]},(d=this.Hg.ak)&&d.length&&!(.5<d[0].xyzObject.z-this.zoom)))for(f=d.length-1;0<=f;--f)g=d[f].Ua,!g&&d[f].pb&&d[f].pb.Ua&&(g=d[f].pb.Ua),this._La.Bp(g||{})},yd:function(){this.cn=!1;var a={};a.size=this.size;a.SK=15E5<a.size.width*a.size.height;a.va=this.ZM();a.qc=!1;a.lf=!1;a.iu=!1;a.Up=!1;a.kv=!1;this.Ym=a.Ym=!1;a.dC=!0;a.Ea=this.getCoordsBound();a.Oz=this.Oz=!0;a.sa=!1;a.scale=Math.pow(2,a.va.zoom-a.va.xb);this.Bp(a)},ZM:function(){return{zoom:this.zoom,Th:this.center,fb:this.centerCoords,rotation:this.rotation,xb:this.zoom,nb:this.L1}},getCoordsBound:function(){var a=this.size,d=this.centerCoords,f=this.rotation,g=this.L1,f=Math.PI*f/180,a=new e.Pixel((Math.abs(a.width*Math.cos(f))+Math.abs(a.height*Math.sin(f)))/2,(Math.abs(a.width*Math.sin(f))+Math.abs(a.height*Math.cos(f)))/2),g=new e.PixelBounds(d.subtract(a.multiplyBy(g)),d.add(a.multiplyBy(g)));return g.mb=a,g}};e.Ad=e.Class.extend({initialize:function(a,d){this.Ki=0|a;this.Eq=!!d;this.count=0;this.eO=ca();this.clear()},Ik:function(){return!this.count},PS:function(){return this.count>=this.Ki},HT:function(a){this.Ki!==a&&(this.Ki=0|a)&&this.uz(this.Ki)},get:function(a,d){var f=this.$w(a);return f?f.value:d},set:function(a,d){var f=this.$w(a);f?f.value=d:(f=new e.Ad.ui(a,d),this.w[a]=f,this.wx(f),this.count+=1)},remove:function(a){return Object.prototype.hasOwnProperty.call(this.w,a)?(this.Ql(this.w[a]),!0):!1},forEach:function(a,d){for(var f=this.hb.next;f!==this.hb;f=f.next)a.call(d,f.value,f.key,this)},Qk:function(a,d){return Object.prototype.hasOwnProperty.call(this.w,a)?this.w[a].value:d},pT:function(){return this.hb.next.value},qT:function(){return this.hb.ya.value},shift:function(){return this.Ly(this.hb.next)},push:function(a){a=new e.Ad.ui("",a);0===this.count?(this.hb.ya=null,a.ya=this.hb,this.hb.next=a):(this.no.next=a,a.ya=this.no);this.count+=1;this.no=a},ov:function(a){a=new e.Ad.ui("",a);0===this.count?(this.hb.ya=null,a.ya=this.hb,this.no=this.hb.next=a):(this.hb.next.ya=a,a.next=this.hb.next,a.ya=this.hb,this.hb.next=a);this.count+=1},WN:function(){if(this.count){--this.count;var a=this.hb.next;return a.next?(a.next.ya=this.hb,this.hb.next=a.next):(this.hb.next=null,this.no=this.hb.ya=null),a.next=null,a.ya=null,a.value}return null},pop:function(){return this.Ly(this.hb.ya)},$w:function(a){return Object.prototype.hasOwnProperty.call(this.w,a)?(a=this.w[a],this.Eq&&(a.remove(),this.wx(a)),a):void 0},wx:function(a){this.Eq?(a.next=this.hb.next,a.ya=this.hb,this.hb.next=a,a.next.ya=a):(a.ya=this.hb.ya,a.next=this.hb,this.hb.ya=a,a.ya.next=a);this.Ki&&this.uz(this.Ki)},uz:function(a){for(var d=this.count;d>a;--d){var f=this.Eq?this.hb.ya:this.hb.next;this.Ql(f);this.eO(f.value)}},Ql:function(a){a.remove();delete this.w[a.key];--this.count},Ly:function(a){return this.hb!==a&&this.Ql(a),a.value},clear:function(){this.w={};this.hb=new e.Ad.ui("",null);this.hb.ya=this.hb.next=this.hb;this.count=0}});e.Ad.ui=function(a,d){this.key=a;this.value=d};e.Ad.ui.prototype.ya=null;e.Ad.ui.prototype.next=null;e.Ad.ui.prototype.remove=function(){this.ya.next=this.next;this.next.ya=this.ya;this.next=this.ya=null};e.Ov=e.Class.extend({include:[e.oa],initialize:function(a){this.options=e.extend({size:120,Zu:.7,qt:2,Yu:300},a);this.de={};this.Fg=0;this.xq=this.options.size},oF:function(a){return{el:a,Js:e.g.mj(),wo:0}},get:function(a,d){if(!this.ac(a))return d;var f=this.de[a];return f.Js=e.g.mj(),f.wo+=1,f.el},forEach:function(a,d){for(var f in this.de)if(this.de.hasOwnProperty(f)&&!1===a.call(d,this.de[f].el,f))break},Qk:function(a,d){return this.get(a,d)},set:function(a,d){this.ac(a)?this.de[a].el=d:(this.Fg+=1,this.de[a]=this.oF(d));this.Fg>this.xq&&this.pF()},ac:function(a){return this.de.hasOwnProperty(a)},cl:function(a){if(!this.ac(a))return null;--this.Fg;var d=this.de[a];return delete this.de[a],d.el},clear:function(){this.sq();this.de={};this.Fg=0},sq:function(){this.yq&&clearTimeout(this.yq)},pF:function(){if(this.Fg>this.xq*this.options.qt)this.sq(),this.mw();else if(!(10>e.g.mj()-this.qF)){this.sq();var a=this;this.yq=setTimeout(function(){a.yq=null;a.mw()},this.options.Yu);this.qF=e.g.mj()}},mw:function(){var a=Math.round(this.xq*this.options.Zu);if(!(this.Fg<a))for(var d,f,a=this.kF(this.Fg-a),g=0,h=a.length;h>g;g+=1)d=a[g],f=this.cl(d),this.q?this.q("drop",{key:d,el:f}):e.oa.q("drop",{key:d,el:f})},gF:function(a,d){var f=this.de[a],e=this.de[d],h=f.Js-e.Js;return 0!==h?h:f.wo-e.wo},kF:function(a){var d,f=[];for(d in this.de)this.de.hasOwnProperty(d)&&f.push(d);return this.lF(f,a,this.gF)},lF:function(a,d,f){if(0>=d)return[];for(var e,h,k,l=0,m=a.length-1;m>l;){e=l;h=m;for(k=a[d];d>=e&&h>=d;){for(;d>=e&&0>f.call(this,a[e],k);)e+=1;for(;h>=d&&0<f.call(this,a[h],k);)--h;var n=a[e];a[e]=a[h];a[h]=n;e+=1;--h}d>h&&(l=e);e>d&&(m=h)}return a.slice(0,d)}});e.ze=e.Class.extend({r:function(a){this.XB="undefined"!=typeof a?a:6;this.op=Math.floor(this.XB/2);this.Dp={j:[1/0,1/0,-(1/0),-(1/0)],qa:[]};this.count=0},mL:function(a,d){var f,g=-1,h=[];h.push(d);var k=d.qa;do{-1!==g&&(h.push(k[g]),k=k[g].qa,g=-1);for(var l=k.length-1;0<=l;--l){var m=k[l];if("undefined"!=typeof m.pj){g=-1;break}var n=e.ze.Zk(m.j[2]-m.j[0],m.j[3]-m.j[1],m.qa.length+1),m=e.ze.Zk((m.j[2]>a.j[2]?m.j[2]:a.j[2])-(m.j[0]<a.j[0]?m.j[0]:a.j[0]),(m.j[3]>a.j[3]?m.j[3]:a.j[3])-(m.j[1]<a.j[1]?m.j[1]:a.j[1]),m.qa.length+2);(0>g||Math.abs(m-n)<f)&&(f=Math.abs(m-n),g=l)}}while(-1!==g);return h},bp:function(a,d,f){a={j:a,pj:d};"undefined"!=typeof f&&(a.type=f);this.yB(a,this.Dp);this.count+=1},yB:function(a,d){var f;if(0===d.qa.length)d.j=e.j.qb(a.j),d.qa.push(a);else{var g=this.mL(a,d),h=a;do{if(f&&"undefined"!=typeof f.qa&&0===f.qa.length){var k=f;f=g.pop();for(var l=0,m=f.qa.length;m>l;l+=1)if(f.qa[l]===k||0===f.qa[l].qa.length){f.qa.splice(l,1);break}}else f=g.pop();if(k=h instanceof Array,"undefined"!=typeof h.pj||"undefined"!=typeof h.qa||k){if(k){k=0;for(l=h.length;l>k;k+=1)e.j.extend(f.j,h[k].j);f.qa=f.qa.concat(h)}else e.j.extend(f.j,h.j),f.qa.push(h);f.qa.length<=this.XB?h={j:e.j.qb(f.j)}:(h=k=this.CN(f.qa),1>g.length&&(f.qa.push(k[0]),g.push(f),h=k[1]))}else e.j.extend(f.j,h.j),h={j:e.j.qb(f.j)}}while(0<g.length)}},CN:function(a){for(var d=this.GO(a);0<a.length;)this.HO(a,d[0],d[1]);return d},GO:function(a){for(var d=a.length-1,f=0,g=a.length-1,h=0,k=a.length-2;0<=k;--k){var l=a[k];l.j[0]>a[f].j[0]?f=k:l.j[2]<a[d].j[1]&&(d=k);l.j[1]>a[h].j[1]?h=k:l.j[3]<a[g].j[3]&&(g=k)}return Math.abs(a[d].j[2]-a[f].j[0])>Math.abs(a[g].j[3]-a[h].j[1])?d>f?(d=a.splice(d,1)[0],f=a.splice(f,1)[0]):(f=a.splice(f,1)[0],d=a.splice(d,1)[0]):g>h?(d=a.splice(g,1)[0],f=a.splice(h,1)[0]):(f=a.splice(h,1)[0],d=a.splice(g,1)[0]),[{j:e.j.qb(d.j),qa:[d]},{j:e.j.qb(f.j),qa:[f]}]},HO:function(a,d,f){for(var g,h,k,l=e.ze.Zk(d.j[2]-d.j[0],d.j[3]-d.j[1],d.qa.length+1),m=e.ze.Zk(f.j[2]-f.j[0],f.j[3]-f.j[1],f.qa.length+1),n=a.length-1;0<=n;--n){var p=a[n],t=[d.j[0]<p.j[0]?d.j[0]:p.j[0],d.j[2]>p.j[2]?d.j[2]:p.j[2],d.j[1]<p.j[1]?d.j[1]:p.j[1],d.j[3]>p.j[3]?d.j[3]:p.j[3]],t=Math.abs(e.ze.Zk(t[1]-t[0],t[3]-t[2],d.qa.length+2)-l),p=[f.j[0]<p.j[0]?f.j[0]:p.j[0],f.j[2]>p.j[2]?f.j[2]:p.j[2],f.j[1]<p.j[1]?f.j[1]:p.j[1],f.j[3]>p.j[3]?f.j[3]:p.j[3]],p=Math.abs(e.ze.Zk(p[1]-p[0],p[3]-p[2],f.qa.length+2)-m),r=Math.abs(p-t);(!h||!g||g>r)&&(h=n,g=r,k=t>p?f:d)}l=a.splice(h,1)[0];d.qa.length+a.length+1<=this.op?(d.qa.push(l),e.j.extend(d.j,l.j)):f.qa.length+a.length+1<=this.op?(f.qa.push(l),e.j.extend(f.j,l.j)):(k.qa.push(l),e.j.extend(k.j,l.j))},remove:function(a,d){var f=[];if(f[0]={j:a},(f[1]=d)||(f[1]=!1),f[2]=this.Dp,--this.count,!1===f[1]){var e,h=[];do e=h.length,h=h.concat(this.$C.apply(this,f));while(e!==h.length);return h}return this.$C.apply(this,f)},$C:function(a,d,f){var g=[],h=[],k=[];if(!a||!e.j.intersects(a.j,f.j))return k;a=e.j.qb(a.j);var l;h.push(f.qa.length);g.push(f);do{f=g.pop();var m=h.pop()-1;if("undefined"!=typeof d)for(;0<=m;){var n=f.qa[m];if(e.j.intersects(a,n.j)){if(d&&"undefined"!=typeof n.pj&&n.pj===d||!d&&("undefined"!=typeof n.pj||e.j.oA(a,n.j))){"undefined"!=typeof n.qa?(k=this.Yk(n,!0,[],n),f.qa.splice(m,1)):k=f.qa.splice(m,1);e.ze.Hu(f);d=void 0;f.qa.length<this.op&&(l=this.Yk(f,!0,[],f));break}"undefined"!=typeof n.qa&&(h.push(m),g.push(f),f=n,m=n.qa.length)}--m}else if("undefined"!=typeof l){f.qa.splice(m+1,1);0<f.qa.length&&e.ze.Hu(f);m=0;for(n=l.length;n>m;m+=1)this.yB(l[m],f);l.length=0;0===g.length&&1>=f.qa.length?(l=this.Yk(f,!0,l,f),f.qa.length=0,g.push(f),h.push(1)):0<g.length&&f.qa.length<this.op?(l=this.Yk(f,!0,l,f),f.qa.length=0):l=void 0}else e.ze.Hu(f)}while(0<g.length);return k},search:function(a,d){return this.Yk({j:a},!1,[],this.Dp,d)},zP:function(a,d){return this.Yk({j:a},!1,[],this.Dp,d,!0)},Yk:function(a,d,f,g,h,k){var l={},m=[];if(!e.j.intersects(a.j,g.j))return f;m.push(g.qa);do{g=m.pop();for(var n=g.length-1;0<=n;--n){var p=g[n];e.j.intersects(a.j,p.j)&&("undefined"!=typeof p.qa?m.push(p.qa):"undefined"!=typeof p.pj&&(d?f.push(p):("undefined"==typeof h||p.type===h)&&(p=p.pj,"undefined"!=typeof k?l[e.g.Vb(p)]=p:f.push(p))))}}while(0<m.length);return"undefined"!=typeof k?l:f}});e.ze.Hu=function(a){var d=a.qa.length,f=a.j;if(0===d)e.j.empty(f);else{var g=a.qa[0].j;f[0]=g[0];f[2]=g[2];f[1]=g[1];f[3]=g[3];for(g=1;d>g;g+=1)e.j.extend(f,a.qa[g].j)}};e.ze.Zk=function(a,d,f){var e=(a+d)/2;return a*=d,a*f/(a/(e*e))};e.ra=e.ra||{};e.ra.Ah=e.Class.extend({jb:[e.oa,e.Kc],sO:["position","visible","clickable","bubble"],r:function(a,d){this.map=d;this.cd(this.sO,a);this.J("zIndex",a);this.J("draggable",a);e.h.uc||e.h.Y?this.IF():this.Jq();this.zc=a;this.zc.ra=this},draggableChanged:function(){this.get("draggable")?this.Iq():this.Sr()},ia:function(a,d){var f;f=d?{type:a,pixel:d.sb,target:this.zc,lnglat:d.qg}:{type:a};this.zc&&this.zc.q(a,f)},$a:function(a){("click"!==a.type&&"rightclick"!==a.type&&"dblclick"!==a.type||this.get("clickable"))&&this.ia(a.type,a)},Hq:function(){this.e("click",this.$a);this.e("rightclick",this.$a);this.e("dblclick",this.$a)},vz:function(){this.D("click",this.$a);this.D("rightclick",this.$a);this.D("dblclick",this.$a)},Jq:function(){this.get("clickable")&&this.Hq();this.e("mousemove",this.$a);this.e("mouseout",this.$a);this.e("mouseover",this.$a);this.e("mousedown",this.$a);this.e("mouseup",this.$a)},zR:function(){this.vz();this.D("mousemove",this.$a);this.D("mouseout",this.$a);this.D("mouseover",this.$a);this.D("mousedown",this.$a);this.D("mouseup",this.$a)},clickableChanged:function(){this.get("clickable")?this.Hq():this.vz()},IF:function(){this.get("clickable")&&this.Hq();this.e("touchstart",this.$a,this);this.e("touchmove",this.$a,this);this.e("touchend",this.$a,this)},Iq:function(){this.e("dragstart",this.Ni);this.e("dragging",this.Li);this.e("dragend",this.Mi)},Ni:function(a){this.re=a.sb;this.ia("dragstart",a)},Li:function(a){var d=a.sb.subtract(this.re),f=d.x,d=d.y;this.re=a.sb;var g=this.map.get("rotation")*Math.PI/180;this.lh(new e.Pixel(f*Math.cos(g)+Math.sin(g)*d,-Math.sin(g)*f+Math.cos(g)*d));this.ia("dragging",a)},Mi:function(a){this.ia("dragend",a)},Sr:function(){this.D("dragstart",this.Ni);this.D("dragging",this.Li);this.D("dragend",this.Mi)},fx:function(a){var d,f,e=[];d=0;for(f=a.length;f>d;d+=1)e.push(this.lr(a[d]));return e},lr:function(a){return a=this.map.wb(a),[a.x,a.y]},Gb:function(a){var d=this.A.Aa||this.map.get("centerCoords"),f=this.map.get("crs").If(Math.floor(this.map.get("zoom")));return[(a[0]-d.x)/f,(a[1]-d.y)/f]}});e.ra.Wc=e.ra.Ah.extend({uu:"content icon opacity angle autoRotation offset shadow title label isTop shape topWhenClick topWhenMouseOver".split(" "),r:function(a,d){arguments.callee.Sa.apply(this,arguments);this.cd(this.uu,a);this.J("move",a);this.ZK();this.Wi();this.set("AnimationOffset",new e.Pixel(0,0));this.J("raiseOnDrag",a);this.GK={AMAP_ANIMATION_NONE:!1,AMAP_ANIMATION_DROP:e.Bg.Easing.Bounce,AMAP_ANIMATION_BOUNCE:e.Bg.Easing.Cubic};this.J("animation",a)},vr:function(a,d,f){if(this.get("animation")&&"AMAP_ANIMATION_NONE"!==this.get("animation")){var g=this;this.Mf=new e.Bg;this.Mf.transition=function(f,e,l){return a&&600<=l?(g.Mf.stop(),0):(f=0===Math.floor(l/600)%2?"Out":"In","out"===d?f="Out":"in"===d&&(f="In"),g.GK[g.get("animation")][f](l%600/600))};f=f||40;this.Mf.Im=function(a){g.set("AnimationOffset",g.Ur.add(new e.Pixel(0,-1*f*a)))};this.Ur=new e.Pixel(0,0);this.Mf.Ej()}},AnimationOffsetChanged:function(){this.positionChanged()},Sy:function(){if(this.Mf&&(this.Mf.stop(),this.set("AnimationOffset",this.Ur)),this.set("AnimationOffset",new e.Pixel(0,-40)),this.hl)this.hl.set("position",this.get("position"));else{var a=new M({zIndex:this.get("zIndex")-1,icon:new U({image:e.k.Va+"/theme/v1.3/dragCross.png",size:new e.Size(14,11)}),offset:new e.Pixel(-4,-5),position:this.get("position")});a.da=!0;this.hl=a}this.hl.setMap(this.map.Fb)},Uw:function(){this.set("animation","AMAP_ANIMATION_DROP",!0);this.vr(!0,"in");this.hl.setMap(null)},animationChanged:function(){this.Mf&&(this.Mf.stop(),this.set("AnimationOffset",this.Ur),this.Mf=null);var a=this.get("animation");a&&"AMAP_ANIMATION_NONE"!==a&&("AMAP_ANIMATION_DROP"===a?this.vr(!0,"in",100):this.vr())},Vf:function(){this.hl&&this.hl.set("position",this.get("position"))},raiseOnDragChanged:function(){this.get("raiseOnDrag")?(this.e("dragstart",this.Sy,this),this.e("dragging",this.Vf,this),this.e("dragend",this.Uw,this)):(this.D("dragstart",this.Sy,this),this.D("dragging",this.Vf,this),this.D("dragend",this.Uw,this))},lh:function(a){var d=this.get("position");a=this.map.wb(d).add(a.multiplyBy(this.map.get("resolution")));d instanceof e.LngLat?this.set("position",this.map.je(a)):this.set("position",a)},ZK:function(){var a=this.get("content"),d=this.get("shadow"),f=this.get("offset"),e=this.get("label"),a=a?this.Uz(a,f):this.Rs(this.get("icon"),f);this.set("contentDom",a);d&&(d=this.Wz(d,f),this.set("shadowDom",d));e&&e.content&&this.set("labelDom",this.Vz(e.content))},Vz:function(a){var d=q.createElement("div");return d.className="amap-marker-label",d.innerHTML=a,d},Wi:function(){if(this.map&&this.get("position")&&!this.A){var a=this.map,d=this.map.wb(this.get("position")),a=this.A=new e.kd({name:"marker-"+e.g.Vb(this),map:a,ja:new e.W.Bd([d.x,d.y])});a.Mh=this;this.J("coords",a,!0);a.J("offset",this,!0);a.J("isTop",this,!0);a.J("zIndex",this,!0);a.J("params",this,!0)}},getParams:function(){return{zIndex:this.get("zIndex"),Kz:this.get("angle"),Xh:this.get("contentDom"),yN:this.get("labelDom"),QP:this.get("shadowDom"),opacity:this.get("opacity"),title:this.get("title"),label:this.get("label"),Bv:this.get("AnimationOffset"),offset:this.get("offset"),vN:this.get("isTop"),shape:this.get("shape"),visible:this.get("visible")}},offsetChanged:function(){if(this.A&&this.A.O){var a=this.map.wb(this.get("position")).subtract(this.A.ba).divideBy(this.map.get("resolution"));this.A.O&&(this.A.O.style.left=Math.floor(a.x)+this.get("offset").x+this.get("AnimationOffset").x+"px",this.A.O.style.top=Math.floor(a.y)+this.get("offset").y+this.get("AnimationOffset").y+"px")}},positionChanged:function(){if(this.A){var a=this.map.wb(this.get("position"));this.set("coords",[a.x,a.y]);this.A.O&&this.A.O.Zr&&(a=a.subtract(this.A.NB.ba).divideBy(this.map.get("resolution")),this.A.O.style.left=Math.floor(a.x)+this.get("offset").x+this.get("AnimationOffset").x+"px",this.A.O.style.top=Math.floor(a.y)+this.get("offset").y+this.get("AnimationOffset").y+"px",this.A.O.parentNode!==this.A.O.Zr&&this.A.O.Zr.appendChild(this.A.O))}},contentChanged:function(){if(this.A){this.map.Tb.um=!0;this.map.Tb.Nk.push(this.A);this.A.O&&this.A.O.removeChild(this.get("contentDom"));var a=this.get("content"),d=this.get("offset"),a=this.Uz(a,d);this.set("contentDom",a);this.A.O&&(e.h.td&&e.g.iepngFix(a),this.A.O.appendChild(a),this.A.Xh=a)}},iconChanged:function(){if(this.A&&this.A.O&&!this.get("content")){this.map.Tb.um=!0;this.map.Tb.Nk.push(this.A);this.A.O&&this.get("contentDom")&&this.A.O.removeChild(this.get("contentDom"));var a=this.get("icon"),d=this.get("offset"),a=this.Rs(a,d);this.set("contentDom",a);this.A.O&&(e.h.td&&e.g.iepngFix(a),this.A.O.appendChild(a),this.A.Xh=a)}},shadowChanged:function(){if(this.A&&this.A.O){var a=this.get("shadowDom");if(this.A.O&&a&&a.parentNode===this.A.O&&this.A.O.removeChild(a),a=this.get("shadow")){var d=this.get("offset"),a=this.Wz(a,d);this.set("shadowDom",a);this.A.O&&this.A.O.appendChild(a)}}},titleChanged:function(){this.A&&this.A.Xh&&"string"==typeof this.get("title")&&this.A.Xh&&this.get("title")&&(this.A.Xh.title=this.get("title"))},labelChanged:function(){if(this.A&&this.A.O){var a=this.get("label"),d=this.A.O;if(d&&a&&a.hasOwnProperty("content")){this.get("labelDom")&&d.removeChild(this.get("labelDom"));var f="";if(a.content){var f=this.Vz(a.content),e=0,h=0;a.offset&&(e=a.offset.y+"px",h=a.offset.x+"px");f.style.top=e;f.style.left=h;d.appendChild(f)}this.set("labelDom",f)}}},isTopChanged:function(){var a=this.map.Tb.Tp,d=this.get("isTop"),f=this.get("zIndex");a?a===this?this.A&&this.A.O&&(this.A.O.style.zIndex=d?this.map.Tb.Kj+10:f,this.map.Tb.Tp=d?this:null):(a.A&&a.A.O&&(a.A.O.style.zIndex=d?a.get("zIndex"):this.map.Tb.Kj+10),this.A&&this.A.O&&(this.A.O.style.zIndex=d?this.map.Tb.Kj+10:f),this.map.Tb.Tp=d?this:a):(this.map.Tb.Tp=this,this.A&&this.A.O&&(this.A.O.style.zIndex=d?this.map.Tb.Kj+10:f))},visibleChanged:function(){this.A&&this.A.O&&(this.get("visible")?this.A.O.style.display="block":this.A.O.style.display="none")},angleChanged:function(){if(this.A&&this.A.O){var a={x:-1*this.get("offset").x,y:-1*this.get("offset").y};e.d.rotate(this.A.O,this.get("angle")||0,a)}},zIndexChanged:function(){var a=this.get("zIndex");if(a>this.map.Tb.Kj){this.map.Tb.Kj=a;var d=this.map.Tb.Tp;d&&d.A&&d.A.O&&(d.A.O.style.zIndex=a+10)}this.A&&this.A.O&&(this.A.O.style.zIndex=this.get("isTop")?this.map.Tb.Kj+10:this.get("zIndex"))},opacityChanged:function(){var a=this.get("contentDom"),d=this.get("shadowDom");a&&e.d.mi(a,this.get("opacity"));d&&e.d.mi(d,this.get("opacity"))},Uz:function(a){var d;return d=q.createElement("div"),d.className="amap-marker-content","string"!=typeof a?d.appendChild(a):(d.innerHTML=a,d.childNodes[0]&&!d.childNodes[0].style&&(d.style["white-space"]="pre")),e.d.mi(d,this.get("opacity")),d},Rs:function(a){var d,f,g,h,k,l=0,m=0;return a?("string"==typeof a?(d=a,k=!0):(d=a.get("image"),m=a.get("size"),f=a.get("imageSize"),l=m.width,m=m.height,f&&(g=f.width,h=f.height)),l||(l=0),m||(m=0),a="string"!=typeof a?a.get("imageOffset"):{x:0,y:0}):(d=e.k.ih+"/mark_bs.png",a={x:0,y:0},l=19,m=33,g=19,h=33),f=q.createElement("div"),f.className="amap-icon",f.style.position="absolute",k&&!e.h.Oc&&(f.style.overflow="inherit"),l&&(f.style.width=l+"px"),m&&(f.style.height=m+"px"),l=q.createElement("img"),l.src=d,g&&h&&(l.style.width=g+"px",l.style.height=h+"px"),l.style.top=a.y+"px",l.style.left=a.x+"px",e.h.Oc&&k||f.appendChild(l),e.d.mi(e.h.Oc&&k?l:f,this.get("opacity")),e.h.Oc&&k?l:f},Wz:function(a,d){var f=this.Rs(a,d);return f.style.zIndex=-1,f},moveChanged:function(){var a=this.get("move");return!1===a?this.ZP():void(void 0!==a&&("[object Array]"===Object.prototype.toString.call(a.qg)?this.SN(a.qg,a.speed,a.xa,a.nL):this.moveTo(a.qg,a.speed,a.xa)))},moveTo:function(a,d,f){var g=this.get("position");a.subtract(g);var h=Math.round(a.distance(g)/1E3/d*36E5);return 0===h?this.q("moveend"):(this.df&&(this.df.stop(),this.df=null),this.df=new e.Bg(g,a),f=f||function(a){return a},this.df.transition=function(a,d,g){if(g>=h)return d;var n=(d.B-a.B)*f(g/h)+a.B;return a=(d.G-a.G)*f(g/h)+a.G,new e.LngLat(n,a)},this.df.Im=function(d){this.set("position",d);d.equals(a)?(this.df&&(this.df.stop(),this.df=null),this.zc.q("moveend"),this.q("moveend")):this.zc.q("moving")},this.get("autoRotation")&&!e.h.Oc&&(d=this.PG(g,a),this.set("angle",d)),void this.df.Ej(this))},ZP:function(){this.df&&(this.df.stop(),this.df=null,this.q("movestop"))},SN:function(a,d,f,e){function g(){k+=1;k<a.length?this.moveTo(a[k],d,f):(this.ia("movealong"),e?(k=1,this.set("position",a[0]),this.moveTo(a[1],d,f)):this.D("moveend",g,this))}var k=0;this.set("position",a[0]);this.e("moveend",g,this);this.e("movestop",function(){this.D("moveend",g,this)},this);this.moveTo(a[0],d,f)},PG:function(a,d){var f=this.map,g=f.wb(a),f=f.wb(d),h=0;f.distance(g);var k=f.y-g.y,l=f.x-g.x;return 0!==f.x-g.x?(h=Math.atan((f.y-g.y)/(f.x-g.x)),0<=k&&0>l?h=Math.PI+h:0>k&&0>=l?h=Math.PI+h:0>k&&0<=l&&(h=2*Math.PI+h)):h=f.y>g.y?Math.PI/2:3*Math.PI/2,e.g.Ff(180*h/Math.PI,1)}});e.ra.cq=e.ra.Ah.extend({r:function(a,d){arguments.callee.Sa.apply(this,arguments);this.J("items",a,!0);this.J("content",a,!0);this.J("resolution",d);this.J("centerCoords",d);this.bm=a},lC:function(){this.setContainer();this.dl();this.uh();this.map.e("movestart",this.uf,this);this.map.e("mapmove",this.uf,this);this.map.e("zoomstart",this.uf,this);this.map.e("click",this.uf,this);this.map.e("closeOverlays",this.uf,this);this.map.e("rotate",this.uf,this)},uf:function(){this.bm.map&&this.bm.close()},mapChanged:function(){},positionChanged:function(){this.uh()},setContainer:function(){this.u&&(this.u.parentNode&&this.u.parentNode.removeChild(this.u),this.u=null);var a=e.d.create("div",null,"amap-menu");e.l.e(a,"mousedown",function(a){e.l.stopPropagation(a)},this);this.u=a;this.map.Ra.ra.appendChild(this.u)},dl:function(){var a=this,d=this.u;d.innerHTML="";var f=this.get("content");if("object"==typeof f)d.appendChild(f);else if("string"==typeof f)d.innerHTML=f;else if((f=this.get("items"))&&f.length){var g=e.d.create("ul",d,"amap-menu-outer");f.sort(function(a,d){return isNaN(a.qp)||isNaN(d.qp)?0:a.qp-d.qp});for(d=0;d<f.length;d+=1)(function(d){var f=d.eE,h=d.xa,m=e.d.create("li",g);m.innerHTML=f;e.l.e(m,"click",function(){h.call(m);a.bm.close()},m)})(f[d])}else this.u.innerHTML=""},uh:function(){var a=this.map,d=this.u;if(a&&d){var f=a.wb(this.get("position")),e=this.get("centerCoords"),d=(f.x-e.x)/this.get("resolution"),f=(f.y-e.y)/this.get("resolution"),a=a.get("size"),f=f+a.height/2,d=d+a.width/2;this.u.style.right="";this.u.style.bottom="";this.u.style.left=d+"px";this.u.style.top=f+"px"}},ef:function(){this.u&&(this.map.D("click",this.Fw,this),this.map.Ra.ra.removeChild(this.u),this.bm.Cf=!1,this.u=this.bm.Ae.map=null,this.map.D("movestart",this.uf,this),this.map.D("zoomstart",this.uf,this),this.map.D("click",this.uf,this),this.map.D("closeOverlays",this.uf,this),this.map.D("rotate",this.uf,this))},visibleChanged:function(){this.u&&(this.get("visible")?this.u.style.display="block":this.u.style.display="none")},itemsChanged:function(){this.u&&this.dl()}});e.ra.yh=e.ra.Ah.extend({r:function(a,d){arguments.callee.Sa.apply(this,arguments);this.cd("content position contentU isCustom autoMove showShadow closeWhenClickMap size offset".split(" "),a);this.J("resolution",d);this.J("centerCoords",d);this.J("retainWhenClose",a,!0);this.J("display",d);a.J("toBeClose",this);this.map=d;this.Ug=a},lC:function(){this.zL?this.map.Ra.ra.appendChild(this.Ia):(this.setContainer(),this.dl(),this.uL());this.rv();this.uh();this.pw();this.zL=!0},setContainer:function(){var a=e.d.create("div");a.className="amap-info";var d=e.d.create("div",a),f=e.d.create("div",a),g=e.d.create("div",f);a.style.position="absolute";f.style.position="absolute";f.style.bottom=-1*(this.get("offset").y||0)+"px";f.style.left=(this.get("offset").x||0)+"px";d.style.position="absolute";d.style.bottom=-1*(this.get("offset").y||0)+"px";d.style.left=(this.get("offset").x||0)+"px";this.Ia=a;this.Rb=f;this.Sm=d;this.Td=g;this.map.Ra.ra.appendChild(this.Ia)},dl:function(){var a=this.get("contentU");if(a){var d=this.get("isCustom"),f=this.Td,g=this.Sm;f.innerHTML="";var h=null;if(d){if("string"==typeof a)f.innerHTML=a;else if(a instanceof Array)for(h=0;h<a.length;h+=1)f.appendChild(a[h]);else f.appendChild(a);h=f;g.parentNode&&g.parentNode.removeChild(g)}else h=g=e.d.create("div",f,"amap-info-content amap-info-outer"),"string"==typeof a?g.innerHTML=a:g.appendChild(a),this.AL=g,a=e.d.create("a",this.Td,"amap-info-close"),a.innerHTML="\\u00d7",this.Vs=a,a.href="javascript: void(0)",e.h.uc?(e.l.e(a,"touchstart",function(a){e.l.stop(a)},this),e.l.e(a,"touchend",function(a){e.l.stop(a);this.Ug.close()},this),e.l.e(a,"click",function(a){e.l.stop(a);this.Ug.close()},this)):(e.l.e(a,"mousedown",function(a){e.l.stop(a)},this),e.l.e(a,"click",function(a){e.l.stop(a);this.Ug.close()},this)),(a=this.get("size",!0))&&(0!==a.width&&(g.style.width=a.width+"px"),0!==a.height&&(g.style.height=a.height+"px")),a=e.d.create("div",f,"amap-info-sharp"),a.style.height="23px",(e.h.td||e.h.zm)&&(a.style.marginLeft=f.childNodes[0].offsetWidth/2-5),this.Sm.style.display="block";f=function(a){e.l.stopPropagation(a)};e.h.uc?(e.l.e(h,"touchstart",f,this),e.l.e(h,"touchmove",f,this),e.l.e(h,"touchend",f,this)):(e.l.e(h,"mousedown",f,this),e.l.e(h,"mouseup",f,this),e.l.e(h,"mousemove",f,this))}},rv:function(){var a=this.get("isCustom"),d=this.get("showShadow");if(!a&&d){var a=this.Sm,d=e.d.tm(this.Td),f=d.height-23,g=d.width;(e.h.td||e.h.zm)&&(f=this.Td.childNodes[0].offsetHeight,g=this.Td.childNodes[0].offsetWidth+26);d="background-image:url("+e.k.Va+(e.h.td?"/theme/v1.3/iws.gif);":"/theme/v1.3/iws.png);");a.innerHTML="";var h,k=[];h=k[1]={};h.height=.5*f+4;h.width=g;h.offsetX=400;h.offsetY=16;h.top=-h.height-10-15;h.left=23;h=k[2]={};h.height=k[1].height;h.width=k[1].height;h.offsetX=1075-h.width;h.offsetY=k[1].offsetY;h.top=k[1].top;h.left=23+k[1].width;h=k[3]={};h.height=10;h.width=22;h.offsetX=30;h.offsetY=445;h.top=-25;h.left=23+(e.h.zm||e.h.td?5:0);h=k[4]={};h.height=10;h.width=g/2-15-k[3].left-k[3].width;h.offsetX=132;h.offsetY=445;h.top=-25;h.left=k[3].left+k[3].width;h=k[5]={};h.height=10;h.width=70;h.offsetX=80;h.offsetY=445;h.top=-25;h.left=k[4].left+k[4].width;h=k[6]={};h.height=10;h.width=g-k[5].left-k[5].width;h.offsetX=132;h.offsetY=445;h.top=-25;h.left=k[5].left+k[5].width;h=k[7]={};h.height=10;h.width=30;h.offsetX=621;h.offsetY=445;h.top=-25;h.left=g;h=k[8]={};h.height=15;h.width=70;h.offsetX=47;h.offsetY=470;h.top=-15;h.left=g/2-15;for(f=1;8>=f;f+=1)g=e.d.create("div",a),h=[],h.push("position:absolute;"),h.push(d),h.push("top:"+k[f].top+"px;"),h.push("left:"+k[f].left+"px;"),h.push("width:"+k[f].width+"px;"),h.push("height:"+k[f].height+"px;"),h.push("background-position:"+-k[f].offsetX+"px "+-k[f].offsetY+"px;"),g.style.cssText=h.join("")}},WT:function(){},uh:function(){var a=this.map,d=this.Ia,f=this.get("position"),g=this.get("resolution");if(a&&d&&f){var f=a.wb(this.get("position")),h=this.get("centerCoords"),d=(f.x-h.x)/g,g=(f.y-h.y)/g,a=a.get("size"),f=e.d.tm(this.Td);if((e.h.td||e.h.zm)&&(f.width=this.Td.childNodes[0].offsetWidth+14),f=this.get("isCustom")?f.width/2:(f.width-30)/2,this.Ia.style.left=d+a.width/2-f+"px",this.Ia.style.top=g+a.height/2+"px",d=this.AL,this.Vs&&d.childNodes[0]){for(g=a=0;g<d.childNodes.length;g+=1)a+=d.childNodes[0].clientHeight||0;a>(this.get("size").height||d.clientHeight)?this.Vs.style.right="20px":this.Vs.style.right="5px"}}},gG:function(){var a=new e.Pixel(2-this.Td.offsetWidth/2,2-this.Td.offsetHeight),d=this.get("offset")||new e.Pixel(0,0);return this.get("isCustom")||(a=a.add(new e.Pixel(0,-23))),a.add(d)},pw:function(){if(this.get("position")&&this.get("autoMove")&&this.Td){var a=this.map,d=new e.Size(this.Td.offsetWidth,this.Td.offsetHeight);a.lnglatTocontainer(this.get("position"));for(var f=a.lnglatTocontainer(this.get("position")).add(this.gG()),g=f.add(d.$k()),h=a.get("size"),k=a.AM(),l=0,m=0,n=0;n<k.length;n+=1){var p=k[n],t=0,r=0;0===p[1]&&0===p[2]?(t=p[3]-(f.x+l),r=p[0]-(f.y+m),0<t&&0<r&&(Math.abs(t)<Math.abs(r)?l+=t:m+=r)):0===p[2]&&0===p[3]?(t=h.getWidth()-p[1]-(g.x+l),r=p[0]-(f.y+m),0>t&&0<r&&(Math.abs(t)<Math.abs(r)?l+=t:m+=r)):0===p[0]&&0===p[3]?(t=h.getWidth()-p[1]-(g.x+l),r=h.getHeight()-p[2]-(g.y+m),0>t&&0>r&&(Math.abs(t)<Math.abs(r)?l+=t:m+=r)):0===p[0]&&0===p[1]&&(t=p[3]-(f.x+l),r=h.getHeight()-p[2]-(g.y+m),0<t&&0>r&&(Math.abs(t)<Math.abs(r)?l+=t:m+=r))}f=f.add(new e.Pixel(l,m));g=g.add(new e.Pixel(l,m));n=k=0;0>f.x||d.getWidth()>h.getWidth()?k=20-f.x:h.getWidth()<g.x&&(k=h.getWidth()-g.x-25);0>f.y||d.getHeight()>h.getHeight()?n=5-f.y:h.getHeight()<g.y&&(n=h.getHeight()-g.y-15);k+=l;n+=m;(k||n)&&a.Fb.panBy(k,n)}},uL:function(){this.get("closeWhenClickMap")&&this.map.e("closeInfo",this.Fw,this,!1)},Fw:function(){this.Ug.Cf&&this.Ug.close()},ef:function(){this.Ia&&(this.get("retainWhenClose")?this.map.Yj.appendChild(this.Ia):this.Ia.parentNode===this.map.Ra.ra&&this.map.Ra.ra.removeChild(this.Ia),this.Ug.Cf=!1,this.Ug.Ae.map=null,this.Ug.map=null,this.zc.q("close",{type:"close",target:this.zc}))},mR:function(){if(!this.get("isCustom"))return this.Td.offsetWidth;for(var a=this.Ce,d=a.firstChild,f=a.lastChild;d&&f&&d.style&&f.style&&d===f;)a=d,d=a.firstChild,f=a.lastChild;return a=e.d.gc(a,"width"),parseInt(a.replace("px",""),10)},displayChanged:function(a){a?this.uh():e.g.yg(this.uh,this)},positionChanged:function(){this.map&&this.Ia&&(this.uh(),this.pw())},offsetChanged:function(){var a=this.get("offset");this.Rb.style.bottom=-1*(a.y||0)+"px";this.Rb.style.left=(a.x||0)+"px";this.Sm.style.bottom=-1*(a.y||0)+"px";this.Sm.style.left=(a.x||0)+"px"},contentChanged:function(){this.dl();this.rv();this.uh()},sizeChanged:function(){this.dl();this.rv();this.uh()}});e.W={};e.W.si=e.Class.extend({jb:[e.oa,e.Kc],r:function(){},qb:function(){return new this.r(this.Ta)},vt:function(){return this.Ta},setCoords:function(a){this.FP(a)},FP:function(a){if(this.vj=this.getBounds(),this.Mc=null,e.W.Xc&&this instanceof e.W.Xc){var d=a.length;this.ue=Array(d);for(var f,g,h=0;d>h;h+=1)if(f=a[h],g=new e.W.Qv(f),this.ue[h]=g,0===h){if(0===f.length)break;g.oj(f)||f.reverse()}else 0!==f.length&&g.oj(f)&&f.reverse()}else this.Ta=a}});e.W.VectorLayer=e.extend({},{Qj:"point",fq:"linestring",Nv:"linearring",un:"polygon",iq:"multipoint",hq:"multilinestring",rn:"multipolygon",RQ:"geometrycollection"});e.kd=e.Class.extend({jb:[e.oa,e.Kc],r:function(a){a=a||{};this.Qn=a.Qn;this.map=a.map;this.Uo=e.g.Vb(this);this.name=a.name||"";this.Ze=!1;this.set("visible",!0,!0);this.Tu(a.ja);this.Oe=a.Rp;this.style=a.style},UL:function(){this.style=this.Oe=this.Mh=this.NB=this.ja=this.name=this.map=null;this.bl();this.tk()},XM:function(){return this.Oe},MP:function(a){this.Oe=a;this.zIndex=this.Oe[0].xe||this.zIndex},uS:function(){return this.ja},Tu:function(a){a&&(this.ja=a,this.J("coords",a,!0),this.Qn&&(a.J("radius",this),a.J("center",this),a.J("resolution",this),a.J("strokeWeight",this)))},setStyle:function(a){this.MP(a);this.bi()},coordsChanged:function(){this.bi()},radiusChanged:function(){this.ja.vj=this.ja.getBounds();this.ja.Mc=null;this.bi()},bi:function(a){this.set("feature",{target:this,QL:a,vj:this.ja.vj||this.ja.getBounds(),UN:this.ja.getBounds()});this.ja.vj=this.ja.getBounds()},visibleChanged:function(){this.bi()},CS:function(a){for(var d=0;d<this.Oe.length;d+=1){var f=this.Oe[d];if(a.equals(f.vk(this)))return f}},DM:function(){var a=this.ja,d=[];return a.Hd()===e.W.VectorLayer.un||a.Hd()===e.W.VectorLayer.rn?d.push(new e.style.Ob.Xc({fillColor:"#78cdd1",sc:.2,strokeColor:"#122e29",na:.5,Xa:1})):a.Hd()===e.W.VectorLayer.fq||a.Hd()===e.W.VectorLayer.Nv||a.Hd()===e.W.VectorLayer.hq?d.push(new e.style.Ob.Pv({color:"#888888",width:1,zIndex:10})):a.Hd()!==e.W.VectorLayer.Qj&&a.Hd()!==e.W.VectorLayer.iq||d.push(new e.style.Ob.nn({url:e.k.Va+"/theme/v1.3/markers/0.png",width:36,height:36,rotation:0,mU:-12,nU:-36,zIndex:100})),d}});e.kd.NQ="geometry";e.W.Bd=e.W.si.extend({r:function(a,d){this.Ta=a;this.dh=d;this.Mc=null},getBounds:function(){if(!this.Mc){var a=this.Ta[0],d=this.Ta[1];if(this.dh)this.Mc=[a,d,a,d];else{var f=this.get("radius"),f=f?f/Math.cos(Math.PI*this.get("center").G/180):0,e=this.get("resolution")*this.get("strokeWeight")||0;this.Mc=[a-f-e,d-f-e,a+f+e,d+f+e]}}return this.Mc},Hd:function(){return e.W.VectorLayer.Qj}});e.P={canvas:{},$b:{},eU:{},hi:{}};e.P.ye=e.Class.extend({jb:[e.oa,e.Kc],initialize:function(a,d){this.K=a;this.dh=a.xyzObject.dh;this.Un=d;this.w=d.w;this.J("display",d)},yt:function(a,d){var f=this.zoom,g=[],h=this.K;if(Math.floor(f)!==f)d(g,h);else{if(f=[a.x,a.y],h.um){for(var k=h.Nk,l=!0,m=[],n=0;n<k.length;n+=1){var p=k[n].Xh;if(p){var t=p.clientWidth,r=p.clientHeight;p.childNodes[0]&&(t=t||p.childNodes[0].clientWidth,r=r||p.childNodes[0].clientHeight);u.opera&&(t=Math.max(t,p.childNodes[0].scrollWidth),r=Math.max(r,p.childNodes[0].scrollHeight));0===t||0===r?(l=!1,m.push(k[n])):(h.tg=Math.max(h.tg,Math.abs(k[n].get("offset").x)+t),h.ug=Math.max(h.ug,Math.abs(k[n].get("offset").y)+r),k[n].width=t,k[n].height=r)}}l?(h.um=!1,h.Nk=[]):h.Nk=m}if(k=Math.max(h.tg,h.Mk||0)*this.L1,l=Math.max(h.ug,h.Mk||0)*this.L1,l=Math.max(l,h.jh||0),k=Math.max(k,h.jh||0),k=h.Gf([f[0]-k,f[1]-l,f[0]+k,f[1]+l])){for(var A in k)if(k.hasOwnProperty(A)&&(l=k[A],l.get("visible")&&!l.get("noSelect")))if(n=l.ja,n instanceof e.W.Bd)if(this.dh){var m=this.K.Pp,t=m.size.width*this.L1,r=m.size.height*this.L1,q=m.anchor.x*this.L1,E=m.anchor.y*this.L1,t=e.j.Rz([[f[0]-t+q,f[1]-r+E],[f[0]+q,f[1]+E]]);e.j.ge(t,n.Ta)&&g.push(l)}else if("undefined"!=typeof n.get("radius"))m=n.Ta,m=new e.Pixel(m[0],m[1]),(new e.Pixel(f[0],f[1])).distance(m)*Math.cos(l.get("center").G*Math.PI/180)<=n.get("radius")&&g.push(l);else{if(m=l.get("params"),m.visible){if(n=n.Ta,q=m.Kz%360,p=[f[0],f[1]],q){var t=(f[0]-n[0])/this.L1,r=(f[1]-n[1])/this.L1,E=Math.PI*q/180,q=Math.cos(-E),E=Math.sin(-E),v=t*E+r*q;p[0]=n[0]+(t*q-r*E)*this.L1;p[1]=n[1]+v*this.L1}t=l.width*this.L1;r=l.height*this.L1;q=m.offset.x*this.L1;E=m.offset.y*this.L1;t=e.j.Rz([[p[0]-t-q,p[1]-r-E],[p[0]-q,p[1]-E]]);n[0]instanceof Array||(n=[n]);for(r=n.length-1;0<=r;--r)if(e.j.ge(t,n[r])){m.shape?this.oN(l,p,n)&&g.push(l):g.push(l);break}}}else n.ge?n.ge(f)&&g.push(l):n.Qo&&1.8*n.Qo(f)<=l.get("strokeWeight")*this.L1&&g.push(l);this.dh||g.sort(function(a,d){return a.get("isTop")?-1:d.get("isTop")?1:a.get("zIndex")>d.get("zIndex")||a.get("zIndex")===d.get("zIndex")&&a.Uo>d.Uo?-1:1});d(g,h)}else d([],h)}},oN:function(a,d,f){var g=(d[0]-f[0][0])/this.L1;d=(d[1]-f[0][1])/this.L1;a=a.get("params");f=a.offset;var h,g=[g-f.x,d-f.y];if(a=a.shape,"circle"===a.F.type){if(d=a.F.coords[0],f=a.F.coords[1],Math.sqrt((g[0]-d)*(g[0]-d)+(g[1]-f)*(g[1]-f))<=a.F.coords[2])return!0}else{if("poly"===a.F.type)return h=a.F.coords,h=this.eL(h),e.wh.ge(g,h);if("rect"===a.F.type)return h=a.F.coords,a=h[0],d=h[1],f=h[2],h=h[3],h=[[a,d],[f,d],[f,h],[a,h]],e.wh.ge(g,h)}return!1},eL:function(a){for(var d=[],f=0;f/2<a.length/2;f+=2)d.push([a[f],a[f+1]]);return d},zt:function(a,d,f,g,h,k,l){var m=["position:absolute;"];m.push("top:"+Math.round(f)+"px;");m.push("left:"+Math.round(d)+"px;");m.push("width:"+Math.round(g)+"px;");m.push("height:"+Math.round(h)+"px;");1>k&&("opacity"in a.style?(m.push("opacity"),m.push(":"),m.push(k),m.push(";")):8<=q.documentMode?(m.push("-ms-filter:'progid:DXImageTransform.Microsoft.Alpha(opacity\x3d"),m.push(Math.ceil(100*k)),m.push(")';")):(m.push("filter:alpha(opacity\x3d"),m.push(Math.ceil(100*k)),m.push(");")));m.push("z-index:"+l+";");e.d.pD(a,m.join(""))}});e.P.Ld=e.Class.extend({jb:[e.oa,e.Kc],r:function(a){this.w=a;this.Br={};this.Yj=a.Yj;this.u=a.Ra.S;this.J("display",a);this.J("rotateEnable",a)},yt:function(a,d,f,g){function h(a,g){a.length&&(m[e.g.indexOf(d,g)]=a);--n;0>=n&&(f(m),n=0)}for(var k,l=d.length,m=[],n=0,p=[],t=0;l>t;t+=1)k=d[t],k instanceof e.S.Buildings&&k.get("visible")&&(p.push(this.At(k)),n+=1);for(l=0;l<p.length;l+=1)p[l].yt(a,h,g)}});e.P.canvas.Ld=e.P.Ld.extend({r:function(a){arguments.callee.Sa.apply(this,arguments)},At:function(a){var d=e.g.Vb(a);return this.Br[d]||(this.Br[d]=a.P=a.Yh(this)),this.Br[d]},yd:function(a){this.w.Ra.Sh.style.cssText="";for(var d=a.vb,f=a.va,g=a.size.width,h=a.size.height,k=0;k<d.length;k+=1){var l=d[k],l=this.At(l),m=d[k].ei();if(l)if(!m.visible||m.vc[0]>f.zoom||m.vc[1]<f.zoom)if(l=l.Hf(),l.length)for(m=0;m<l.length;m+=1)l[m].parentNode===this.u&&this.u.removeChild(l[m]);else l.parentNode===this.u&&this.u.removeChild(l);else{l.yd(a,m);var n,p,t=l.Hf(),r=l.transform;if(r&&t){d[k].Ca=t;t.length||(t=[t],r=[r]);for(var A=0;A<t.length;A+=1){n=t[A];p=r[A];var q=p.translate.x,u=p.translate.y;d[k].ep||(q=e.g.Ff(q,2),u=e.g.Ff(u,2));var v=p.scale;1E-5>Math.abs(q)&&(q=0);1E-5>Math.abs(u)&&(u=0);var x=[];x.push("position:absolute");x.push("z-index:"+(p.xe||d[k].get("zIndex")));d[k].Ro?(x.push("top:"+Math.floor(h/2+u)+"px"),x.push("left:"+Math.floor(g/2+q)+"px")):n.getContext?(x.push("height:"+Math.floor(n.height*v)+"px"),x.push("width:"+Math.floor(n.width*v)+"px"),x.push("top:"+Math.floor(h/2-u*v)+"px"),x.push("left:"+Math.floor(g/2-q*v)+"px")):(1!==v&&(x.push(e.d.al[e.d.Zc]+"-origin:"+q+"px "+u+"px"),x.push(e.d.al[e.d.Zc]+":scale3d("+v+","+v+",1)")),x.push("top:"+Math.floor(h/2-u)+"px"),x.push("left:"+Math.floor(g/2-q)+"px"));!l.ep&&1!==m.opacity&&"number"==typeof m.opacity&&"opacity"in n.style&&x.push("opacity:"+m.opacity);(n.parentNode!==this.u||e.h.Sd)&&this.u.appendChild(n);e.d.pD(n,x.join(";"))}}else d[k].Hk&&(t.parentNode!==this.u||e.h.Sd)&&(this.u.appendChild(t),d[k].Ca=t)}}a=this.w.Ra.Sh;l=this.w.Ra.S;d=this.w.Ra.ra;e.d.Zc&&"number"==typeof f.rotation&&0!==f.rotation?(a.style[e.d.Zc+"Origin"]=g/2+"px "+h/2+"px",a.style[e.d.Zc]="rotate("+f.rotation+"deg)",a.style.overflow="visible",l.style.overflow="visible",d.style.overflow="visible"):(a.style.cssText="",l.style.cssText="-webkit-transform: translateZ(0);",d.style.cssText="");this.w.Mp=!1}});e.P.Eg=e.P.ye.extend({initialize:function(a,d){arguments.callee.Sa.apply(this,arguments);this.J("reload",a,!0);this.tiles=new e.Ov({size:e.h.size,Zu:.7,qt:2,Yu:300});var f=this;this.tiles.e("drop",function(a){f.sG(a.el)});this.Pb=1;this.LF=50;this.qw=!0;this.K.tiles=this.tiles;this.Qt=new e.Lv(6,null,a.HA);new e.Lv(5,null,a.HA)},reloadChanged:function(){this.K&&(this.K.Ab=!1);this.tiles.clear();this.reload=!0;this.set("display")},RB:function(a,d){if(!a.Jk||a.Jk.Vg){var f=this;a.loaded=!1;a.Jk=d.QB(a.url,function(d){a.Jk=null;a.loaded=!0;f.tiles.set(a.key,a);d&&f.K&&(a.X=d,a.Jk=null,f.set("display",0),f.Lk+=1,f.K.Ab||f.Lk!==f.ip||(f.K.Ab=!0,f.K.ia("complete")))},!1)}},cE:function(a,d,f,g){var h=[];f=f||18;d=Math.pow(2,d-f);for(var k=0;k<a.length;k+=1){var l=a[k].xyzObject,m=Math.floor(l.x/d),l=Math.floor(l.y/d);g?(m=f+"/"+m+"/"+l,l=this.tiles.get(m)):(l=new e.xyzObject(f,m,l),m=l+"",l=new e.tile(l));!h[m]&&l&&(h.push(l),h[m]=1)}return h},SB:function(a){for(var d=a.length-1;0<=d;--d){var f=a[d];if(f.length)if(this.Hc){var e=f[0].xyzObject.z;18<e&&(f=this.cE(f,e));this.DD(f,!0);for(var h=0,k=0;h<a.length;)this.HN(f.slice(30*k,30),e),h+=30,k+=1}else for(this.DD(f),this.ip+=f.length,e=f.length-1;0<=e;--e)this.RB(f[e],this.Qt)}},Ft:function(a,d){var f=a+"";return(d?this.tiles.Qk(f):this.tiles.get(f))||new e.tile(a.qb(),this.af(a.x,a.y,a.z))},Tm:function(a,d){return this.yb*Math.pow(2,a-d)},sG:function(a){a.Jk&&this.Qt.cL(a.Jk);a.Mu=!1;a.loaded=!1},Xs:function(a,d,f){var g=this.xb,h=a.L1;a=d.Mb.x;var k=d.Mb.y,l=d.kb.x;return d=d.kb.y,this.Sp=new e.Pixel(0,0),g=this.Tm(this.zoom,g)*h,g/=Math.pow(2,this.De),f&&(l=Math.max(f[0],l)-f[0],d=Math.max(f[1],d)-f[1],a=Math.min(f[2],a)-f[0],k=Math.min(f[3],k)-f[1],this.Sp=new e.Pixel(Math.floor(f[0]/g),Math.floor(f[1]/g))),a/=g,k/=g,f={ae:0===a%1?a-1:Math.floor(a),ud:0===k%1?k-1:Math.floor(k),te:Math.floor(l/g),gd:Math.floor(d/g)},f.Nm=f.ae-f.te+1,f.vp=f.ud-f.gd+1,f},DD:function(a,d){if(a.length){var f=this.fb.divideBy(this.yb*Math.pow(2,this.xb-a[0].xyzObject.z)*this.nb),e=Math.floor(f.x),h=Math.floor(f.y);a.sort(function(a,f){var g=a.xyzObject,n=f.xyzObject,k=g.x-e,g=g.y-h,l=n.x-e,n=n.y-h;return(d?-1:1)*(l*l+n*n-(k*k+g*g))})}},clear:function(){this.Qt.clear()},Du:function(a,d){d.af!==this.af&&(this.af=d.af,this.tiles.clear());this.clear();this.Xf=d.Xf;this.Wf=d.Wf;this.yb=d.yb;var f=a.va;this.hd=d.hd||a.va.hd;this.Th=f.Th;this.size=a.size;this.rotation=f.rotation;this.fb=f.fb;this.nb=f.nb;this.De=(this.io=e.h.Y&&d.sa&&!d.wN)?1:0;this.zoom=f.zoom;this.ad=this.xb=f.xb;this.ad+=this.De;this.L1=f.L1;a.scale=Math.pow(2,this.zoom-this.xb);var g;g=this.xb>this.zoom&&a.Ea.kE?a.Ea.kE:a.Ea;var h,k,l,m,n,p,t,r,f=this.Rc=this.Xs(f,g,d.j),A=[],q=[],u=[],v,x=[],w=new e.xyzObject(0,0,0),B;v=this.Hg||"";var z={},C={};this.Uc=1E6*Math.random()<<0;for(k=v.length-1;0<=k;--k)if(h=v[k],!(h.ol<d.opacity))if(w.z=h.xyzObject.z,w.x=h.xyzObject.x,w.y=h.xyzObject.y,w.z===this.ad)z[w+""]|=16;else if(w.z<this.ad){if(z[w+""]|=64,this.Xf)for(r=this.ad-w.z,l=Math.max(f.te,w.x<<r),B=Math.min(f.ae,(w.x+1<<r)-1),m=Math.max(f.gd,w.y<<r),n=Math.min(f.ud,(w.y+1<<r)-1),w.z=this.ad,p=l;B>=p;p+=1)for(w.x=p,t=m;n>=t;t+=1)w.y=t,r=w+"",z[r]|=32,C[r]=C[r]?Math.max(h.xyzObject.z,C[r]):h.xyzObject.z}else if(this.Wf)for(r=1;w.z>=this.ad;){z[w+""]|=r;l=w.x>>1;m=w.y>>1;B=l<<1;n=m<<1;h=0;for(p=2;0<p;--p)for(w.x=B+p,t=2;0<t;--t)w.y=n+t,5&z[w+""]&&(h+=1);--w.z;w.x=l;w.y=m;r=4===h?4:2}v=[];w.z=this.ad;for(p=f.te;p<=f.ae;p+=1)for(w.x=p,t=f.gd;t<=f.ud;t+=1)w.y=t,h=this.Ft(w),r=w+"",l=!1,h.X?a.qc&&this.Hc&&!h.gg?l=!0:(h.Uc=this.Uc,v.push(h),r=z[r],36&r?(h.Pb!==this.Pb||1>h.ol)&&(l=!0):h.Jl=!0):(l=!0,!h.status&&w.z<=d.vc[1]+this.De&&u.push(h)),l&&x.push(h);if(v.hc=this.xb,v.length&&(A.push(v),A["lv"+this.xb]=v),q.push(u),q["lv"+this.xb]=u,this.Wf){x=x.slice(0);u=[];for(k=x.length-1;0<=k;--k)h=x[k],4&z[h.key]||u.push(h);h=d.vc[1]+this.De;for(B=this.ad+1;x.length&&h>=B;B+=1){v=[];n=x;x=[];w.z=B;for(k=n.length-1;0<=k;--k)if(p=n[k],r=z[p.key],7&r)for(l=p.xyzObject.x<<1,m=p.xyzObject.y<<1,p=2;0<p;--p)for(w.x=l+p,t=2;0<t;--t){w.y=m+t;r=w+"";var D=this.tiles.Qk(r);5&z[r]&&D&&D.X?(D.Jl=!0,D.Uc=this.Uc,v.push(D)):x.push(new e.tile(w.qb(),""))}v.length&&(v.hc=B-this.De,A.push(v),A["lv"+(B-this.De)]=v,this.Hc&&this.aD(v,A,this.ad-B))}x=u}if(this.Xf)for(p=Math.max(d.vc[0],this.ad-3),t=Math.max(p,this.ad-this.oR),B=this.ad-1;x.length&&B>=p;--B){m=B>=t;u=[];v=[];D={};n=x;x=[];for(k=n.length-1;0<=k;--k)h=n[k],w.z=B,w.x=h.xyzObject.x>>1,w.y=h.xyzObject.y>>1,h=this.Ft(w,!m),D[h.key]||(D[h.key]=1,l=!1,h.X&&(!this.uR||64&z[h.key])?(w.x=Math.min(f.ae,Math.max(f.te,w.x<<this.ad-B)),w.y=Math.min(f.ud,Math.max(f.gd,w.y<<this.ad-B)),w.z=this.ad,r=w+"","number"==typeof C[r]&&h.xyzObject.z>C[r]?l=!0:(h.Jl=!0,h.Uc=this.Uc,v.push(h))):(l=!0,m&&!h.status&&u.push(h),l&&x.push(h)));v.length&&(A.push(v),v.hc=B-this.De,A["lv"+(B-this.De)]=v,this.Hc&&this.aD(v,A,this.ad-B));m&&u.length&&(q.push(u),q["lv"+(B-this.De)]=u)}this.Lk=this.ip=0;this.Hc&&!a.dC||this.SB(q,g);this.jv=A;this.K.set("tiles",A)},aD:function(a,d,f){for(var e=0;e<a.length;e+=1)for(var h=a[e].xyzObject,k=h.z+f,l=Math.pow(2,f),m=h.x*l,h=h.y*l,n=0;l>n;n+=1)for(var p=0;l>p;p+=1){var t=this.tiles.get(k+"/"+(m+n)+"/"+(h+p));if(t&&d["lv"+(k-this.De)]){var r=d["lv"+(k-this.De)].indexOf(t);-1!==r&&t.X&&!t.gg&&d["lv"+(k-this.De)].splice(r,1)}}},rT:function(){var a=this.Rc.ae+1,d=this.Rc.ud+1,f=this.Rc.ae-1,g=this.Rc.ud-1,h=new e.xyzObject(0,0,0);h.z=this.ad;for(var k=[],l=f;a>=l;l+=1){h.x=l;for(var m=g;d>=m;m+=1)h.y=m,this.tiles.Qk(void 0)||(f=new e.tile(h.qb(),this.af(h.x,h.y,h.z)),k.push(f))}this.SB([k])}});e.P.$b.Eg=e.P.Eg.extend({r:function(a,d){arguments.callee.Sa.apply(this,arguments);this.setContainer()},setContainer:function(){this.Ca=q.createElement("div")},Hf:function(){return this.Ca},Dj:function(){if(this.Hg)for(var a=0;a<this.Hg.length;a+=1){var d=this.Hg[a];if(d.X&&this.Uc!==d.Uc&&this.Ca===d.X.parentNode){if(e.h.td&&d.X.vml)for(var f in d.X.vml)d.X.vml.hasOwnProperty(f)&&this.Ca===d.X.vml[f].shape.parentNode&&this.Ca.removeChild(d.X.vml[f].shape);this.Ca.removeChild(d.X)}else{var g=d.xyzObject,h=g.x/Math.pow(2,g.z-this.xb),g=g.y/Math.pow(2,g.z-this.xb);if((Math.ceil(h)<this.Rc.te||Math.floor(h)>this.Rc.ae||Math.ceil(g)<this.Rc.gd||Math.floor(g)>this.Rc.ud)&&d.X&&this.Ca===d.X.parentNode){if(e.h.td&&d.X.vml)for(var k in d.X.vml)d.X.vml.hasOwnProperty(k)&&this.Ca===d.X.vml[k].shape.parentNode&&this.Ca.removeChild(d.X.vml[k].shape);this.Ca.removeChild(d.X);d.zoom=null}}}},yd:function(a,d){if(a.Up||a.kv)this.Jc(a,d,!0);else{this.Du(a,d);var f=!1;(!this.ba||3E4<Math.abs(this.fb.x-this.ba.x)/this.L1||3E4<Math.abs(this.fb.y-this.ba.y)/this.L1)&&(f=!0);(f||this.zoom<<0!==this.zoom||this.Jd!==this.zoom)&&(this.ba=this.fb,this.Jd=this.zoom);var f=!1,g=+new Date,h=d.opacity;"opacity"in this.Ca.style&&(h=1);this.Sf=d.Bo;var k=[],l=this.Pb;this.Pb+=1;var m=this.jv;if(this.Dj(),e.h.td&&"overlayer"===this.K.get("type")&&this.Ca&&a.lf)this.Ca.innerHTML="",this.Hg=[];else{for(var n,p,t=m.length-1;0<=t;--t){var r=m[t];if(n=r.hc+this.De,r.length){var q,v=this.Tm(this.zoom,n);for(n=r.length-1;0<=n;--n){p=r[n];q=p.xyzObject;var u=h;if((!p.Ln||this.qw&&p.Pb!==l)&&(p.Ln=g),p.Pb=this.Pb,this.Sf&&!p.Jl?(u=Math.max(0,Math.abs(q.z-this.zoom)-1),u=Math.min(h,(g-p.Ln)/(1/Math.pow(1.32,u)*this.LF)),e.h.td&&(u=h),1!==u&&(f=!0)):p.Jl=!1,0!==u&&p.X){if(p.X.parentNode!==this.Ca||p.zoom!==this.zoom||p.ol!==h){var y=(new e.Pixel(q.x,q.y)).add(this.Sp).multiplyBy(v).subtract(this.ba.divideBy(this.L1)),y=y.round(),x=Math.ceil(v);this.zt(p.X,y.x,y.y,x,x,u,q.z);p.zoom=this.zoom}if(p.X.parentNode!==this.Ca){if(e.h.td&&"overlayer"===this.K.get("type"))try{p.X.style.visibility="hidden",e.g.iepngFix(p.X)}catch(w){}this.Ca.appendChild(p.X)}else e.h.td&&"overlayer"===this.K.get("type")&&(p.X.style.visibility="hidden");k.push(p)}p.ol=u}}}this.Hg=k;f&&this.set("display",0);this.Jc(a,d)}}},Jc:function(a,d){var f=Math.pow(2,a.va.zoom-this.Jd);a.sa&&!d.sa&&(f*=2);this.transform={translate:a.va.fb.subtract(this.ba).divideBy(this.L1),scale:f,rotate:0}}});u.CanvasRenderingContext2D&&(u.CanvasRenderingContext2D.prototype.at=function(a,d,f,e,h){"undefined"==typeof h&&(h=[10,10]);this.moveTo(a,d);var g=f-a,l=e-d,m=Math.floor(Math.sqrt(g*g+l*l));e=g/m;f=l/m;h.Zt=0;for(var n=[],g=this.Oo,p=0,t=0,r=!1,q=l=0;q<h.length;q+=1)h.Zt+=h[q],n[q]={ht:h[q]*e,it:h[q]*f,$d:l+=h[q]},g-=h[q],0>g&&!r&&(p=q,t=-g,r=!0);for(r=0;m>=t+r;)t<h[p]?(g=t*e,l=t*f):(g=n[p].ht,l=n[p].it),a+=g,d+=l,this.Um?this.moveTo(a,d):this.lineTo(a,d),r+=t,this.Um=!this.Um,t=h[(p+1)%h.length],p=(p+1)%h.length;m-=r;a+=m*e;d+=m*f;this.Um?this.moveTo(a,d):this.lineTo(a,d);this.Oo=(this.Oo+r+m)%h.Zt},u.CanvasRenderingContext2D.prototype.KL=function(a,d,f,e){"undefined"==typeof e&&(e=[10,10]);var g=2*Math.PI*f,k=0>=e?g:Math.round(g/(e[0]+e[1])),l=(e[0]+e[1])/g*2*Math.PI;e=e[0]/g*2*Math.PI;for(g=0;k>g;g+=1)this.beginPath(),this.arc(a,d,f,g*l,g*l+e),this.stroke()});e.DataParse=e.Class.extend({initialize:function(a){this.yb=256;this.S=a.S},dU:function(){},parseStyle:function(a,d){d=d.split("\x26");a.face=e.g.decryptionColor(d[this.QD]);d[this.dv]?(a.border=e.g.decryptionColor(d[this.dv]),a.width=(this.S.sa?2:1)*(parseInt(d[this.LD])||1)):a.border=null},mO:function(a,d,f,e,h,k){return a=f-a,f=h-f,0===a||0===f?a===f?!0:!1:(k-e)/f===(e-d)/a?!0:void 0},formatLnglats:function(a,d,f,e){var g,k=[],l,m;if(f){l=this.yb*d.x;m=this.yb*d.y;d=d.L1;f=0;for(var n=a.length;n>f;f+=2)e=(l+a[f])*d,g=(m+a[f+1])*d,k.push([e,g]),l+=a[f],m+=a[f+1]}else for(d=(18<d.hc?Math.pow(2,18-d.hc):1)/(this.S.sa?2:1),f=0,n=a.length;n>f;f+=2){for(u.EK+=1;!e&&0!==f&&n-2>f&&this.mO(a[f-2],a[f-1],a[f],a[f+1],a[f+2],a[f+3]);)f+=2,u.$L+=1;1===d?k.push([a[f],a[f+1]]):k.push([a[f]/d,a[f+1]/d])}return k},$K:function(a,d,f){var e=0,h=0,k=1;return f&&(e=this.yb*d.x,h=this.yb*d.y,k=d.L1),[(e+a[0])*k,(h+a[1])*k]},parseLngLats:function(a,d,f,g){for(var h=[],k=0,l=a.length;l>k;k+=1){var m=this.formatLnglats(e.g.decryptionLngLats(a[k]),d,f,g);m.length&&(h.push(m),h.Rh=h.Rh?h.Rh+m.Rh:m.Rh)}return h},getParsedDatas:function(a,d,f){var g,h;if("roadlabel"===f.type||"poilabel"===f.type?(h=!0,g=[]):(h=!1,g={}),!d)return g;a.xyzObject.hc=a.hc;for(var k,l,m,n,p=0,t=d.length;t>p;p+=1)if(h)for(l=0;l<d[p][0].length;l+=1){if(n=this.parse(a,d[p][0][l],d[p][1],f))if(18<a.hc){var r=a.hc;m=a.xyzObject;k=Math.pow(2,r-18);var q=Math.floor(n.wd[0]/256*k),u=Math.floor(n.wd[1]/256*k),q=Math.max(0,q),q=Math.min(q,k-1),u=Math.max(0,u),u=Math.min(u,k-1);(r=this.S.tiles.get(r+"/"+(k*m.x+q)+"/"+(k*m.y+u)))&&(r.Ua||(r.Ua=[]),a.Ue&&(r.Ue||(r.Ue={}),e.extend(r.Ue,a.Ue)),n.wd[0]=n.wd[0]*k%256,n.wd[1]=n.wd[1]*k%256,r.Ua.push(n))}else a.Ua.push(n)}else l=d[p][this.Vm],n=this.parse(a,d[p],l,f),k=this.Em?d[p][this.Em]:1,m=g[k]?g[k]:g[k]={},m[l]||(m[l]=[],"road"===f.type?(r=a.hc,k=1,18<r&&(k=Math.pow(2,r-18)),this.parseStyle(m[l],l,k)):this.parseStyle(m[l],l)),m[l].push(n);return g}});e.region=e.DataParse.extend({initialize:function(){e.DataParse.prototype.initialize.apply(this,arguments);this.fm=0;this.Em=2;this.Vm=1;this.QD=0;this.LD=1;this.dv=2},parse:function(a,d,f){return this.parseLngLats(d[this.fm],a.xyzObject,f.Hc)}});e.building=e.DataParse.extend({initialize:function(){e.DataParse.prototype.initialize.apply(this,arguments);this.fm=0;this.Vm=1;this.QD=0;this.LD=1;this.dv=2},parse:function(a,d,f){if(a=this.parseLngLats(d[this.fm],a.xyzObject,f.Hc,1),(d=d[4])&&d.length){f=0;for(var e=d.length;e>f;f+=1)for(var h=d[f].split("-"),k=a[parseInt(h[0])],l=1,m=h.length;m>l;l+=1)k[parseInt(h[l])].mC=!0}return a},dK:function(a,d){for(var f in d)if(d.hasOwnProperty(f)){var e,h=d[f];for(e in h)if(h.hasOwnProperty(e))for(var k=h[e],l=0,m=k.length;m>l;l++){var n=k[l];n.MF===a.UK&&(n.pK=!0,n[a.MA]&&(n[a.MA].pK=!0))}}},NF:function(a,d,f){for(var e=[],h=0,k=d.length;k>h;h++){var l=d[h].split("-"),l={UK:a,MA:l[0],Ss:l[1]};e.push(l);this.dK(l,f)}return e},getParsedDatas:function(a,d,f){var g=e.DataParse.prototype.getParsedDatas.apply(this,arguments),h=!1;if(d&&d.length){for(var k=[],l=0,m=d.length;m>l;l++){var n=d[l];6<=n.length&&n[5].length&&k.push.apply(k,this.NF(l,n[5],g))}k.length&&(a.Ue||(a.Ue={}),a.Ue.Ts=k,h=!0)}return h&&e.mn&&e.mn.q("vecTileParsed.buildings",{hv:a,data:d,UR:f,Ua:g}),g}});e.road=e.DataParse.extend({initialize:function(){e.DataParse.prototype.initialize.apply(this,arguments);this.fm=0;this.Vm=1;this.Em=2;this.linear="solid solid_roundcap solid_squarecap dash railway dash_crewel".split(" ")},parseStyle:function(a,d,f){var g=this.linear;d=d.split("\x26");var h="",k=0,l=0,m="butt",n="",p,t,r="butt";p=e.g.decryptionColor(d[1]);t=(parseInt(d[0])*f||1)*(this.S.sa?2:1);f=d[2];f===g[1]?r="round":f===g[2]?r="square":0!==f.indexOf(g[5])&&(0===f.indexOf(g[3])?n=eval("["+f.substring(5).split(")")+"]"):0===f.indexOf(g[4])&&(k=p,p="white",n=eval("["+f.substring(8).split(")")+"]"),l=t+1+(this.S.sa?1:0),t=t-1-(this.S.sa?1:0)));d[3]&&(k=e.g.decryptionColor(d[4]),l=parseInt(d[3])*(this.S.sa?2:1)+t,d=d[5],d===g[1]?m="round":d===g[2]?m="square":0!==d.indexOf(g[5])&&0===d.indexOf(g[3])&&(h=eval("["+d.substring(5).split(")")+"]")));a.strokeColor=p;a.strokeWeight=t;a.lineCap=r;a.wP=n;a.outlineStrokeColor=k;a.outlineStrokeWeight=l;a.outlineLineCap=m;a.PK=h},parse:function(a,d,f){return f=this.parseLngLats(d[this.fm],a.xyzObject,f.Hc),(!a.S||d[this.Em]>a.S)&&(a.S=d[this.Em],a.Rh=0),a.Rh=Math.max(a.Rh,f.Rh),f}});e.LabelDataParse=e.DataParse.extend({initialize:function(a){e.DataParse.prototype.initialize.apply(this,arguments);this.sd=[];this.WA="http://"+a.dataUrl+"/icons/"+(e.h.Y||e.h.sa?"b":"n");this.RK=e.h.Y?15:7;this.Yt=e.h.sa?320:256},parse:function(a,d,f,g){var h=this.S.sa,k=this.S.VD,l=d[this.cC];f=f.split("\x26");var m,n="Microsoft YaHei",p=parseInt(f[this.ND]),t=e.g.decryptionColor(f[this.MD]),r=400,q=e.g.decryptionLngLats(d[this.RC]);if(!(255<q[0]||0>q[0]||255<q[1]||0>q[1])){h&&(p*=k);var u={Ta:this.$K(q,a.xyzObject,g.Hc)};u.wd=q;u.sd=[];u.vg=[];f[this.cv]&&(m=e.g.decryptionColor(f[this.cv]));var v,y;if("roadlabel"===g.type)g=!1,u.uN=!0,(f=f[this.Of])&&d[this.ym]&&(u.sd.push(this.WA+(10>a.xyzObject.z?"39":"18")+"/1/"+f+".png"),t="152"===f?"black":"white",m=null,r=d[this.ym],h&&(r[0]*=k,r[1]*=k,r[2]*=k,r[3]*=k),u.vg.push(r),r=400,n="Arial Narrow,Arial",g=!0),g&&(e.h.Y?(v=47,y=15):(v=22,y=13),h&&(v*=k,y*=k)),p=Math.round(p),r=this.hB(a,l.replace(" ",""),n,p,t,m,r,v),u.sd.push(r),1<l.length||g?(a=Math.ceil(r.gi/2),h=r.gi,v&&(h=Math.min(v,h),a=Math.min(Math.floor(v/2)-1,a)),r.pm===p&&(y=p),u.vg.push([-a,-Math.ceil(y/2),h,r.pm,r.ru,r.su,r.gi,r.pm])):(p=r.pm+2,a=-r.pm/2,u.vg.push([-r.gi/2,a,p,p,r.ru,r.su,r.fn,r.wm])),u.Ou=d[this.Gs]?5>d[this.Gs]?0:d[this.Gs]:0,1<l.length&&u.sd[0].indexOf&&-1<u.sd[0].indexOf("png")&&(u._sd={},u._sd[u.sd[0]]=[r,u.vg[u.vg.length-1]]);else{if(u.name=l.replace("^",""),l=l.split("^"),y=d[this.eQ],f[this.Of]&&d[this.ym]&&(u.rN=!0,u.sd.push(this.WA+(10>a.xyzObject.z?"39":"18")+"/1/"+f[this.Of]+".png"),r=d[this.ym],"334"===f[this.Of]&&h&&(r[0]=r[1]=-7,r[3]=r[2]=15),"445"===f[this.Of]&&h&&(r[0]=-3,r[1]=-6,r[3]=13,r[2]=6),"301"===f[this.Of]&&h&&(r[1]=r[0],r[3]=r[2]),h&&(r[0]*=k,r[1]*=k,r[2]*=k,r[3]*=k),u.vg.push(r)),0<y.length)for(g=0;g<y.length;g+=1){var r=_n=l[g],q=y[g][0],x=y[g][1]+g;("375"===f[this.Of]||"3751"===f[this.Of])&&(p=12,x=-5,v=15,h&&(p*=k,v*=k));p=Math.round(p);r=this.hB(a,r,n,p,t,m,null,v,f[this.OD]);h&&(q*=k,x*=k,y[g][2]*=k,y[g][3]*=k);"375"!==f[this.Of]&&"3751"!==f[this.Of]||(q=-Math.min(r.gi/2,v/2));u.sd.push(r);x-=e.h.Y?3:1;u.vg.push([q,x,f[this.OD]?r.gi:Math.min(y[g][2],r.gi),r.wm,r.ru,r.su,r.gi,r.wm])}1==y.length&&u.sd[0].indexOf&&-1<u.sd[0].indexOf("png")&&(u.__sd={},u.__sd[u.sd[0]]=[r,u.vg[u.vg.length-1]]);d[4]&&(u.MC=d[4])}return u}},YR:function(){return q.createElement("img")},$M:function(a){return Math.min(Math.max(100*(a-this.RK),400),800)},hB:function(a,d,f,g,h,k,l,m,n){var p=a.xN;p||(p=e.d.create("canvas"),a.xN=p,p.width=p.height=this.Yt,p.DC=p.EC=0,p.he=p.getContext("2d"),p.he.lineWidth=2);var t=p.he;l=l||this.$M(g);a=this.S.sa?this.S.VD:1;var r=n?2*a:0,q=(g+2)*d.length+2,u=g+5*a,v=p.DC,y=p.EC;return v+q>this.Yt&&(v=0,y+=p.maxHeight,y>this.Yt&&(p.maxHeight=0)),p.maxHeight=Math.max(p.maxHeight||0,u),t.font=l+" "+g+"px "+f,g=parseInt(t.font),(100<g||!g)&&(g=parseInt(t.font.split(" ")[1])),f=g*d.length,k&&(t.strokeStyle!==k&&(t.strokeStyle=k),t.strokeText(d,v+r,y+g,m||f)),k=t.measureText(d).width,n&&(n=e.g.decryptionColor(n),t.fillStyle!==n&&(t.fillStyle=n),t.fillRect(v,y,k+4*a,g+4*a+e.h.Y)),t.fillStyle!==h&&(t.fillStyle=h),t.fillText(d,v+r,y+g,m||f),p.DC=v+q,p.EC=y,d=p,d.gi=n?k+4*a:k,d.pm=g,d.fn=q,d.wm=u,d.ru=v,d.su=y,d}});e.poilabel=e.LabelDataParse.extend({initialize:function(){e.LabelDataParse.prototype.initialize.apply(this,arguments);this.cC=0;this.RC=1;this.eQ=2;this.Vm=1;this.ym=3;this.Of=0;this.ND=1;this.MD=2;this.cv=3;this.OD=4},parse:function(a,d,f,g){var h=e.LabelDataParse.prototype.parse.apply(this,arguments);return h&&5<d.length&&1===d[5]&&(h.nH=!0),h}});e.roadlabel=e.LabelDataParse.extend({initialize:function(){e.LabelDataParse.prototype.initialize.apply(this,arguments);this.cC=0;this.RC=1;this.Gs=2;this.ym=this.Vm=3;this.Of=0;this.ND=1;this.MD=2;this.cv=3}});e.P.canvas.pf=e.P.Eg.extend({initialize:function(a,d){arguments.callee.Sa.apply(this,arguments);this.Hc=!0;this.Ci=[];var f=this;this.On=function(){f.VN=!0;f.set("display",0)};this.setContainer();a.w.Fb.Xt&&this.GF(a,d)},EM:function(a){var d=256*this.nb,f=this.xb,e=a.wd.x/d,h=e%1*256,e=Math.floor(e);a=a.wd.y/d;d=a%1*256;a=Math.floor(a);var k=e-1,l=e+1,m=a-1,n=a+1;128>h?l=e:k=e;for(128>d?n=a:m=a;l>=k;k+=1)for(var p=m;n>=p;p+=1){var t=this.tiles.get(f+"/"+k+"/"+p);if(t&&t.Ua)for(var r=t.Ua.length-1;0<=r;--r)if(t.Ua[r].MC&&t.Ua[r].rN&&this.nN(t.Ua[r],h,d,k-e,p-a))return t.Ua[r]}return null},nN:function(a,d,f,e,h){e=a.wd[0]+256*e;h=a.wd[1]+256*h;for(var g=0;g<a.sd.length;g+=1){var l=a.vg[g][2],m=a.vg[g][3],n=a.vg[g][0],p=a.vg[g][1];if(this.K.sa&&(l/=this.K.hf,m/=this.K.hf,n/=this.K.hf,p/=this.K.hf),d>=e+n-1&&e+n+l+1>=d&&f>=h+p-1&&h+p+m+1>=f)return!0}return!1},reloadChanged:function(){this.K&&(this.K.Ab=!1,e.jd.TA=null);this.tiles.clear();this.Ca&&this.Ca.parentNode&&this.Ca.parentNode.removeChild(this.Ca);this.Ti&&this.Ti.parentNode&&this.Ti.parentNode.removeChild(this.Ti);this.set("display")},Hf:function(){return[this.Ca,this.Ti]},wT:function(a){for(var d=0;d<this.Ci.length;d+=1)this.Ci[d].hc&&!a["lv"+this.Ci[d].hc]&&(this.Ci[d].QS=!1,this.Ci[d].width=0,this.Ci[d].height=0,this.WS[this.Ci[d].hc]=null)}});e.P.canvas.pf.include({GF:function(a){this.fe={};this.webSocket=new e.WebSocket;this.webSocket.e("tiles",this.gO,this);this.webSocket.e("ack",this.fO,this);this.webSocket.e("disable",this.dO,this);this.J("mapStyle",a,!0)},Ew:function(){this.webSocket&&(this.webSocket.close(),this.webSocket.tk(),this.webSocket=null)},bA:function(){if(this.webSocket&&"unsupport"!==this.webSocket.zb){var a={command:"status",payload:{mapType:this.get("mapStyle"),style:5}};this.webSocket.send(a)}},mapStyleChanged:function(){this.bA()},dO:function(){for(var a in this.fe)this.fe.hasOwnProperty(a)&&(this.wl(this.fe[a].iv,this.fe[a].hc),delete this.fe[a]);this.webSocket=null;this.Lj("mapStyle");this.set("display",1)},fO:function(a){var d=a.reqId;this.fe[d]&&(!a.content.status&&this.fe[d]&&this.wl(this.fe[d].iv,this.fe[d].hc),delete this.fe[d])},gO:function(a){var d=a.content.opt;if(d===this.xb){a=a.content.data;for(var f=0,e=a.length;e>f;f+=1)this.parseTileData(a[f],d)}else this.fe[a.reqId]&&this.wl(this.fe[a.reqId].iv,this.fe[a.reqId].hc)},HN:function(a,d){if(a.length){var f=1,g=[];18<d&&(f=Math.pow(2,d-18));for(var h=this.K.aj.If(a[0].xyzObject.z),k=0;k<a.length;k+=1){var l=a[k],m=l.xyzObject;if(l.hc=d,m.L1=h,18<d){for(var n=0;f>n;n+=1)for(var p=0;f>p;p+=1){var t=new e.tile(new e.xyzObject(d,f*m.x+n,f*m.y+p));this.tiles.ac(t.key)||(this.tiles.set(t.key,t),t.status="loading")}this.tiles.set(l.key+"/"+d,l)}else if(this.tiles.set(l.key,l),l.status="loading",10>d){var r,q,n=m.x,p=m.y,t=m.z;q=Math.ceil(this.Rc.Nm/2);var u=Math.pow(2,t);n>=u&&u+q>=n?(n-=u,r=!0):0>n&&n>=-q&&(n+=u,r=!0);r&&(r=t+"/"+n+"/"+p,(q=this.tiles.get(r))?(l.status=q.status,l.X=q.X,l.gg=q.gg):(q=new e.tile(new e.xyzObject(t,n,p)),this.tiles.set(r,q),q.status="loading"),q.pb=l,l.pb=q)}"loaded"===l.status?this.set("display"):g.push(e.g.kt(m.x,m.y,m.z).join(","))}g.length&&(this.webSocket&&"unsupport"!==this.webSocket.zb?(0===this.webSocket.count?this.loadTile(a,d,g):(1!==this.webSocket.count&&"connected"===this.webSocket.zb||this.bA(),this.GN(a,d,g)),this.webSocket.count+=1,this.webSocket.MB&&this.webSocket.Lu.push(Math.ceil((new Date-this.webSocket.MB)/1E3)),this.webSocket.MB=new Date):this.loadTile(a,d,g))}},GN:function(a,d,f){var e=(new Date).getTime()+"-"+(this.webSocket.count+1&65535);this.webSocket.send({command:"tiles",reqId:e,payload:{t:f,opt:d,cs:{level:d}}});this.fe[e]={iv:a,hc:d}},uC:function(a){a.Ab||(a.status="",a.Ab=void 0,a.X=null,a.Dc=null,a.pb&&(a.pb.pb=null,a.pb=null),this.tiles.cl(a.key))},parseTileData:function(a,d){if(this.K){var f=a[0].split("-"),e=f[3],f=f.splice(0,3).join("/"),h=18<d?Math.pow(2,d-18):1;18<d&&(f+="/"+d);(f=this.tiles.get(f))&&"loaded"!==f.status&&(this.XD(f,h)||f.pb&&this.XD(f.pb,h))&&("poilabel"===e&&(f.status="loaded",f.pb&&(f.pb.status="loaded")),this.K.aE(a,f,d,e))}},wl:function(a,d,f){f||(f=18<d?Math.pow(2,d-18):1);for(var g=0;g<a.length;g+=1){var h=a[g];this.tD(d,h,f,e.g.bind(this.uC,this));18<d&&this.tiles.cl(h.key+"/"+d)}},loadTile:function(a,d,f){function g(a){if(d===l.xb){var f=a.indexOf("|");if(-1==f)m+=a;else{m+=a.substring(0,f);var e=JSON.parse(m);e["x-vd-v"]||l.parseTileData(e,d);m="";g(a.substring(f+1))}}}var h=new XMLHttpRequest;f=this.K.url+f.join(";")+"\x26lv\x3d"+d;var k=0,l=this,m="";h.sT="";var n=18<d?Math.pow(2,d-18):1;h.onreadystatechange=function(){l.K&&(3===h.readyState?h.wG||(g(h.responseText.substring(k)),k=h.responseText.length,h.hG=!0):4===h.readyState&&h.startTime&&(l.K.aE("first"),h.hG||l.wl(a,d,n)))};this.bN||(this.bN=1,e.jd.TA=h.startTime=new Date);h.open("GET",f,!0);h.send()},XD:function(a,d){var f=a.xyzObject.x,e=a.xyzObject.y;return f>Math.floor(this.Rc.ae/d)||f<Math.floor(this.Rc.te/d)||e>Math.floor(this.Rc.ud/d)||e<Math.floor(this.Rc.gd/d)?!1:!0},tD:function(a,d,f,g){if(18<a){d=d.xyzObject;for(var h=0;f>h;h+=1)for(var k=0;f>k;k+=1){var l=new e.xyzObject(a,f*d.x+h,f*d.y+k)+"";(l=this.tiles.get(l))&&g(l)}}else g(d),d.pb&&g(d.pb)}});e.P.canvas.pf.include({setContainer:function(){this.Ca=q.createElement("div");this.Ti=q.createElement("canvas");this.La=new e.P.canvas.pf.Buildings(this.Ti,this.On);this.Xo=q.createDocumentFragment()},YO:function(a){var d=Math.pow(2,a.va.zoom-this.xb),f=this.K.sa?2:1,e=a.va.fb.subtract(this.gp).divideBy(this.nb);this.transform=[{translate:this.transform[0].translate.add(e),scale:d,rotate:0},{translate:this.transform[1].translate.add(e.multiplyBy(f)),scale:d/f,rotate:0,xe:1}];this.fb=a.va.fb},XO:function(a,d){var f=Math.pow(2,a.va.zoom-this.Jd);if(8<=f)this.cD(a,d);else{var g=a.va.fb.subtract(this.gp).divideBy(this.xg);this.transform[0]={translate:this.transform[0].translate.add(g),scale:f,rotate:0};f=this.Rc;this.Bp(a,256*f.Nm,256*f.vp);f=new e.Pixel(a.Ea.mb.x*(this.K.sa?this.K.hf:1),a.Ea.mb.y*(this.K.sa?this.K.hf:1));this.transform[2]={translate:f,scale:1/(this.K.sa?this.K.hf:1),rotate:0,xe:this.K.get("textIndex")};this.fb=a.va.fb}},cD:function(a,d){(!this.ba||3E4<Math.abs(this.fb.x-this.ba.x)/this.L1||3E4<Math.abs(this.fb.y-this.ba.y)/this.L1)&&(this.ba=this.fb);this.Jd=this.xb;this.xg=this.nb;this.Iu=!1;this.currentTime=+new Date;this.wQ=d.wQ;var f=this.Rc;this.Eb=[256*f.te*this.nb,256*f.gd*this.nb];this.Sf=d.Bo;var g=this.jv,h=256*f.Nm,f=256*f.vp;this.lf=this.zoom<<0!==this.zoom;var k=this.fb.subtract(this.ba);k.x<-e.g.Wa/2&&(k.x+=e.g.Wa);k.x>e.g.Wa/2&&(k.x-=e.g.Wa);this.dL=k.divideBy(this.nb);this.nP(g,h,f,d);this.Bp(a,h,f);this.VN=!1;this.Iu&&this.set("display",0);this.Jc(a)},yd:function(a,d){this.Du(a,d);this.gp&&(a.kv||a.Up&&e.h.Sd||a.iu&&a.SK)?this.YO(a,d):this.gp&&a.lf?this.XO(a,d):this.cD(a,d);this.gp=this.fb},Dj:function(){for(var a=Array.prototype.slice.call(this.Ca.childNodes,0),d=a.length-1;0<=d;--d)a[d]&&a[d].Pb!==this.Pb&&this.Ca.removeChild(a[d])},nP:function(a){var d=this.Pb;this.Pb+=1;var f,g,h,k=!1,l=!1,m=[];this.ba.x-this.fb.x<-e.g.Wa/2?this.ba=new e.Pixel(this.ba.x+e.g.Wa,this.ba.y):this.ba.x-this.fb.x>e.g.Wa/2&&(this.ba=new e.Pixel(this.ba.x-e.g.Wa,this.ba.y));for(f=a.length-1;0<=f;--f)if(h=a[f],g=h.hc,h.length){var l=!1,n=g-this.xb;(1>=n&&!m.ak||m.ak&&m.ak.dt>n)&&(m.ak=[],m.ak.dt=Math.abs(n),l=!0);for(var p=this.Tm(this.xb,g),t=h.length-1;0<=t;--t){if(n=h[t],l&&m.ak.push(n),!n.pb&&this.ba===n.ba&&n.Jd===this.Jd){var r=n.Dc;if(r&&r.parentNode===this.Ca){m.push(n);r.Pb=this.Pb;n.Pb=this.Pb;continue}}n.ba=this.ba;n.Jd=this.Jd;g=n.xyzObject;var k=!0,r=new e.Pixel(g.x*p*this.nb,g.y*p*this.nb),q=r.subtract(this.fb);q.x<-e.g.Wa/2?r.x+=e.g.Wa:q.x>e.g.Wa/2&&(r.x-=e.g.Wa);q=r.subtract(this.ba);q=q.divideBy(this.nb);q.x=Math.floor(q.x);q.y=Math.floor(q.y);(!n.Ln||this.qw&&n.Pb!==d)&&(n.Ln=this.currentTime);n.Jl=!1;n.X?(n.Pb=this.Pb,r=n.Dc,!r&&n.pb&&n.pb.Dc&&(r=n.pb.Dc),r&&(n.ol=1,this.zt(r,q.x,q.y,p,p,1,g.z),r.parentNode!==this.Ca&&this.Ca.appendChild(r),r.Pb=this.Pb,n.xb=this.xb,m.push(n))):n.Uc=null}l=!0}return this.Hg=m,this.Dj(),k||!l},Bp:function(a){var d=this.Ti,f=this.La;f.lf=this.lf;var g=this.K.sa?this.K.hf:1;if(0!==a.va.rotation?e.d.Rm(d,2*Math.floor(a.Ea.mb.x)*g,2*Math.floor(a.Ea.mb.y)*g,!0):e.d.Rm(d,a.size.width*g,a.size.height*g,!0),f.Eb=[a.Ea.kb.x,a.Ea.kb.y],this.La.nb=this.L1*(this.K.sa?1/this.K.hf:1),(d=this.Hg.ak)&&d.length&&!(.5<d[0].xyzObject.z-this.zoom))for(f=d.length-1;0<=f;--f){var g=d[f].Ua,h=!1;!g&&d[f].pb&&d[f].pb.Ua&&(g=d[f].pb.Ua,h=!0);this.La.Bp(g||{},h,a.lf||d[0].xyzObject.z!==this.zoom,e.Qe&&e.Qe.FB(this.w.Fb))}},Jc:function(a){var d=Math.pow(2,this.zoom-this.xb),f=this.fb.subtract(this.ba);f.x<-e.g.Wa/2&&(f.x+=e.g.Wa);f.x>e.g.Wa/2&&(f.x-=e.g.Wa);f.divideBy(this.nb);a=new e.Pixel(a.Ea.mb.x*(this.K.sa?this.K.hf:1),a.Ea.mb.y*(this.K.sa?this.K.hf:1));this.transform=[{translate:this.dL,scale:d,rotate:0},{translate:a,scale:1/(this.K.sa?this.K.hf:1),rotate:0,xe:this.K.get("textIndex")}]}});e.P.canvas.pf.Buildings=e.Class.extend({initialize:function(a,d){this.tb=a;this.sd={};this.Jg=d},dD:function(a,d,f,e,h){f=[];for(var g in a)a.hasOwnProperty(g)&&(a[g].gn=parseInt(g),f.push(a[g]));f.sort(function(a,d){return a.gn>d.gn?1:-1});for(g in f)if(f.hasOwnProperty(g)){a=f[g];for(var l in a)a.hasOwnProperty(l)&&(e=a[l],this.Ku(e,e.face,e.border,e.width,d,h))}},Ku:function(a,d,f,e,h){var g,l,m,n,p,t,r,q=this.tb.getContext("2d"),u,v=[NaN,NaN];q.save();f&&e&&(q.strokeStyle=f,q.lineWidth=e);d&&(q.fillStyle=d);this.fl={};q.beginPath();g=0;for(l=a.length;l>g;g+=1)if(m=a[g],n=m.length,0<n)for(var y=0;n>y;y+=1)for(p=m[y],t=0,r=p.length;r>t;t+=1)u=p[t],0===t?(v=u,q.moveTo(u[0],u[1])):(u[0]!==v[0]||u[1]!==v[1])&&(q.lineTo(u[0],u[1]),v=u);if(d&&q.fill(),h)for(q.beginPath(),g=0,l=a.length;l>g;g+=1)if(m=a[g],n=m.length,0<n)for(y=0;n>y;y+=1)for(p=m[y],t=0,r=p.length;r>t;t+=1)u=p[t],0===t?(v=u,q.moveTo(u[0],u[1])):(u[0]!==v[0]||u[1]!==v[1])&&(v.mC?(q.moveTo(u[0],u[1]),u.mC&&q.lineTo(u[0],u[1])):q.lineTo(u[0],u[1]),v=u);return f&&e&&q.stroke(),q.restore(),!0},Zo:function(a){if("IMG"===a.tagName||"CANVAS"===a.tagName)return a;var d=this.sd[a];return"undefined"==typeof d?(d=q.createElement("img"),d.src=a,this.sd[a]=d,d.loaded=!1,e.l.mh(d,"load",this.Mt,this),null):d.loaded?d:void 0},Mt:function(a){a.target.loaded=!0;this.Jg&&this.Jg()},Gb:function(a,d){return this.lf?[(a-this.Eb[0])/this.nb,(d-this.Eb[1])/this.nb]:[.5+(a-this.Eb[0])/this.nb<<0,.5+(d-this.Eb[1])/this.nb<<0]},oP:function(a){var d,f=[];for(d in a)a.hasOwnProperty(d)&&(a[d].gn=parseInt(d),f.push(a[d]));f.sort(function(a,d){return a.gn>d.gn?1:-1});for(d in f)if(f.hasOwnProperty(d)){a=f[d];var e,h;for(e in a)a.hasOwnProperty(e)&&(h=a[e],h.outlineStrokeColor&&this.drawLIneORPolygon(h,h.outlineStrokeColor,h.outlineStrokeWeight,h.outlineLineCap,h.PK));for(e in a)a.hasOwnProperty(e)&&(h=a[e],h.strokeColor&&this.drawLIneORPolygon(h,h.strokeColor,h.strokeWeight,h.lineCap,h.wP))}},drawLIneORPolygon:function(a,d,f,e,h){var g=this.tb.getContext("2d");return g.save(),g.lineWidth=f,g.strokeStyle=d,g.lineCap=e,g.lineJoin="bevel",g.setLineDash?(this.setLinePath(g,a),h&&(g.setLineDash(h),g.lineDashOffset=h[0])):h&&1<h.length?this.setPolygonPath(g,a,h):this.setLinePath(g,a),g.stroke(),g.restore(),!0},setLinePath:function(a,d){a.beginPath();var f,e,h,k,l,m,n,p,t,r;f=0;for(l=d.length;l>f;f+=1)for(m=d[f],e=0,n=m.length;n>e;e+=1)for(t=m[e],h=0,p=t.length;p>h;h+=1)k=t[h],0===h?(a.moveTo(k[0],k[1]),r=k):(k[0]!==r[0]||k[1]!==r[1])&&(a.lineTo(k[0],k[1]),r=k)},setPolygonPath:function(a,d,f){a.beginPath();var e,h,k,l,m,n,p,t,r,q;e=0;for(m=d.length;m>e;e+=1)for(n=d[e],a.Oo=f[0]+f[1],a.Um=!1,h=0,p=n.length;p>h;h+=1)for(r=n[h],k=0,t=r.length;t>k;k+=1)l=r[k],0===k?(a.moveTo(l[0],l[1]),q=l):(l[0]!==q[0]||l[1]!==q[1])&&(a.at(q[0],q[1],l[0],l[1],f),q=l);a.closePath()}});e.P.canvas.pf.Buildings.include({Bp:function(a,d,f,e){for(var g=0,k=a.length;k>g;g+=1)if(!(f&&a[g].uN||e&&a[g].nH)){var l=a[g].Ta,m=l[0];d&&(m>I.g.Wa/2?m-=I.g.Wa:m<I.g.Wa/2&&(m+=I.g.Wa));for(var l=this.Gb(m,l[1]),m=0,n=a[g].sd.length;n>m;m+=1)this.dP(l,a[g].sd[m],a[g].vg[m],a[g].Ou,a[g]._sd||a[g].__sd)}},dP:function(a,d,f,e,h){var g=this.tb.getContext("2d");if(this.__isExtract)if(d&&d.indexOf&&-1<d.indexOf("png")){var l,m=this;h?m.__loadedImg__[d]?(m._dP(a,m.__loadedImg__[d].cloneNode(),f,e,g),m._dP(a,h[d][0],h[d][1],e,g)):(l=q.createElement("img"),l.src=d,l.onload=function(){m._dP(a,l,f,e,g);m._dP(a,h[d][0],h[d][1],e,g);m.__loadedImg__[d]=l.cloneNode();l.onload=null}):m.__loadedImg__[d]?m._dP(a,m.__loadedImg__[d],f,e,g):(l=q.createElement("img"),l.src=d,l.onload=function(){m.__loadedImg__[d]=l;m._dP(a,l,f,e,g);l.onload=null})}else{if(!h){if(d=this._Zo(d),!d)return 1;this._dP(a,d,f,e,g)}}else{if(d=this.Zo(d),!d)return 1;this._dP(a,d,f,e,g)}},_dP:function(a,d,f,e,h){var g=f[2],l=f[3],m=f[0],n=f[1];if(e=(e||0)%360*-Math.PI/180,0!==e){var p=Math.cos(e),t=Math.sin(e),r=a[0],q=a[1];h.transform(p,t,-t,p,(1-p)*r+t*q,(1-p)*q-t*r)}4===f.length?h.drawImage(d,a[0]+m,a[1]+n,g,l):h.drawImage(d,f[4],f[5],f[6],f[7],a[0]+m,a[1]+n,g,l);0!==e&&h.setTransform(1,0,0,1,0,0)},_Zo:function(a){if("IMG"===a.tagName||"CANVAS"===a.tagName)return a;var d=this.sd[a];return"undefined"==typeof d?(d=q.createElement("img"),d.src=a,this.sd[a]=d,d.loaded=!1,I.l.mh(d,"load",this.Mt,this),null):d.loaded?d:void 0}});e.TileLayer.WMS=e.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var f=e.extend({},this.defaultWmsParams),g;for(g in d)g in this.options||(f[g]=d[g]);d=e.setOptions(this,d);f.width=f.height=d.tileSize*(d.detectRetina&&e.Browser.retina?2:1);this.wmsParams=f},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;e.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToBounds(a),f=this._crs.project(d.getNorthWest()),d=this._crs.project(d.getSouthEast()),f=(1.3<=this._wmsVersion&&this._crs===e.CRS.EPSG4326?[d.y,f.x,f.y,d.x]:[f.x,d.y,d.x,f.y]).join(",");a=e.TileLayer.prototype.getTileUrl.call(this,a);return a+e.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+f},setParams:function(a,d){return e.extend(this.wmsParams,a),d||this.redraw(),this}});e.tileLayer.wms=function(a,d){return new e.TileLayer.WMS(a,d)};e.Util.extend(e.TileLayer.WMS.prototype,{defaultWmsParams:e.Util.extend(e.TileLayer.WMS.prototype.defaultWmsParams,{version:"1.1.0",format:"image/png",layers:"default",transparent:!0}),getTileUrl:function(a,d,f,g){var h=this._tileCoordsToBounds(g),k=this._crs.project(h.getNorthWest()),h=this._crs.project(h.getSouthEast()),k=[k.x,h.y,h.x,k.y].join();a=e.TileLayer.prototype.getTileUrl.call(this,a,d,f,g);return a+e.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"\x26BBOX\x3d":"\x26bbox\x3d")+k}});e.TileLayer.WMTS=e.TileLayer.extend({defaultWmsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"default",format:"image/jpeg",uppercase:!1,style:"normal",tilematrixSet:"",mid:"",p:0,scale:1},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var f=e.extend({},this.defaultWmsParams),g;for(g in d)g in f&&(f[g]=d[g]);d=e.setOptions(this,d);u.devicePixelRatio&&1<u.devicePixelRatio&&(f.scale=2);f.width=f.height=d.tileSize*(d.detectRetina&&e.Browser.retina?2:1);this.wmsParams=f},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);e.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a,d,f,g){g=e.TileLayer.prototype.getTileUrl.call(this,a,d,f,g);a=this.options.uppercase?"\x26TILECOL\x3d"+a+"\x26TILEROW\x3d"+(this.options.tms?this._globalTileRange.max.y-d:String(d))+"\x26TILEMATRIX\x3d"+String(f):"\x26tilecol\x3d"+a+"\x26tilerow\x3d"+(this.options.tms?this._globalTileRange.max.y-d:String(d))+"\x26tilematrix\x3d"+String(f);return g+e.Util.getParamString(this.wmsParams,g,this.options.uppercase)+a},setParams:function(a,d){return e.extend(this.wmsParams,a),d||this.redraw(),this}});e.tileLayer.wmts=function(a,d){return new e.TileLayer.WMTS(a,d)};e.TileLayer.WMTS.LONLAT=e.TileLayer.extend({defaultWmsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"",tilematrixSet:"",format:"image/jpeg"},initialize:function(a,d){this._url=a;var f=e.extend({},this.defaultWmsParams),g;for(g in d)g in f&&(f[g]=d[g]);d=e.setOptions(this,d);u.devicePixelRatio&&1<u.devicePixelRatio&&(f.scale=2);f.width=f.height=d.tileSize*(d.detectRetina&&e.Browser.retina?2:1);this.wmtsParams=f;this.matrixIds=d.matrixIds||this.getDefaultMatrix();e.setOptions(this,d)},onAdd:function(a){e.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a,d,f,g){var h=this._map;crs=h.options.crs;tileSize=this.options.tileSize;nwPoint=g.multiplyBy(tileSize);nwPoint.x+=1;--nwPoint.y;sePoint=nwPoint.add(new e.Point(tileSize,tileSize));nw=crs.project(h.unproject(nwPoint,f));se=crs.project(h.unproject(sePoint,f));tilewidth=se.x-nw.x;ident=this.matrixIds[f].identifier;X0=this.matrixIds[f].topLeftCorner.lng;Y0=this.matrixIds[f].topLeftCorner.lat;tilecol=Math.floor((nw.x-X0)/tilewidth);tilerow=-Math.floor((nw.y-Y0)/tilewidth);a=e.TileLayer.prototype.getTileUrl.call(this,a,d,f,g);return a+e.Util.getParamString(this.wmtsParams,a)+"\x26tilematrix\x3d"+ident+"\x26tilerow\x3d"+tilerow+"\x26tilecol\x3d"+tilecol},setParams:function(a,d){return e.extend(this.wmtsParams,a),d||this.redraw(),this},getDefaultMatrix:function(){for(var a=Array(22),d=0;22>d;d++)a[d]={identifier:""+d,topLeftCorner:new e.LatLng(90,-180)};return a}});e.tileLayer.wmts=function(a,d){return new e.TileLayer.WMTS(a,d)};e.tileLayer.wmts.lonlat=function(a,d){return new e.TileLayer.WMTS.LONLAT(a,d)};e.ImageOverlay=e.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(a,d,f){this._url=a;this._bounds=e.latLngBounds(d);e.setOptions(this,f)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(e.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image));this.getPane().appendChild(this._image);this._reset()},onRemove:function(){e.DomUtil.remove(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&e.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&e.DomUtil.toBack(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=a,this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=e.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));a.onselectstart=e.Util.falseFn;a.onmousemove=e.Util.falseFn;a.onload=e.bind(this.fire,this,"load");this.options.crossOrigin&&(a.crossOrigin="");a.src=this._url;a.alt=this.options.alt},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom);a=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;e.DomUtil.setTransform(this._image,a,d)},_reset:function(){var a=this._image,d=new e.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=d.getSize();e.DomUtil.setPosition(a,d.min);a.style.width=f.x+"px";a.style.height=f.y+"px"},_updateOpacity:function(){e.DomUtil.setOpacity(this._image,this.options.opacity)}});e.imageOverlay=function(a,d,f){return new e.ImageOverlay(a,d,f)};e.Icon=e.Class.extend({initialize:function(a){e.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,d){var f=this._getIconUrl(a);if(!f){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}f=this._createImg(f,d&&"IMG"===d.tagName?d:null);return this._setIconStyles(f,a),f},_setIconStyles:function(a,d){var f=this.options,g=f[d+"Size"];"number"==typeof g&&(g=[g,g]);var g=e.point(g),h=e.point("shadow"===d&&f.shadowAnchor||f.iconAnchor||g&&g.divideBy(2,!0));a.className="leaflet-marker-"+d+" "+(f.className||"");h&&(a.style.marginLeft=-h.x+"px",a.style.marginTop=-h.y+"px");g&&(a.style.width=g.x+"px",a.style.height=g.y+"px")},_createImg:function(a,d){return d=d||q.createElement("img"),d.src=a,d},_getIconUrl:function(a){return e.Browser.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});e.icon=function(a){return new e.Icon(a)};e.VectorIcon={};e.VectorIcon.version="1.0.0";e.VectorIcon.MAP_POINT_PIN="M16,1 C7.7146,1 1,7.65636364 1,15.8648485 C1,24.0760606 16,51 16,51 C16,51 31,24.0760606 31,15.8648485 C31,7.65636364 24.2815,1 16,1 L16,1 Z";e.VectorIcon.Icon=e.Icon.extend({options:{iconSize:[0,0],anchor:[15,50],offset:[0,0],popupAnchor:[0,-50],shadowAnchor:[7,45],shadowSize:[54,51],className:"vector-marker",prefix:"fa",spinClass:"fa-spin",extraClasses:"",icon:"home",markerColor:"blue",iconColor:"white",type:1,width:0,height:0},initialize:function(a){return e.Util.setOptions(this,a)},createIcon:function(a){var d,f,g,h,k="";a=a&&"DIV"===a.tagName?a:q.createElement("div");d=this.options;d.icon&&(k=this._createInner());g="filter:alpha(opacity\x3d"+10*d.alpha+");opacity:"+d.alpha;f=e.VectorIcon.MAP_POINT_PIN;var l=d.iconSize[0]+Number(d.strokewidth),m=d.iconSize[1]+Number(d.strokewidth);return 1==d.type?(l=32,m=52,h='\x3cpath d\x3d"'+f+'" fill\x3d"'+d.markerColor+'" stroke\x3d"'+d.strokecolor+'" stroke-width\x3d"'+d.strokewidth+'" style\x3d"'+g+'"\x3e\x3c/path\x3e'):2==d.type?h='\x3crect x\x3d"'+Math.floor(d.strokewidth)+'" y\x3d"'+d.strokewidth+'" width\x3d"'+Math.floor(d.iconSize[0]-d.strokewidth)+'" height\x3d"'+Math.floor(d.iconSize[1]-d.strokewidth)+'" fill\x3d"'+d.markerColor+'" stroke\x3d"'+d.strokecolor+'" stroke-width\x3d"'+d.strokewidth+'" style\x3d"'+g+'"\x3e\x3c/rect\x3e':3==d.type&&(h='\x3ccircle cx\x3d"'+Math.floor(d.iconSize[0]/2+d.strokewidth)+'" cy\x3d"'+Math.floor(d.iconSize[1]/2+d.strokewidth)+'" r\x3d"'+(Math.floor(d.iconSize[1]/2)-d.strokewidth)+'" fill\x3d"'+d.markerColor+'" stroke\x3d"'+d.strokecolor+'" stroke-width\x3d"'+d.strokewidth+'" style\x3d"'+g+'"\x3e\x3c/circle\x3e'),a.innerHTML='\x3csvg width\x3d"'+d.iconSize[0]+'px" height\x3d"'+d.iconSize[1]+'px" viewBox\x3d"0 0 '+l+" "+m+'" version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink"\x3e'+h+k+"\x3c/svg\x3e",this._setIconStyles(a,"icon"),a},_createInner:function(){var a,d,f,e,h;return e="",d="",f="",h=this.options,a=""===h.prefix||h.icon.slice(0,h.prefix.length+1)===h.prefix+"-"?h.icon:h.prefix+"-"+h.icon,h.spin&&"string"==typeof h.spinClass&&(e=h.spinClass),h.iconColor&&("white"===h.iconColor||"black"===h.iconColor?d="icon-"+h.iconColor:f="style\x3d'color: "+h.iconColor+"' "),"\x3ci "+f+"class\x3d'"+h.extraClasses+" "+h.prefix+" "+a+" "+e+" "+d+"'\x3e\x3c/i\x3e"},_setIconStyles:function(a,d){var f=this.options,g=f.iconSize||[23,36],h=e.point(f.offset)||{x:0,y:0},k=f.anchor||{x:0,y:0},l=(f[d+"Visibility"],"");k&&(a.style.marginLeft=-k.x+"px",a.style.marginTop=-k.y+"px");h&&(a.style.left=h.x+"px",a.style.top=h.y+"px");g&&(a.style.width=g.x+"px",a.style.height=g.y+"px");a.style.visibility=l;a.className="vector-marker-"+d+" "+f.className;a.style.position="relative"},createShadow:function(){var a;return a=q.createElement("div"),this._setIconStyles(a,"shadow"),a}});e.VectorIcon.icon=function(a){return new e.VectorIcon.Icon(a)};e.ImagDivIcon=e.Icon.extend({updateIcon:function(a,d){this._setIconStyles(a,d)},_createIcon:function(a,d){var f=this._getIconUrl(a);if(!f){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}var e=this._createImg(d&&"IMG"===d.tagName?d:null);return e.src=f,this._setIconStyles(e,a),e},_setIconStyles:function(a,d){var f=this.options,g=e.point(f[d+"Size"]),h=e.point(f.offset)||{x:0,y:0},k=f.anchor||{x:0,y:0},l=(f[d+"Visibility"],""),m=e.point(f[d+"Position"])||{x:0,y:0};a.className="leaflet-marker-"+d+" "+(f.className||"");k&&(a.style.marginLeft=-k.x+h.x+"px",a.style.marginTop=-k.y+h.y+"px");g&&(a.style.width=g.x+"px",a.style.height=g.y+"px");a.src&&(a.style.background="url("+a.src+") no-repeat  "+m.x+"px  "+m.y+"px");a.style.visibility=l},_createImg:function(a,d){return d||q.createElement("div")}});e.TextDivIcon=e.ImagDivIcon.extend({options:{iconUrl:"",text:"",style:"",shadowUrl:null,iconSize:new e.Point(25,41),iconAnchor:new e.Point(13,41),popupAnchor:new e.Point(0,-33),className:"leaflet-div-icon"},createIcon:function(a){return this._createIcon("icon",a)},_createIcon:function(a,d){var f=this._getIconUrl(a);if(!f){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}var e=q.createElement("div"),h=this._createImg(d&&"IMG"===d.tagName?d:null);h.src=f;f=q.createElement("div");return f.setAttribute("class",this.options.style),f.innerHTML=this.options.text||"",e.appendChild(h),e.appendChild(f),this._setIconStyles(e,h,"icon"),e},_setIconStyles:function(a,d,f){var g=this.options,h=e.point(g[f+"Size"]),k=e.point(g.offset)||{x:0,y:0},l=g.anchor||{x:0,y:0},m=(g[f+"Visibility"],""),n=e.point(g[f+"Position"])||{x:0,y:0};a.className="leador-marker-"+f+" "+(g.className||"");l&&(a.style.marginLeft=-l.x+k.x+"px",a.style.marginTop=-l.y+k.y+"px");h&&(d.style.width=h.x+"px",d.style.height=h.y+"px",a.style.width=h.x+"px",a.style.height=h.y+"px");d.src&&(d.style.background="url("+d.src+") no-repeat  "+n.x+"px  "+n.y+"px");a.style.visibility=m},createShadow:function(){return null}});e.Icon.Default=e.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return e.Icon.Default.imagePath||(e.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||e.Icon.Default.imagePath)+e.Icon.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=e.DomUtil.create("div","leaflet-default-icon-path",q.body),d=e.DomUtil.getStyle(a,"background-image")||e.DomUtil.getStyle(a,"backgroundImage");return q.body.removeChild(a),0===d.indexOf("url")?d.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}});e.Marker=e.Layer.extend({options:{icon:new e.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(a,d){e.setOptions(this,d);this._latlng=e.latLng(a)},onAdd:function(a){(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)&&a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;return this._latlng=e.latLng(a),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=a.icon.createIcon(this._icon),g=!1;f!==this._icon&&(this._icon&&this._removeIcon(),g=!0,a.title&&(f.title=a.title),a.alt&&(f.alt=a.alt));e.DomUtil.addClass(f,d);a.keyboard&&(f.tabIndex="0");this._icon=f;a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var f=a.icon.createShadow(this._shadow),h=!1;f!==this._shadow&&(this._removeShadow(),h=!0);f&&e.DomUtil.addClass(f,d);this._shadow=f;1>a.opacity&&this._updateOpacity();g&&this.getPane().appendChild(this._icon);this._initInteraction();f&&h&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});e.DomUtil.remove(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&e.DomUtil.remove(this._shadow);this._shadow=null},_setPos:function(a){e.DomUtil.setPosition(this._icon,a);this._shadow&&e.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(e.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),e.Handler.MarkerDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable());this.dragging=new e.Handler.MarkerDrag(this);a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;e.DomUtil.setOpacity(this._icon,a);this._shadow&&e.DomUtil.setOpacity(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}});e.marker=function(a,d){return new e.Marker(a,d)};e.Util.extend(e.Marker.prototype,{options:e.Util.extend(e.Marker.prototype.options,{zIndexOffset:2,raiseOnDrag:!1,angleOffsetX:null,rotate:0}),getIcon:function(){return this.options.icon},rotate:function(a){this.options.rotate=a;this.update()},_initIcon:function(){var a=this.options,d=("leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),a.icon.createIcon(this._icon,"marker")),f=!1;if(d!==this._icon&&(this._icon&&this._removeIcon(),f=!0,a.title&&(d.title=a.title),a.alt&&(d.alt=a.alt)),a.keyboard&&(d.tabIndex="0"),this._icon=d,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),1>a.opacity&&this._updateOpacity(),f)a.icon.options.isBefore?(a=this.getPane().childNodes[0])?this.getPane().insertBefore(this._icon,a):this.getPane().appendChild(this._icon):this.getPane().appendChild(this._icon);this._initInteraction()},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});this._icon&&(e.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon));this._icon=null},_setPos:function(a){this._setPosOrigin&&this._setPosOrigin(a);this._light&&e.DomUtil.setPosition(this._light,a);var d=this._icon;if(e.Browser.ie){d.style.left=a.x+"px";d.style.top=a.y+"px";d.style.position="absolute";var f=this._transform();if(f)d.style[f]="rotate("+this.options.rotate+"deg)";else{var f=Math.cos(this.options.rotate*Math.PI/180),g=Math.sin(this.options.rotate*Math.PI/180);d.style.filter="progid:DXImageTransform.Microsoft.Matrix("+self.sizingMethod+",M11\x3d"+f+",M12\x3d"+-g+",M21\x3d"+g+",M22\x3d"+f+")"}}else e.DomUtil.setPosition(this._icon,a,this.options.rotate);this._shadow&&e.DomUtil.setPosition(this._shadow,a);-1!=this.options.zIndexOffset&&(this._zIndex=this.options.zIndexOffset);this._resetZIndex()},_transform:function(){for(var a=["WebkitTransform","MozTransform","OTransform","msTransform"],d=0;d<a.length;d++)if(a[d]in q.documentElement.style)return a[d];return!1},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)}});e.Util.extend(e.Icon.prototype,{updateIcon:function(a,d){this._setIconStyles(a,d)},_setIconStyles:function(a,d){var f=this.options,g=f[d+"Size"],h=e.point(f[d+"Position"])||{x:0,y:0};"number"==typeof g&&(g=[g,g]);var g=e.point(g),k=e.point(f.offset)||{x:0,y:0},l=f.anchor||{x:0,y:0};a.className="leaflet-marker-"+d+" "+(f.className||"");l&&(a.style.marginLeft=-l.x+k.x+"px",a.style.marginTop=-l.y+k.y+"px");g&&(a.style.width=g.x+"px",a.style.height=g.y+"px");a.imgurl&&(a.style.background="url("+a.imgurl+") no-repeat  "+h.x+"px  "+h.y+"px")},_createDiv:function(a,d){return d||q.createElement("div")},_createImg:function(a,d){return d=d||q.createElement("img"),d.src=a,d},createIcon:function(a,d){return this._createIcon("icon",a,d)},_createIcon:function(a,d,f){var e=this._getIconUrl(a);if(!e){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}if(f||(f="marker"),"marker"==f){var h=this._createDiv(d&&"IMG"===d.tagName?d:null);h.imgurl=e}else"groundimage"==f&&(h=this._createImg(e,d&&"IMG"===d.tagName?d:null));return this._setIconStyles(h,a),h}});e.GroundImage=e.Marker.extend({initialize:function(a,d){e.setOptions(this,d);a&&(this._bounds=e.latLngBounds(a),this._latlng=e.latLng(a.getNorthWest()))},update:function(){var a=this._icon;if(a){var d=this._getIconSize({zoom:this._map.getZoom(),center:this._map.getCenter()}),f=new e.point(d[0]*this.options.anchor[0],d[1]*this.options.anchor[1]),g=this.options.offset;a.style.marginLeft=-f.x+g.x+"px";a.style.marginTop=-f.y+g.y+"px";a.style.width=d[0]+"px";a.style.height=d[1]+"px";a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},setBounds:function(a,d){if(this._bounds=e.latLngBounds(a),this._latlng=e.latLng(a.getNorthWest()),!d){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}},getBounds:function(){return this._bounds},_initIcon:function(){var a=this.options,d=a.icon.createIcon(this._icon,"groundimage"),f=!1;d!==this._icon&&(this._icon&&this._removeIcon(),f=!0,a.title&&(d.title=a.title),a.alt&&(d.alt=a.alt));a.keyboard&&(d.tabIndex="0");this._icon=d;a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});1>a.opacity&&this._updateOpacity();f&&this.getPane().appendChild(this._icon);this._initInteraction()},_setPos:function(a){e.DomUtil.setPosition(this._icon,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_animateZoom:function(a){this.update()},_initInteraction:function(){if(this.options.interactive&&(e.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),e.Handler.GroundImageDrag)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable());this.dragging=new e.Handler.GroundImageDrag(this);a&&this.dragging.enable()}},_getIconSize:function(a){if(!this._map)return[0,0];var d=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),a.zoom,a.center).round();a=this._map._latLngToNewLayerPoint(this._bounds.getSouthEast(),a.zoom,a.center).round();return[a.x-d.x,a.y-d.y]}});e.Marker.include({glow:null,flare:null,color:"#ff0000",offset:{x:0,y:0},light:null,_initIcon:function(){this._initIconOrigin();"marker-icon.png"==this.options.icon.options.iconUrl&&this.createLight()},createLight:function(){this.light=this._light=e.DivIcon.prototype.createIcon();e.DomUtil.remove(this.light);e.DomUtil.remove(this._light);e.DomUtil.addClass(this.light,"light");this.glow=e.DomUtil.create("span","glow",this.light);this.flare=e.DomUtil.create("span","flare",this.light);"permanent"===this.options.highlight?e.DomUtil.addClass(this.light,"permanent"):"temporary"===this.options.highlight&&e.DomUtil.addClass(this.light,"temporary");this.getPane().appendChild(this.light);this.color=this.options.pulseColor;this.offset=this.options.pulseOffset;this.setColor(this.color);this.setPulseOffset(this.offset);this.update()},_setStyle:function(){this.light.setAttribute("style","opacity: 1;");this._light.setAttribute("style","opacity: 1;");this.glow.setAttribute("style","background:-webkit-radial-gradient("+e.DomUtil.hexToRgba(this.color,100).rgba+", "+e.DomUtil.hexToRgba(this.color,0).rgba+" 70%)!important;margin-left:"+this.offset.x+"px;margin-top:"+this.offset.y+"px;");this.flare.setAttribute("style","background:"+e.DomUtil.hexToRgba(this.color,100).rgba+" !important;margin-left:"+this.offset.x+"px;margin-top:"+this.offset.y+"px;");this.update()},_removePulse:function(){this.glow&&this.glow.setAttribute("style","");this.flare&&this.flare.setAttribute("style","");this.light&&(this.light.setAttribute("style","opacity: 0;"),this._light.setAttribute("style","opacity: 0;"))},setColor:function(a){this.color=a;this._setStyle()},setPulseOffset:function(a){this.offset=a;this._setStyle()},enableTemporaryHighlight:function(){this.options.highlight="temporary";e.DomUtil.addClass(this._light,"temporary")},disableTemporaryHighlight:function(a){delete this.options.highlight;e.DomUtil.removeClass(this._light,"temporary")},enablePermanentHighlight:function(){this.options.highlight="permanent";e.DomUtil.addClass(this._light,"permanent")},disablePermanentHighlight:function(a){delete this.options.highlight;e.DomUtil.removeClass(this._light,"permanent")},_initIconOrigin:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=a.icon.createIcon(this._icon),g=!1;f!==this._icon&&(this._icon&&this._removeIcon(),g=!0,a.title&&(f.title=a.title),a.alt&&(f.alt=a.alt));e.DomUtil.addClass(f,d);a.keyboard&&(f.tabIndex="0");this._icon=f;a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var f=a.icon.createShadow(this._shadow),h=!1;f!==this._shadow&&(this._removeShadow(),h=!0);f&&e.DomUtil.addClass(f,d);this._shadow=f;1>a.opacity&&this._updateOpacity();g&&this.getPane().appendChild(this._icon);this._initInteraction();f&&h&&this.getPane("shadowPane").appendChild(this._shadow)}});e.DivIcon=e.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){a=a&&"DIV"===a.tagName?a:q.createElement("div");var d=this.options;if(a.innerHTML=!1!==d.html?d.html:"",d.bgPos)d=e.point(d.bgPos),a.style.backgroundPosition=-d.x+"px "+-d.y+"px";return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});e.divIcon=function(a){return new e.DivIcon(a)};(function(a){e.Icon.Pulse=e.DivIcon.extend({options:{className:"",iconSize:[1,1],color:"red",animate:!0,heartbeat:2},initialize:function(a){e.setOptions(this,a);var d="lpi-"+(new Date).getTime()+"-"+Math.round(1E5*Math.random()),g=["background-color: "+this.options.color],h=["box-shadow: 0 0 35px 20px "+this.options.color,"animation: pulsate "+this.options.heartbeat+"s ease-out","animation-iteration-count: infinite","animation-delay: "+(this.options.heartbeat+.1)+"s"];this.options.animate||(h.push("animation: none"),h.push("box-shadow:none"));g=["."+d+"{"+g.join(";")+";}","."+d+":after{"+h.join(";")+";}"].join("");h=q.createElement("style");h.styleSheet?h.styleSheet.cssText=g:h.appendChild(q.createTextNode(g));q.getElementsByTagName("head")[0].appendChild(h);this.options.className=this.options.className+" leaflet-pulsing-icon "+d;e.DivIcon.prototype.initialize.call(this,a)}});e.icon.pulse=function(a){return new e.Icon.Pulse(a)};e.Marker.Pulse=e.Marker.extend({initialize:function(a,f){f.icon=e.icon.pulse(f);e.Marker.prototype.initialize.call(this,a,f)}});e.marker.pulse=function(a,f){return new e.Marker.Pulse(a,f)}})(u);e.Util.extend(e.DivIcon.prototype,{createIcon:function(a){a=a&&"DIV"===a.tagName?a:q.createElement("div");var d=this.options;return a.innerHTML=!1!==d.html?d.html:"",d.bgPos&&(a.style.backgroundPosition=-d.bgPos.x+"px "+-d.bgPos.y+"px"),this._setIconStyles(a,"icon"),a}});e.DivOverlay=e.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,d){e.setOptions(this,a);this._source=d},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&e.DomUtil.setOpacity(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&e.DomUtil.setOpacity(this._container,1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?(e.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(e.bind(e.DomUtil.remove,e.DomUtil,this._container),200)):e.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=e.latLng(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&e.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&e.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var a=this._contentNode,d="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof d)a.innerHTML=d;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=e.point(this.options.offset),f=this._getAnchor();this._zoomAnimated?e.DomUtil.setPosition(this._container,a.add(f)):d=d.add(a).add(f);a=this._containerBottom=-d.y;d=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=a+"px";this._container.style.left=d+"px"}},_getAnchor:function(){return[0,0]}});e.Popup=e.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){return a.openPopup(this),this},onAdd:function(a){e.DivOverlay.prototype.onAdd.call(this,a);a.fire("popupopen",{popup:this});this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof e.Path||this._source.on("preclick",e.DomEvent.stopPropagation))},onRemove:function(a){e.DivOverlay.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof e.Path||this._source.off("preclick",e.DomEvent.stopPropagation))},getEvents:function(){var a=e.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=e.DomUtil.create("div","leaflet-popup "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var d=this._closeButton=e.DomUtil.create("a","leaflet-popup-close-button",a);d.href="#close";d.innerHTML="\x26#215;";e.DomEvent.on(d,"click",this._onCloseButtonClick,this)}d=this._wrapper=e.DomUtil.create("div","leaflet-popup-content-wrapper",a);this._contentNode=e.DomUtil.create("div","leaflet-popup-content",d);e.DomEvent.disableClickPropagation(d).disableScrollPropagation(this._contentNode).on(d,"contextmenu",e.DomEvent.stopPropagation);this._tipContainer=e.DomUtil.create("div","leaflet-popup-tip-container",a);this._tip=e.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="";d.whiteSpace="nowrap";var f=a.offsetWidth,f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth);d.width=f+1+"px";d.whiteSpace="";d.height="";var f=a.offsetHeight,g=this.options.maxHeight;g&&f>g?(d.height=g+"px",e.DomUtil.addClass(a,"leaflet-popup-scrolled")):e.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);var d=this._getAnchor();e.DomUtil.setPosition(this._container,a.add(d))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,d=parseInt(e.DomUtil.getStyle(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+d,f=this._containerWidth,g=new e.Point(this._containerLeft,-d-this._containerBottom);g._add(e.DomUtil.getPosition(this._container));var g=a.layerPointToContainerPoint(g),h=e.point(this.options.autoPanPadding),k=e.point(this.options.autoPanPaddingTopLeft||h),h=e.point(this.options.autoPanPaddingBottomRight||h),l=a.getSize(),m=0,n=0;g.x+f+h.x>l.x&&(m=g.x+f-l.x+h.x);0>g.x-m-k.x&&(m=g.x-k.x);g.y+d+h.y>l.y&&(n=g.y+d-l.y+h.y);0>g.y-n-k.y&&(n=g.y-k.y);(m||n)&&a.fire("autopanstart").panBy([m,n])}},_onCloseButtonClick:function(a){this._close();e.DomEvent.stop(a)},_getAnchor:function(){return e.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});e.popup=function(a,d){return new e.Popup(a,d)};e.Map.mergeOptions({closePopupOnClick:!0});e.Map.include({openPopup:function(a,d,f){return a instanceof e.Popup||(a=(new e.Popup(f)).setContent(a)),d&&a.setLatLng(d),this.hasLayer(a)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=a,this.addLayer(a))},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&this.removeLayer(a),this}});e.Layer.include({bindPopup:function(a,d){return a instanceof e.Popup?(e.setOptions(a,d),this._popup=a,a._source=this):((!this._popup||d)&&(this._popup=new e.Popup(d,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a,d){if(a instanceof e.Layer||(d=a,a=this),a instanceof e.FeatureGroup)for(var f in this._layers){a=this._layers[f];break}return d||(d=a.getCenter?a.getCenter():a.getLatLng()),this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,d)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(a){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(a)),this},isPopupOpen:function(){return this._popup.isOpen()},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){var d=a.layer||a.target;if(this._popup&&this._map)return e.DomEvent.stop(a),d instanceof e.Path?void this.openPopup(a.layer||a.target,a.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===d?this.closePopup():this.openPopup(d,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});e.Map.mergeOptions({closePopupOnClick:!1});e.Util.extend(e.Popup.prototype,{options:e.Util.extend(e.Popup.prototype.options,{maxWidth:700,minHeight:50,maxHeight:700,closeOnClick:!1,anchor:[.5,1],zoomAnimation:!1,width:0,height:0,title:""}),initialize:function(a,d){if(e.setOptions(this,a),this._source=d,0==a.type){this._anchorOffset=[-.5,-1];this._popupContent=e.DomUtil.create("div","leafletmap-window");this._popupContent.style.width=a.width+4+"px";this._popupContent.style.left="18px";var f=e.DomUtil.create("div","leafletmap-window-title");f.style.width=a.width-6+"px";f.innerHTML=a.title;var g=e.DomUtil.create("div","leafletmap-window-content");g.style.width=a.width-6+"px";g.style.height=a.height-28+"px";this._popupContent.appendChild(f);this._popupContent.appendChild(g)}else this._anchorOffset=[0,0],this._popupContent=e.DomUtil.create("div","leaflet-zoom-animated"),this._popupContent.style.position="absolute",e.DomEvent.disableClickPropagation(this._popupContent).disableScrollPropagation(this._popupContent).on(this._popupContent,"contextmenu",e.DomEvent.stopPropagation)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&this.options.zoomAnimation;this._container||this._initLayout();a._fadeAnimated&&!this.options.type&&e.DomUtil.setOpacity(this._container,0);clearTimeout(this._removeTimeout);"string"==typeof this._container?this.getPane().innerHTML=this._container:this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&!this.options.type&&e.DomUtil.setOpacity(this._container,1);a.fire("popupopen",{popup:this});this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source.on("preclick",e.DomEvent.stopPropagation))},onRemove:function(a,d){a&&a._fadeAnimated?(e.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(e.bind(e.DomUtil.remove,e.DomUtil,this._container),200)):e.DomUtil.remove(this._container);d&&this.fire("removetip",{type:"removetip"});a&&a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source.off("preclick",e.DomEvent.stopPropagation))},setTitle:function(a){this.options.type||(this._popupContent.childNodes[0].innerHTML=a);this._content=this._popupContent;this.update()},setContent:function(a){return this.options.type?(this._popupContent.innerHTML=a,this._container=this._popupContent):this._popupContent.childNodes[1].innerHTML=a,this._content=this._popupContent,this.update(),this},setSize:function(a,d){this.options.width=a;this.options.height=d;this.options.type?(this._popupContent.childNodes[0].style.width=a+"px",this._popupContent.childNodes[0].style.height=d+"px"):(this._popupContent.style.width=a+4+"px",this._popupContent.style.left="18px",this._popupContent.childNodes[0].style.width=a-6+"px",this._popupContent.childNodes[1].style.width=a-6+"px",this._popupContent.childNodes[1].style.height=d-28+"px")},update:function(a){a instanceof Array&&(this.options.autoPanPaddingTopLeft=[a[0].x,a[0].y],this.options.autoPanPaddingBottomRight=[a[1].x,a[1].y]);this._map&&(this._container.style.visibility="hidden",this.options.type||(this._updateContent(),this._updateLayout()),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_close:function(){this._map&&(this._map.closePopup(this),this.fire("tipclick",{type:"tipclick"}))},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="";d.height="";d.whiteSpace="nowrap";var f=a.offsetWidth||this.options.width;f||(f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth));d.width=f+1+"px";this.options.width=f;(f=a.offsetHeight||this.options.height)||(f=Math.min(f,this.options.maxHeight),f=Math.max(f,this.options.minHeight));d.height=f+1+"px";this.options.height=f;d.whiteSpace="";var g=this.options.maxHeight;g&&f>g?(d.height=g+"px",e.DomUtil.addClass(a,"leaflet-popup-scrolled")):e.DomUtil.removeClass(a,"leaflet-popup-scrolled")},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=e.point(this.options.offset),f=this.options.anchor,a=a.subtract([this.options.width*(f[0]+this._anchorOffset[0]),this.options.height*(f[1]+this._anchorOffset[1])]);this._zoomAnimated?e.DomUtil.setPosition(this._container,a):d=d.add(a);a=this._containerBottom=-d.y;d=this._containerLeft=-Math.round(this._container.offsetWidth/2)+d.x;this._container.style.bottom=a+"px";this._container.style.left=d+"px"}},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);if(0!=this.options.type){var d=this.options.anchor;a=a.subtract([this.options.width*(d[0]+this._anchorOffset[0]),this.options.height*(d[1]+this._anchorOffset[1])])}e.DomUtil.setPosition(this._container,a)},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,d=this._container.offsetHeight,f=this._container.offsetWidth,g=new e.Point(this._containerLeft,-d-this._containerBottom||0);this._zoomAnimated&&g._add(e.DomUtil.getPosition(this._container));var g=a.layerPointToContainerPoint(g),h=e.point(this.options.autoPanPadding),k=e.point(this.options.autoPanPaddingTopLeft||h),h=e.point(this.options.autoPanPaddingBottomRight||h),l=a.getSize(),m=0,n=0;g.x+f+h.x>l.x&&(m=g.x+f-l.x+h.x);0>g.x-m-k.x&&(m=g.x-k.x);g.y+d+h.y>l.y&&(n=g.y+d-l.y+h.y);0>g.y-n-k.y&&(n=g.y-k.y);(m||n)&&a.fire("autopanstart").panBy([m,n])}}});e.Map.include({openPopup:function(a,d,f){return a instanceof e.Popup||(a=(new e.Popup(f)).setContent(a)),d&&a.setLatLng(d),this.hasLayer(a)?this:(this._popup&&this._popup.options.autoClose&&(e.stamp(this._popup)!=e.stamp(a)&&this._popup.fire("tipclose",{type:"tipclose"}),this.closePopup()),this._popup=a,this.addLayer(a))}});e.Marker.include({_getPopupAnchor:function(){return this.options.anchor||[0,0]}});e.LayerGroup=e.Layer.extend({initialize:function(a){this._layers={};var d,f;if(a)for(d=0,f=a.length;f>d;d++)this.addLayer(a[d])},addLayer:function(a){var d=this.getLayerId(a);return this._layers[d]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var d,f,e=Array.prototype.slice.call(arguments,1);for(d in this._layers)f=this._layers[d],f[a]&&f[a].apply(f,e);return this},onAdd:function(a){for(var d in this._layers)a.addLayer(this._layers[d])},onRemove:function(a){for(var d in this._layers)a.removeLayer(this._layers[d])},eachLayer:function(a,d){for(var f in this._layers)a.call(d,this._layers[f]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],d;for(d in this._layers)a.push(this._layers[d]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return e.stamp(a)}});e.layerGroup=function(a){return new e.LayerGroup(a)};e.FeatureGroup=e.LayerGroup.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),e.LayerGroup.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),e.LayerGroup.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new e.LatLngBounds,d;for(d in this._layers){var f=this._layers[d];a.extend(f.getBounds?f.getBounds():f.getLatLng())}return a}});e.featureGroup=function(a){return new e.FeatureGroup(a)};e.Renderer=e.Layer.extend({options:{padding:.1},initialize:function(a){e.setOptions(this,a);e.stamp(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&e.DomUtil.addClass(this._container,"leaflet-zoom-animated"));this.getPane().appendChild(this._container);this._update();this.on("update",this._updatePaths,this)},onRemove:function(){e.DomUtil.remove(this._container);this.off("update",this._updatePaths,this)},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,d){var f=this._map.getZoomScale(d,this._zoom),g=e.DomUtil.getPosition(this._container),h=this._map.getSize().multiplyBy(.5+this.options.padding),k=this._map.project(this._center,d),k=this._map.project(a,d).subtract(k),g=h.multiplyBy(-f).add(g).add(h).subtract(k);e.Browser.any3d?e.DomUtil.setTransform(this._container,g,f):e.DomUtil.setPosition(this._container,g)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,d=this._map.getSize(),f=this._map.containerPointToLayerPoint(d.multiplyBy(-a)).round();this._bounds=new e.Bounds(f,f.add(d.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}});e.Map.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this.options.preferCanvas&&e.canvas()||e.svg()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(a){if("overlayPane"===a||a===v)return!1;var d=this._paneRenderers[a];return d===v&&(d=e.SVG&&e.svg({pane:a})||e.Canvas&&e.canvas({pane:a}),this._paneRenderers[a]=d),d}});e.Path=e.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return e.setOptions(this,a),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(e.Browser.touch?10:0)}});e.LineUtil={simplify:function(a,d){if(!d||!a.length)return a.slice();var f=d*d;return a=this._reducePoints(a,f),this._simplifyDP(a,f)},pointToSegmentDistance:function(a,d,f){return Math.sqrt(this._sqClosestPointOnSegment(a,d,f,!0))},closestPointOnSegment:function(a,d,f){return this._sqClosestPointOnSegment(a,d,f)},_simplifyDP:function(a,d){var f=a.length,e=new (typeof Uint8Array!=v+""?Uint8Array:Array)(f);e[0]=e[f-1]=1;this._simplifyDPStep(a,e,d,0,f-1);var h,k=[];for(h=0;f>h;h++)e[h]&&k.push(a[h]);return k},_simplifyDPStep:function(a,d,f,e,h){var g,l,m,n=0;for(l=e+1;h-1>=l;l++)m=this._sqClosestPointOnSegment(a[l],a[e],a[h],!0),m>n&&(g=l,n=m);n>f&&(d[g]=1,this._simplifyDPStep(a,d,f,e,g),this._simplifyDPStep(a,d,f,g,h))},_reducePoints:function(a,d){for(var f=[a[0]],e=1,h=0,k=a.length;k>e;e++)this._sqDist(a[e],a[h])>d&&(f.push(a[e]),h=e);return k-1>h&&f.push(a[k-1]),f},clipSegment:function(a,d,f,e,h){var g,l,m=e?this._lastCode:this._getBitCode(a,f),n=this._getBitCode(d,f);for(this._lastCode=n;;){if(!(m|n))return[a,d];if(m&n)return!1;e=m||n;g=this._getEdgeIntersection(a,d,e,f,h);l=this._getBitCode(g,f);e===m?(a=g,m=l):(d=g,n=l)}},_getEdgeIntersection:function(a,d,f,g,h){var k,l,m=d.x-a.x;d=d.y-a.y;var n=g.min;g=g.max;return 8&f?(k=a.x+m*(g.y-a.y)/d,l=g.y):4&f?(k=a.x+m*(n.y-a.y)/d,l=n.y):2&f?(k=g.x,l=a.y+d*(g.x-a.x)/m):1&f&&(k=n.x,l=a.y+d*(n.x-a.x)/m),new e.Point(k,l,h)},_getBitCode:function(a,d){var f=0;return a.x<d.min.x?f|=1:a.x>d.max.x&&(f|=2),a.y<d.min.y?f|=4:a.y>d.max.y&&(f|=8),f},_sqDist:function(a,d){var f=d.x-a.x,e=d.y-a.y;return f*f+e*e},_sqClosestPointOnSegment:function(a,d,f,g){var h,k=d.x;d=d.y;var l=f.x-k,m=f.y-d,n=l*l+m*m;return 0<n&&(h=((a.x-k)*l+(a.y-d)*m)/n,1<h?(k=f.x,d=f.y):0<h&&(k+=l*h,d+=m*h)),l=a.x-k,m=a.y-d,g?l*l+m*m:new e.Point(k,d)}};e.Polyline=e.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,d){e.setOptions(this,d);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var d,f,g=1/0,h=null,k=e.LineUtil._sqClosestPointOnSegment,l=0,m=this._parts.length;m>l;l++)for(var n=this._parts[l],p=1,t=n.length;t>p;p++){d=n[p-1];f=n[p];var r=k(a,d,f,!0);g>r&&(g=r,h=k(a,d,f))}return h&&(h.distance=Math.sqrt(g)),h},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,d,f,e,h,k,l,m=this._rings[0],n=m.length;if(!n)return null;for(d=a=0;n-1>a;a++)d+=m[a].distanceTo(m[a+1])/2;if(0===d)return this._map.layerPointToLatLng(m[0]);for(e=a=0;n-1>a;a++)if(h=m[a],k=m[a+1],f=h.distanceTo(k),e+=f,e>d)return l=(e-d)/f,this._map.layerPointToLatLng([k.x-l*(k.x-h.x),k.y-l*(k.y-h.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,d){return d=d||this._defaultShape(),a=e.latLng(a),d.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new e.LatLngBounds;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return e.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var d=[],f=e.Polyline._flat(a),g=0,h=a.length;h>g;g++)f?(d[g]=e.latLng(a[g]),this._bounds.extend(d[g])):d[g]=this._convertLatLngs(a[g]);return d},_project:function(){var a=new e.Bounds;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var d=this._clickTolerance(),d=new e.Point(d,d);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(d),a.max._add(d),this._pxBounds=a)},_projectLatlngs:function(a,d,f){var g,h,k=a.length;if(a[0]instanceof e.LatLng){h=[];for(g=0;k>g;g++)h[g]=this._map.latLngToLayerPoint(a[g]),f.extend(h[g]);d.push(h)}else for(g=0;k>g;g++)this._projectLatlngs(a[g],d,f)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);var d,f,g,h,k,l,m,n=this._parts;g=d=0;for(h=this._rings.length;h>d;d++)for(m=this._rings[d],f=0,k=m.length;k-1>f;f++)(l=e.LineUtil.clipSegment(m[f],m[f+1],a,f,!0))&&(n[g]=n[g]||[],n[g].push(l[0]),(l[1]!==m[f+1]||f===k-2)&&(n[g].push(l[1]),g++))}},_simplifyPoints:function(){for(var a=this._parts,d=this.options.smoothFactor,f=0,g=a.length;g>f;f++)a[f]=e.LineUtil.simplify(a[f],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}});e.polyline=function(a,d){return new e.Polyline(a,d)};e.Polyline._flat=function(a){return!e.Util.isArray(a[0])||"object"!=typeof a[0][0]&&"undefined"!=typeof a[0][0]};e.Util.extend(e.Polyline.prototype,{spliceLatLngs:function(){var a=1<this._latlngs.length?this._latlngs:this._latlngs[0],d=[].splice.apply(a,arguments);return this._convertLatLngs(a,!0),this.redraw(),d}});e.Sector=e.Path.extend({_bounds:new e.LatLngBounds,_angle:120,_pixelRadius:0,options:{},initialize:function(a,d,f,g){e.setOptions(this,g);this._position=a;this._radius=d;this._degree=isNaN(f)?90:Math.max(0,Math.min(parseInt(f),360))},getBounds:function(){return this._bounds},setRadius:function(a){this._radius=a;this._reset()},setOrientation:function(a){this._degree=a;this._reset()},setAngle:function(a){this._angle=a;this._reset()},setPosition:function(a){this._position=a;this._reset()},_update:function(){this._map&&this._renderer._updateSector(this)},_updatePath:function(){this._renderer._updatePoly(this)},_getLatLngByOffset:function(a,d,f){a.lng=Number(a.lng);a.lat=Number(a.lat);return new e.LatLng(a.lat+360*Math.asin(Math.round(f)/12756274)/Math.PI,a.lng+360*Math.asin(Math.sin(Math.round(d)/12756274)/Math.cos(a.lat*Math.PI/180))/Math.PI)},_project:function(){var a=this._map,d=this._position,f=this._radius;if(a&&d&&f){var g=a.latLngToLayerPoint(d),h=g.x,k=g.y,f=a.latLngToLayerPoint(this._getLatLngByOffset(d,f,0));this._pixelRadius=f=Math.abs(g.x-f.x);var l=this._angle,m=!1,d=0<=this._degree?this._degree:360+this._degree,n=d-l/2,n=0<=n?n:360+n,p=n/90,g=y1=x2=y2=x3=y3=0;switch(p){case 1:g=h;y1=k-f;m=!0;break;case 2:g=h+f;y1=k;m=!0;break;case 3:g=h;y1=k+f;m=!0;break;case 0:case 4:g=h-f,y1=k,m=!0}if(!m)switch(p=Math.ceil(p),n=0>n?360+n:n,p){case 1:var p=(m=Math.PI*n/180)?Math.abs(f*Math.sin(m)):0,t=m?Math.abs(f*Math.cos(m)):f,g=h-t;y1=k-p;break;case 2:t=(m=Math.PI*(n-90)/180)?Math.abs(f*Math.sin(m)):f;p=m?Math.abs(f*Math.cos(m)):0;g=h+t;y1=k-p;break;case 3:p=(m=Math.PI*(n-180)/180)?Math.abs(f*Math.sin(m)):0;t=m?Math.abs(f*Math.cos(m)):f;g=h+t;y1=k+p;break;default:t=(m=Math.abs(Math.PI*(n-270)/180))?Math.abs(f*Math.sin(m)):0,p=m?Math.abs(f*Math.cos(m)):f,g=h-t,y1=k+p}m=!1;t=n+l;switch(360<t&&(t-=360),p=t/90){case 1:x2=h;y2=k-f;m=!0;break;case 2:x2=h+f;y2=k;m=!0;break;case 3:x2=h;y2=k+f;m=!0;break;case 0:case 4:x2=h-f,y2=k,m=!0}if(!m)switch(Math.ceil(p)){case 1:m=Math.PI*(90-(90-n-l))/180;p=Math.abs(f*Math.sin(m));t=Math.abs(f*Math.cos(m));x2=h-t;y2=k-p;break;case 2:m=Math.PI*(90-(180-n-l))/180;t=Math.abs(f*Math.sin(m));p=Math.abs(f*Math.cos(m));x2=h+t;y2=k-p;break;case 3:m=Math.PI*(90-(270-n-l))/180;p=Math.abs(f*Math.sin(m));t=Math.abs(f*Math.cos(m));x2=h+t;y2=k+p;break;case 5:m=Math.PI*(90-(450-n-l))/180;p=Math.abs(f*Math.sin(m));t=Math.abs(f*Math.cos(m));x2=h-t;y2=k-p;break;default:m=Math.PI*(90-(360-n-l))/180,t=Math.abs(f*Math.sin(m)),p=Math.abs(f*Math.cos(m)),x2=h-t,y2=k+p}m=!1;l=this._distanceByPixel({x:g,y:y1},{x:x2,y:y2});p=d/90;l=f+l/4;switch(p){case 1:x3=h;y3=k-l;topFlag=!0;break;case 2:x3=h+l;y3=k;topFlag=!0;break;case 3:x3=h;y3=k+l;topFlag=!0;break;case 0:case 4:x3=h-l,y3=k,topFlag=!0}if(!m)switch(Math.ceil(p)){case 1:m=Math.PI*d/180;p=Math.abs(l*Math.sin(m));t=Math.abs(l*Math.cos(m));x3=h-t;y3=k-p;break;case 2:m=Math.PI*(d-90)/180;t=Math.abs(l*Math.sin(m));p=Math.abs(l*Math.cos(m));x3=h+t;y3=k-p;break;case 3:m=Math.PI*(d-180)/180;p=Math.abs(l*Math.sin(m));t=Math.abs(l*Math.cos(m));x3=h+t;y3=k+p;break;default:m=Math.PI*(d-270)/180,t=Math.abs(l*Math.sin(m)),p=Math.abs(l*Math.cos(m)),x3=h-t,y3=k+p}h=Math.round(h);k=Math.round(k);g=Math.round(g);y1=Math.round(y1);x2=Math.round(x2);y2=Math.round(y2);x3=Math.round(x3);y3=Math.round(y3);l=Math.max(h,g,x2,x3);n=Math.max(k,y1,y2,y3);d=new e.Point(Math.min(h,g,x2,x3),Math.min(k,y1,y2,y3));l=new e.Point(l,n);d=a.layerPointToLatLng(d);l=a.layerPointToLatLng(l);a=new e.LatLng(Math.min(d.lat,l.lat),Math.min(d.lng,l.lng));d=new e.LatLng(Math.max(d.lat,l.lat),Math.max(d.lng,l.lng));this._bounds=new e.LatLngBounds(a,d);this._parts={x:h,y:k,r:f,x1:g,y1:y1,x2:x2,y2:y2,x3:x3,y3:y3}}},_distanceByPixel:function(a,d){return Math.sqrt(Math.pow(d.x-a.x,2)+Math.pow(d.y-a.y,2))}});e.PolyUtil={};e.PolyUtil.clipPolygon=function(a,d,f){var g,h,k,l,m,n,p,t,r=[1,4,2,8],q=e.LineUtil;h=0;for(n=a.length;n>h;h++)a[h]._code=q._getBitCode(a[h],d);for(l=0;4>l;l++){p=r[l];g=[];h=0;n=a.length;for(k=n-1;n>h;k=h++)m=a[h],k=a[k],m._code&p?k._code&p||(t=q._getEdgeIntersection(k,m,p,d,f),t._code=q._getBitCode(t,d),g.push(t)):(k._code&p&&(t=q._getEdgeIntersection(k,m,p,d,f),t._code=q._getBitCode(t,d),g.push(t)),g.push(m));a=g}return a};e.Polygon=e.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,d,f,e,h,k,l,m,n=this._rings[0],p=n.length;if(!p)return null;a=h=k=l=0;for(d=p-1;p>a;d=a++)f=n[a],d=n[d],e=f.y*d.x-d.y*f.x,k+=(f.x+d.x)*e,l+=(f.y+d.y)*e,h+=3*e;return m=0===h?n[0]:[k/h,l/h],this._map.layerPointToLatLng(m)},_convertLatLngs:function(a){a=e.Polyline.prototype._convertLatLngs.call(this,a);var d=a.length;return 2<=d&&a[0]instanceof e.LatLng&&a[0].equals(a[d-1])&&a.pop(),a},_setLatLngs:function(a){e.Polyline.prototype._setLatLngs.call(this,a);e.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return e.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,d=this.options.weight,d=new e.Point(d,d);if(a=new e.Bounds(a.min.subtract(d),a.max.add(d)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);for(var f=0,g=this._rings.length;g>f;f++)d=e.PolyUtil.clipPolygon(this._rings[f],a,!0),d.length&&this._parts.push(d)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}});e.polygon=function(a,d){return new e.Polygon(a,d)};e.Util.extend(e.Polygon.prototype,{_clipPoints:function(){var a=this._renderer._bounds,d=3*this.options.weight,d=new e.Point(d,d);if(a=new e.Bounds(a.min.subtract(d),a.max.add(d)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(a)){if(this.options.noClip)return void(this._parts=this._rings);for(var f=0,g=this._rings.length;g>f;f++)d=e.PolyUtil.clipPolygon(this._rings[f],a,!0),d.length&&this._parts.push(d)}}});e.Rectangle=e.Polygon.extend({initialize:function(a,d){e.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),d)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=e.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});e.rectangle=function(a,d){return new e.Rectangle(a,d)};e.CircleMarker=e.Path.extend({options:{fill:!0,radius:10},initialize:function(a,d){e.setOptions(this,d);this._latlng=e.latLng(a);this._radius=this.options.radius},setLatLng:function(a){return this._latlng=e.latLng(a),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var d=a&&a.radius||this._radius;return e.Path.prototype.setStyle.call(this,a),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,d=this._radiusY||a,f=this._clickTolerance(),a=[a+f,d+f];this._pxBounds=new e.Bounds(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}});e.circleMarker=function(a,d){return new e.CircleMarker(a,d)};e.Util.extend(e.CircleMarker.prototype,{getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new e.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))}});e.Circle=e.CircleMarker.extend({initialize:function(a,d,f){if("number"==typeof d&&(d=e.extend({},f,{radius:d})),e.setOptions(this,d),this._latlng=e.latLng(a),isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new e.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:e.Path.prototype.setStyle,_project:function(){var a=this._latlng.lng,d=this._latlng.lat,f=this._map,g=f.options.crs;if(g.distance===e.CRS.Earth.distance){var h=Math.PI/180,g=this._mRadius/e.CRS.Earth.R/h,k=f.project([d+g,a]),l=f.project([d-g,a]),l=k.add(l).divideBy(2),m=f.unproject(l).lat,h=Math.acos((Math.cos(g*h)-Math.sin(d*h)*Math.sin(m*h))/(Math.cos(d*h)*Math.cos(m*h)))/h;(isNaN(h)||0===h)&&(h=g/Math.cos(Math.PI/180*d));this._point=l.subtract(f.getPixelOrigin());this._radius=isNaN(h)?0:Math.max(Math.round(l.x-f.project([m,a-h]).x),1);this._radiusY=Math.max(Math.round(l.y-k.y),1)}else a=g.unproject(g.project(this._latlng).subtract([this._mRadius,0])),this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(a).x;this._updateBounds()}});e.circle=function(a,d,f){return new e.Circle(a,d,f)};e.SVG=e.Renderer.extend({getEvents:function(){var a=e.Renderer.prototype.getEvents.call(this);return a.zoomstart=this._onZoomStart,a},_initContainer:function(){this._container=e.SVG.create("svg");this._container.setAttribute("pointer-events","none");this._rootGroup=e.SVG.create("g");this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){e.Renderer.prototype._update.call(this);var a=this._bounds,d=a.getSize(),f=this._container;this._svgSize&&this._svgSize.equals(d)||(this._svgSize=d,f.setAttribute("width",d.x),f.setAttribute("height",d.y));e.DomUtil.setPosition(f,a.min);f.setAttribute("viewBox",[a.min.x,a.min.y,d.x,d.y].join(" "));this.fire("update")}},_initPath:function(a){var d=a._path=e.SVG.create("path");a.options.className&&e.DomUtil.addClass(d,a.options.className);a.options.interactive&&e.DomUtil.addClass(d,"leaflet-interactive");this._updateStyle(a);this._layers[e.stamp(a)]=a},_addPath:function(a){this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){e.DomUtil.remove(a._path);a.removeInteractiveTarget(a._path);delete this._layers[e.stamp(a)]},_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var d=a._path;a=a.options;d&&(a.stroke?(d.setAttribute("stroke",a.color),d.setAttribute("stroke-opacity",a.opacity),d.setAttribute("stroke-width",a.weight),d.setAttribute("stroke-linecap",a.lineCap),d.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?d.setAttribute("stroke-dasharray",a.dashArray):d.removeAttribute("stroke-dasharray"),a.dashOffset?d.setAttribute("stroke-dashoffset",a.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),a.fill?(d.setAttribute("fill",a.fillColor||a.color),d.setAttribute("fill-opacity",a.fillOpacity),d.setAttribute("fill-rule",a.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(a,d){this._setPath(a,e.SVG.pointsToPath(a._parts,d))},_updateCircle:function(a){var d=a._point,f=a._radius,e="a"+f+","+(a._radiusY||f)+" 0 1,0 ",d=a._empty()?"M0 0":"M"+(d.x-f)+","+d.y+e+2*f+",0 "+e+2*-f+",0 ";this._setPath(a,d)},_setPath:function(a,d){a._path.setAttribute("d",d)},_bringToFront:function(a){e.DomUtil.toFront(a._path)},_bringToBack:function(a){e.DomUtil.toBack(a._path)}});e.extend(e.SVG,{create:function(a){return q.createElementNS("http://www.w3.org/2000/svg",a)},pointsToPath:function(a,d){var f,g,h,k,l,m,n="";f=0;for(h=a.length;h>f;f++){l=a[f];g=0;for(k=l.length;k>g;g++)m=l[g],n+=(g?"L":"M")+m.x+" "+m.y;n+=d?e.Browser.svg?"z":"x":""}return n||"M0 0"}});e.Browser.svg=!(!q.createElementNS||!e.SVG.create("svg").createSVGRect);e.svg=function(a){return e.Browser.svg||e.Browser.vml?new e.SVG(a):null};e.Util.extend(e.SVG.prototype,{_initPath:function(a){var d=a._path=e.SVG.create("path");a.options.className&&e.DomUtil.addClass(d,a.options.className);a.options.interactive&&e.DomUtil.addClass(d,"leaflet-interactive");e.DomEvent.on(d,"click dblclick mousedown mouseup contextmenu",function(a){this.fire("click")},this);this._updateStyle(a);this._layers[e.stamp(a)]=a},_fireEvent:function(a,d,f){this._map._fireDOMEvent(d,f||d.type,a)},_updatePoly:function(a,d){this._setPath(a,e.SVG.pointsToPath(a._parts,d,a.options))},_updateSector:function(a){var d=a._parts;this._setPath(a,d?"M "+d.x+" "+d.y+" "+d.x2+" "+d.y2+" C "+d.x2+" "+d.y2+" "+d.x3+" "+d.y3+" "+d.x1+" "+d.y1+" z":"M 0 0 z")}});e.extend(e.SVG,{pointsToPath:function(a,d,f){var g,h,k,l,m,n,p="",t="",r=f.arrow,q=parseInt(f.weight)+3;f=0;for(h=a.length;h>f;f++){l=a[f];g=0;for(k=l.length;k>g;g++)m=l[g],p+=(g?" L":"M")+m.x+" "+m.y,r&&k-1>g&&(n={x:Math.round(2*l[g+1].x-m.x),y:Math.round(2*l[g+1].y-m.y)},t+=this._drawPolylineArrow(l[g+1],n,q));p+=d?e.Browser.svg?"z":"x":""}return p+t||"M0 0"},_drawPolylineArrow:function(a,d,f){var e,h,k,l=Math.sqrt((a.y-d.y)*(a.y-d.y)+(a.x-d.x)*(a.x-d.x));e=parseInt(a.x)+parseInt(1*f*(a.x-d.x+(a.y-d.y)/2)/l);h=parseInt(a.y)+parseInt(1*f*(a.y-d.y-(a.x-d.x)/2)/l);k=parseInt(a.x)+parseInt(1*f*(a.x-d.x-(a.y-d.y)/2)/l);d=parseInt(a.y)+parseInt(1*f*(a.y-d.y+(a.x-d.x)/2)/l);f=Math.round(a.x);a=Math.round(a.y);var m=l="";return e&&(l=" M"+e+" "+h+" L"+f+" "+a,m=" M"+k+" "+d+" L"+f+" "+a),l+m}});e.Browser.vml=!e.Browser.svg&&function(){try{var a=q.createElement("div");a.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';var d=a.firstChild;return d.style.behavior="url(#default#VML)",d&&"object"==typeof d.adj}catch(f){return!1}}();e.SVG.include(e.Browser.vml?{_initContainer:function(){this._container=e.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(e.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var d=a._container=e.SVG.create("shape");e.DomUtil.addClass(d,"leaflet-vml-shape "+(this.options.className||""));d.coordsize="1 1";a._path=e.SVG.create("path");d.appendChild(a._path);this._updateStyle(a)},_addPath:function(a){var d=a._container;this._container.appendChild(d);a.options.interactive&&a.addInteractiveTarget(d)},_removePath:function(a){var d=a._container;e.DomUtil.remove(d);a.removeInteractiveTarget(d)},_updateStyle:function(a){var d=a._stroke,f=a._fill,g=a.options,h=a._container;h.stroked=!!g.stroke;h.filled=!!g.fill;g.stroke?(d||(d=a._stroke=e.SVG.create("stroke")),h.appendChild(d),d.weight=g.weight+"px",d.color=g.color,d.opacity=g.opacity,g.dashArray?d.dashStyle=e.Util.isArray(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=g.lineCap.replace("butt","flat"),d.joinstyle=g.lineJoin):d&&(h.removeChild(d),a._stroke=null);g.fill?(f||(f=a._fill=e.SVG.create("fill")),h.appendChild(f),f.color=g.fillColor||g.color,f.opacity=g.fillOpacity):f&&(h.removeChild(f),a._fill=null)},_updateCircle:function(a){var d=a._point.round(),f=Math.round(a._radius),e=Math.round(a._radiusY||f);this._setPath(a,a._empty()?"M0 0":"AL "+d.x+","+d.y+" "+f+","+e+" 0,23592600")},_setPath:function(a,d){a._path.v=d},_bringToFront:function(a){e.DomUtil.toFront(a._container)},_bringToBack:function(a){e.DomUtil.toBack(a._container)}}:{});e.Browser.vml&&(e.SVG.create=function(){try{return q.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return q.createElement("\x3clvml:"+a+' class\x3d"lvml"\x3e')}}catch(a){return function(a){return q.createElement("\x3c"+a+' xmlns\x3d"urn:schemas-microsoft.com:vml" class\x3d"lvml"\x3e')}}}());e.SVG.include(e.Browser.vml?{_updateSector:function(a){var d=a._parts;this._setPath(a,d?"m "+d.x+" "+d.y+" l "+d.x2+" "+d.y2+" c "+d.x2+" "+d.y2+" "+d.x3+" "+d.y3+" "+d.x1+" "+d.y1+" x e":"m 0,0 x e")}}:{});e.Canvas=e.Renderer.extend({onAdd:function(){e.Renderer.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=this._container=q.createElement("canvas");e.DomEvent.on(a,"mousemove",e.Util.throttle(this._onMouseMove,32,this),this).on(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(a,"mouseout",this._handleMouseOut,this);this._ctx=a.getContext("2d")},_updatePaths:function(){var a;this._redrawBounds=null;for(var d in this._layers)a=this._layers[d],a._update();this._redraw()},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};e.Renderer.prototype._update.call(this);var a=this._bounds,d=this._container,f=a.getSize(),g=e.Browser.retina?2:1;e.DomUtil.setPosition(d,a.min);d.width=g*f.x;d.height=g*f.y;d.style.width=f.x+"px";d.style.height=f.y+"px";e.Browser.retina&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_initPath:function(a){this._updateDashArray(a);this._layers[e.stamp(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var d=a._order,f=d.next,d=d.prev;f?f.prev=d:this._drawLast=d;d?d.next=f:this._drawFirst=f;delete a._order;delete this._layers[e.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var d,f=a.options.dashArray.split(","),e=[];for(d=0;d<f.length;d++)e.push(Number(f[d]));a.options._dashArray=e}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||e.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(a){var d=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new e.Bounds;this._redrawBounds.extend(a._pxBounds.min.subtract([d,d]));this._redrawBounds.extend(a._pxBounds.max.add([d,d]))},_redraw:function(){this._redrawRequest=null;this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var d=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,d.x,d.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,d=this._redrawBounds;if(this._ctx.save(),d)a=d.getSize(),this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,a.x,a.y),this._ctx.clip();this._drawing=!0;for(var f=this._drawFirst;f;f=f.next)a=f.layer,(!d||a._pxBounds&&a._pxBounds.intersects(d))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,d){if(this._drawing){var f,e,h,k,l=a._parts,m=l.length,n=this._ctx;if(m){this._drawnLayers[a._leaflet_id]=a;n.beginPath();n.setLineDash&&n.setLineDash(a.options&&a.options._dashArray||[]);for(f=0;m>f;f++){e=0;for(h=l[f].length;h>e;e++)k=l[f][e],n[e?"lineTo":"moveTo"](k.x,k.y);d&&n.closePath()}this._fillStroke(n,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var d=a._point,f=this._ctx,e=a._radius,h=(a._radiusY||e)/e;this._drawnLayers[a._leaflet_id]=a;1!==h&&(f.save(),f.scale(1,h));f.beginPath();f.arc(d.x,d.y/h,e,0,2*Math.PI,!1);1!==h&&f.restore();this._fillStroke(f,a)}},_fillStroke:function(a,d){var f=d.options;f.fill&&(a.globalAlpha=f.fillOpacity,a.fillStyle=f.fillColor||f.color,a.fill(f.fillRule||"evenodd"));f.stroke&&0!==f.weight&&(a.globalAlpha=f.opacity,a.lineWidth=f.weight,a.strokeStyle=f.color,a.lineCap=f.lineCap,a.lineJoin=f.lineJoin,a.stroke())},_onClick:function(a){for(var d,f,g=this._map.mouseEventToLayerPoint(a),h=this._drawFirst;h;h=h.next)d=h.layer,d.options.interactive&&d._containsPoint(g)&&!this._map._draggableMoved(d)&&(f=d);f&&(e.DomEvent._fakeStop(a),this._fireEvent([f],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var d=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,d)}},_handleMouseOut:function(a){var d=this._hoveredLayer;d&&(e.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,d){for(var f,g,h=this._drawFirst;h;h=h.next)f=h.layer,f.options.interactive&&f._containsPoint(d)&&(g=f);g!==this._hoveredLayer&&(this._handleMouseOut(a),g&&(e.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([g],a,"mouseover"),this._hoveredLayer=g));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,d,f){this._map._fireDOMEvent(d,f||d.type,a)},_bringToFront:function(a){var d=a._order,f=d.next,e=d.prev;f&&(f.prev=e,e?e.next=f:f&&(this._drawFirst=f),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(a))},_bringToBack:function(a){var d=a._order,f=d.next,e=d.prev;e&&(e.next=f,f?f.prev=e:e&&(this._drawLast=e),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(a))}});e.Browser.canvas=!!q.createElement("canvas").getContext;e.canvas=function(a){return e.Browser.canvas?new e.Canvas(a):null};e.Polyline.prototype._containsPoint=function(a,d){var f,g,h,k,l,m,n=this._clickTolerance();if(!this._pxBounds.contains(a))return!1;f=0;for(k=this._parts.length;k>f;f++)for(m=this._parts[f],g=0,l=m.length,h=l-1;l>g;h=g++)if((d||0!==g)&&e.LineUtil.pointToSegmentDistance(a,m[h],m[g])<=n)return!0;return!1};e.Polygon.prototype._containsPoint=function(a){var d,f,g,h,k,l,m,n=!1;if(!this._pxBounds.contains(a))return!1;h=0;for(l=this._parts.length;l>h;h++)for(d=this._parts[h],k=0,m=d.length,g=m-1;m>k;g=k++)f=d[k],g=d[g],f.y>a.y!=g.y>a.y&&a.x<(g.x-f.x)*(a.y-f.y)/(g.y-f.y)+f.x&&(n=!n);return n||e.Polyline.prototype._containsPoint.call(this,a,!0)};e.CircleMarker.prototype._containsPoint=function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()};e.Util.extend(e.Canvas.prototype,{_updateCircle:function(a){if(!a._empty()){var d=a._point,f=this._ctx,e=a._radius,h=(a._radiusY||e)/e;1!==h&&(f.save(),f.scale(1,h));f.beginPath();f.arc(d.x,d.y/h,e,0,2*Math.PI,!1);1!==h&&f.restore();this._fillStroke(f,a)}},_handleMouseHover:function(a,d){var f,g;if(!this._hoveredLayer)for(f in this._drawnLayers)if(g=this._drawnLayers[f],g.options.interactive&&g._containsPoint(d)){e.DomUtil.addClass(this._container,"leaflet-interactive");this._fireEvent([g],a,"mouseover");this._hoveredLayer=g;break}this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)}});e.DomEvent={on:function(a,d,f,g){if("object"==typeof d)for(var h in d)this._on(a,h,d[h],f);else{d=e.Util.splitWords(d);h=0;for(var k=d.length;k>h;h++)this._on(a,d[h],f,g)}return this},off:function(a,d,f,g){if("object"==typeof d)for(var h in d)this._off(a,h,d[h],f);else{d=e.Util.splitWords(d);h=0;for(var k=d.length;k>h;h++)this._off(a,d[h],f,g)}return this},_on:function(a,d,f,g){var h=d+e.stamp(f)+(g?"_"+e.stamp(g):"");if(a._leaflet_events&&a._leaflet_events[h])return this;var k=function(d){return f.call(g||a,d||u.event)},l=k;return e.Browser.pointer&&0===d.indexOf("touch")?this.addPointerListener(a,d,k,h):e.Browser.touch&&"dblclick"===d&&this.addDoubleTapListener?this.addDoubleTapListener(a,k,h):"addEventListener"in a?"mousewheel"===d?a.addEventListener("onwheel"in a?"wheel":"mousewheel",k,!1):"mouseenter"===d||"mouseleave"===d?(k=function(d){d=d||u.event;e.DomEvent._isExternalTarget(a,d)&&l(d)},a.addEventListener("mouseenter"===d?"mouseover":"mouseout",k,!1)):("click"===d&&e.Browser.android&&(k=function(a){return e.DomEvent._filterClick(a,l)}),a.addEventListener(d,k,!1)):"attachEvent"in a&&a.attachEvent("on"+d,k),a._leaflet_events=a._leaflet_events||{},a._leaflet_events[h]=k,this},_off:function(a,d,f,g){f=d+e.stamp(f)+(g?"_"+e.stamp(g):"");return(g=a._leaflet_events&&a._leaflet_events[f])?(e.Browser.pointer&&0===d.indexOf("touch")?this.removePointerListener(a,d,f):e.Browser.touch&&"dblclick"===d&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,f):"removeEventListener"in a?"mousewheel"===d?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",g,!1):a.removeEventListener("mouseenter"===d?"mouseover":"mouseleave"===d?"mouseout":d,g,!1):"detachEvent"in a&&a.detachEvent("on"+d,g),a._leaflet_events[f]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,e.DomEvent._skipped(a),this},disableScrollPropagation:function(a){return e.DomEvent.on(a,"mousewheel",e.DomEvent.stopPropagation)},disableClickPropagation:function(a){var d=e.DomEvent.stopPropagation;return e.DomEvent.on(a,e.Draggable.START.join(" "),d),e.DomEvent.on(a,{click:e.DomEvent._fakeStop,dblclick:d})},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return e.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,d){if(!d)return new e.Point(a.clientX,a.clientY);var f=d.getBoundingClientRect();return new e.Point(a.clientX-f.left-d.clientLeft,a.clientY-f.top-d.clientTop)},_wheelPxFactor:e.Browser.win&&e.Browser.chrome?2:e.Browser.gecko?u.devicePixelRatio:1,getWheelDelta:function(a){return e.Browser.edge?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/e.DomEvent._wheelPxFactor:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?a.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(a){e.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var d=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,d},_isExternalTarget:function(a,d){var f=d.relatedTarget;if(!f)return!0;try{for(;f&&f!==a;)f=f.parentNode}catch(g){return!1}return f!==a},_filterClick:function(a,d){var f=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,g=e.DomEvent._lastClick&&f-e.DomEvent._lastClick;return g&&100<g&&500>g||a.target._simulatedClick&&!a._simulated?void e.DomEvent.stop(a):(e.DomEvent._lastClick=f,void d(a))}};e.DomEvent.addListener=e.DomEvent.on;e.DomEvent.removeListener=e.DomEvent.off;e.Draggable=e.Evented.extend({options:{clickTolerance:3},statics:{START:e.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,d,f){this._element=a;this._dragStartTarget=d||a;this._preventOutline=f},enable:function(){this._enabled||(e.DomEvent.on(this._dragStartTarget,e.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(e.Draggable._dragging===this&&this.finishDrag(),e.DomEvent.off(this._dragStartTarget,e.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!(e.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||e.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(e.Draggable._dragging=this,this._preventOutline&&e.DomUtil.preventOutline(this._element),e.DomUtil.disableImageDrag(),e.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var d=a.touches?a.touches[0]:a;this._startPoint=new e.Point(d.clientX,d.clientY);e.DomEvent.on(q,e.Draggable.MOVE[a.type],this._onMove,this).on(q,e.Draggable.END[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled){if(a.touches&&1<a.touches.length)return void(this._moved=!0);var d=a.touches&&1===a.touches.length?a.touches[0]:a,d=(new e.Point(d.clientX,d.clientY)).subtract(this._startPoint);(d.x||d.y)&&(Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(e.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=e.DomUtil.getPosition(this._element).subtract(d),e.DomUtil.addClass(q.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,u.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),e.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,e.Util.cancelAnimFrame(this._animRequest),this._lastEvent=a,this._animRequest=e.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);e.DomUtil.setPosition(this._element,this._newPos);this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){e.DomUtil.removeClass(q.body,"leaflet-dragging");this._lastTarget&&(e.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in e.Draggable.MOVE)e.DomEvent.off(q,e.Draggable.MOVE[a],this._onMove,this).off(q,e.Draggable.END[a],this._onUp,this);e.DomUtil.enableImageDrag();e.DomUtil.enableTextSelection();this._moved&&this._moving&&(e.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;e.Draggable._dragging=!1}});e.Handler=e.Class.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});e.Map.mergeOptions({dragging:!0,inertia:!e.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});e.Map.Drag=e.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new e.Draggable(a._mapPane,a._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}e.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag");this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){e.DomUtil.removeClass(this._map._container,"leaflet-grab");e.DomUtil.removeClass(this._map._container,"leaflet-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var a=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=e.latLngBounds(this._map.options.maxBounds);this._offsetLimit=e.bounds(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f);this._times.push(d);50<d-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,d){return a-(a-d)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;a.x<d.min.x&&(a.x=this._viscousLimit(a.x,d.min.x));a.y<d.min.y&&(a.y=this._viscousLimit(a.y,d.min.y));a.x>d.max.x&&(a.x=this._viscousLimit(a.x,d.max.x));a.y>d.max.y&&(a.y=this._viscousLimit(a.y,d.max.y));this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,d=Math.round(a/2),f=this._initialWorldOffset,e=this._draggable._newPos.x,h=(e-d+f)%a+d-f,a=(e+d+f)%a-d-f,f=Math.abs(h+f)<Math.abs(a+f)?h:a;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=f},_onDragEnd:function(a){var d=this._map,f=d.options,g=!f.inertia||2>this._times.length;if(d.fire("dragend",a),g)d.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var h=f.easeLinearity,g=a.multiplyBy(h/((this._lastTime-this._times[0])/1E3)),k=g.distanceTo([0,0]);a=Math.min(f.inertiaMaxSpeed,k);var g=g.multiplyBy(a/k),l=a/(f.inertiaDeceleration*h),m=g.multiplyBy(-l/2).round();m.x||m.y?(m=d._limitOffset(m,d.options.maxBounds),e.Util.requestAnimFrame(function(){d.panBy(m,{duration:l,easeLinearity:h,noMoveStart:!0,animate:!0})})):d.fire("moveend")}}});e.Map.addInitHook("addHandler","dragging",e.Map.Drag);e.DomEvent._on=function(a,d,f,g){var h=d+e.stamp(f)+(g?"_"+e.stamp(g):"");if(a._leaflet_events&&a._leaflet_events[h])return this;var k=function(d){return f.call(g||a,d||u.event)},l=k;return e.Browser.pointer&&0===d.indexOf("touch")?this.addPointerListener(a,d,k,h):e.Browser.touch&&"dblclick"===d&&this.addDoubleTapListener?this.addDoubleTapListener(a,k,h):"addEventListener"in a?"mousewheel"===d?(a.addEventListener("DOMMouseScroll",k,!1),a.addEventListener(d,k,!1)):"mouseenter"===d||"mouseleave"===d?(k=function(d){d=d||u.event;e.DomEvent._isExternalTarget(a,d)&&l(d)},a.addEventListener("mouseenter"===d?"mouseover":"mouseout",k,!1)):("click"===d&&e.Browser.android&&(k=function(a){return e.DomEvent._filterClick(a,l)}),a.addEventListener(d,k,!1)):"attachEvent"in a&&a.attachEvent("on"+d,k),a._leaflet_events=a._leaflet_events||{},a._leaflet_events[h]=k,this};e.DomEvent._off=function(a,d,f,g){f=d+e.stamp(f)+(g?"_"+e.stamp(g):"");return(g=a._leaflet_events&&a._leaflet_events[f])?(e.Browser.pointer&&0===d.indexOf("touch")?this.removePointerListener(a,d,f):e.Browser.touch&&"dblclick"===d&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,f):"removeEventListener"in a?"mousewheel"===d?(a.removeEventListener("DOMMouseScroll",g,!1),a.removeEventListener(d,g,!1)):a.removeEventListener("mouseenter"===d?"mouseover":"mouseleave"===d?"mouseout":d,g,!1):"detachEvent"in a&&a.detachEvent("on"+d,g),a._leaflet_events[f]=null,this):this};e.DomEvent.disableScrollPropagation=function(a){return e.DomEvent.on(a,"mousewheel MozMousePixelScroll",e.DomEvent.stopPropagation)};e.DomEvent.getWheelDelta=function(a){var d=0;return a.wheelDelta&&(d=a.wheelDelta/120),a.detail&&(d=-a.detail/3),d};e.Util.extend(e.Draggable.prototype,{initialize:function(a,d,f){this._element=a;this._dragStartTarget=d||a;this._preventOutline=f;e.DomUtil.disableImageDrag();e.DomUtil.disableTextSelection()},_onDown:function(a){if(this._moved=!1,!(e.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||e.Draggable._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches)&&this._enabled&&(e.Draggable._dragging=!0,this._preventOutline&&e.DomUtil.preventOutline(this._element),!this._moving)){this.fire("down");var d=a.touches?a.touches[0]:a;this._startPoint=new e.Point(d.clientX,d.clientY);this._startPos=this._newPos=e.DomUtil.getPosition(this._element);e.DomEvent.on(q,e.Draggable.MOVE[a.type],this._onMove,this).on(q,e.Draggable.END[a.type],this._onUp,this)}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);e.DomUtil.setPosition(this._element,this._newPos,this._element.rotate);this.fire("drag",a)},_onUp:function(){e.DomUtil.removeClass(q.body,"leaflet-dragging");this._lastTarget&&(e.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in e.Draggable.MOVE)e.DomEvent.off(q,e.Draggable.MOVE[a],this._onMove,this).off(q,e.Draggable.END[a],this._onUp,this);this._moved&&this._moving&&(e.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;e.Draggable._dragging=!1}});e.Util.extend(e.Map.Drag.prototype,{_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f);this._times.push(d);50<d-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a).fire("change")},_onDragEnd:function(a){var d=this._map,f=d.options,g=!f.inertia||2>this._times.length;if(d.fire("dragend",a),g)d.fire("moveend").fire("changed");else{a=this._lastPos.subtract(this._positions[0]);var h=f.easeLinearity,g=a.multiplyBy(h/((this._lastTime-this._times[0])/1E3)),k=g.distanceTo([0,0]);a=Math.min(f.inertiaMaxSpeed,k);var g=g.multiplyBy(a/k),l=a/(f.inertiaDeceleration*h),m=g.multiplyBy(-l/2).round();m.x||m.y?(m=d._limitOffset(m,d.options.maxBounds),e.Util.requestAnimFrame(function(){d.panBy(m,{duration:l,easeLinearity:h,noMoveStart:!0,animate:!0})})):d.fire("moveend").fire("changed")}}});e.Map.mergeOptions({doubleClickZoom:!0});e.Map.DoubleClickZoom=e.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var d=this._map,f=d.getZoom(),e=d.options.zoomDelta,f=a.originalEvent.shiftKey?f-e:f+e;"center"===d.options.doubleClickZoom?d.setZoom(f):d.setZoomAround(a.containerPoint,f)}});e.Map.addInitHook("addHandler","doubleClickZoom",e.Map.DoubleClickZoom);e.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});e.Map.ScrollWheelZoom=e.Handler.extend({addHooks:function(){e.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){e.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var d=e.DomEvent.getWheelDelta(a),f=this._map.options.wheelDebounceTime;this._delta+=d;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);d=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(e.bind(this._performZoom,this),d);e.DomEvent.stop(a)},_performZoom:function(){var a=this._map,d=a.getZoom(),f=this._map.options.zoomSnap||0;a._stop();var e=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,f=f?Math.ceil(e/f)*f:e,f=a._limitZoom(d+(0<this._delta?f:-f))-d;this._delta=0;this._startTime=null;f&&("center"===a.options.scrollWheelZoom?a.setZoom(d+f):a.setZoomAround(this._lastMousePos,d+f))}});e.Map.addInitHook("addHandler","scrollWheelZoom",e.Map.ScrollWheelZoom);e.Util.extend(e.Map.ScrollWheelZoom.prototype,{addHooks:function(){e.DomEvent.on(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:e.DomEvent.preventDefault},this);this._delta=0},removeHooks:function(){e.DomEvent.off(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:e.DomEvent.preventDefault},this)},_performZoom:function(){var a=this._map,d=this._delta,f=a.getZoom();a.stop();d=0<d?Math.ceil(d):Math.floor(d);d=Math.max(Math.min(d,4),-4);d=a._limitZoom(f+d)-f;this._delta=0;this._startTime=null;d&&("center"===a.options.scrollWheelZoom?a.setZoom(f+d):a.setZoomAround(this._lastMousePos,f+d))}});e.extend(e.DomEvent,{_touchstart:e.Browser.msPointer?"MSPointerDown":e.Browser.pointer?"pointerdown":"touchstart",_touchend:e.Browser.msPointer?"MSPointerUp":e.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,d,f){function g(a){var d;if(d=e.Browser.pointer?e.DomEvent._pointersCount:a.touches.length,!(1<d)){d=Date.now();var f=d-(k||d);l=a.touches?a.touches[0]:a;m=0<f&&n>=f;k=d}}function h(){if(m&&!l.cancelBubble){if(e.Browser.pointer){var a,f,g={};for(f in l)a=l[f],g[f]=a&&a.bind?a.bind(l):a;l=g}l.type="dblclick";d(l);k=null}}var k,l,m=!1,n=250,p=this._touchstart,t=this._touchend;return a["_leaflet_"+p+f]=g,a["_leaflet_"+t+f]=h,a["_leaflet_dblclick"+f]=d,a.addEventListener(p,g,!1),a.addEventListener(t,h,!1),e.Browser.edge||a.addEventListener("dblclick",d,!1),this},removeDoubleTapListener:function(a,d){var f=a["_leaflet_"+this._touchend+d],g=a["_leaflet_dblclick"+d];return a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+d],!1),a.removeEventListener(this._touchend,f,!1),e.Browser.edge||a.removeEventListener("dblclick",g,!1),this}});e.extend(e.DomEvent,{POINTER_DOWN:e.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:e.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:e.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:e.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(a,d,f,e){return"touchstart"===d?this._addPointerStart(a,f,e):"touchmove"===d?this._addPointerMove(a,f,e):"touchend"===d&&this._addPointerEnd(a,f,e),this},removePointerListener:function(a,d,f){f=a["_leaflet_"+d+f];return"touchstart"===d?a.removeEventListener(this.POINTER_DOWN,f,!1):"touchmove"===d?a.removeEventListener(this.POINTER_MOVE,f,!1):"touchend"===d&&(a.removeEventListener(this.POINTER_UP,f,!1),a.removeEventListener(this.POINTER_CANCEL,f,!1)),this},_addPointerStart:function(a,d,f){var g=e.bind(function(a){if("mouse"!==a.pointerType&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE){if(!(0>this.TAG_WHITE_LIST.indexOf(a.target.tagName)))return;e.DomEvent.preventDefault(a)}this._handlePointer(a,d)},this);(a["_leaflet_touchstart"+f]=g,a.addEventListener(this.POINTER_DOWN,g,!1),this._pointerDocListener)||(a=e.bind(this._globalPointerUp,this),q.documentElement.addEventListener(this.POINTER_DOWN,e.bind(this._globalPointerDown,this),!0),q.documentElement.addEventListener(this.POINTER_MOVE,e.bind(this._globalPointerMove,this),!0),q.documentElement.addEventListener(this.POINTER_UP,a,!0),q.documentElement.addEventListener(this.POINTER_CANCEL,a,!0),this._pointerDocListener=!0)},_globalPointerDown:function(a){this._pointers[a.pointerId]=a;this._pointersCount++},_globalPointerMove:function(a){this._pointers[a.pointerId]&&(this._pointers[a.pointerId]=a)},_globalPointerUp:function(a){delete this._pointers[a.pointerId];this._pointersCount--},_handlePointer:function(a,d){a.touches=[];for(var f in this._pointers)a.touches.push(this._pointers[f]);a.changedTouches=[a];d(a)},_addPointerMove:function(a,d,f){var g=e.bind(function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&this._handlePointer(a,d)},this);a["_leaflet_touchmove"+f]=g;a.addEventListener(this.POINTER_MOVE,g,!1)},_addPointerEnd:function(a,d,f){var g=e.bind(function(a){this._handlePointer(a,d)},this);a["_leaflet_touchend"+f]=g;a.addEventListener(this.POINTER_UP,g,!1);a.addEventListener(this.POINTER_CANCEL,g,!1)}});e.Map.mergeOptions({touchZoom:e.Browser.touch&&!e.Browser.android23,bounceAtZoomLimits:!0});e.Map.TouchZoom=e.Handler.extend({addHooks:function(){e.DomUtil.addClass(this._map._container,"leaflet-touch-zoom");e.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){e.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom");e.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var d=this._map;if(a.touches&&2===a.touches.length&&!d._animatingZoom&&!this._zooming){var f=d.mouseEventToContainerPoint(a.touches[0]),g=d.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=d.getSize()._divideBy(2);this._startLatLng=d.containerPointToLatLng(this._centerPoint);"center"!==d.options.touchZoom&&(this._pinchStartLatLng=d.containerPointToLatLng(f.add(g)._divideBy(2)));this._startDist=f.distanceTo(g);this._startZoom=d.getZoom();this._moved=!1;this._zooming=!0;d._stop();e.DomEvent.on(q,"touchmove",this._onTouchMove,this).on(q,"touchend",this._onTouchEnd,this);e.DomEvent.preventDefault(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var d=this._map,f=d.mouseEventToContainerPoint(a.touches[0]),g=d.mouseEventToContainerPoint(a.touches[1]),h=f.distanceTo(g)/this._startDist;if(this._zoom=d.getScaleZoom(h,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&1>h||this._zoom>d.getMaxZoom()&&1<h)&&(this._zoom=d._limitZoom(this._zoom)),"center"===d.options.touchZoom){if(this._center=this._startLatLng,1===h)return}else{f=f._add(g)._divideBy(2)._subtract(this._centerPoint);if(1===h&&0===f.x&&0===f.y)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(f),this._zoom)}this._moved||(d._moveStart(!0),this._moved=!0);e.Util.cancelAnimFrame(this._animRequest);d=e.bind(d._move,d,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=e.Util.requestAnimFrame(d,this,!0);e.DomEvent.preventDefault(a)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,e.Util.cancelAnimFrame(this._animRequest),e.DomEvent.off(q,"touchmove",this._onTouchMove).off(q,"touchend",this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}});e.Map.addInitHook("addHandler","touchZoom",e.Map.TouchZoom);e.Map.mergeOptions({tap:!0,tapTolerance:15});e.Map.Tap=e.Handler.extend({addHooks:function(){e.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){e.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(e.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var d=a.touches[0];a=d.target;this._startPos=this._newPos=new e.Point(d.clientX,d.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&e.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(e.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",d))},this),1E3);this._simulateEvent("mousedown",d);e.DomEvent.on(q,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),e.DomEvent.off(q,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&a&&a.changedTouches){a=a.changedTouches[0];var d=a.target;d&&d.tagName&&"a"===d.tagName.toLowerCase()&&e.DomUtil.removeClass(d,"leaflet-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new e.Point(a.clientX,a.clientY);this._simulateEvent("mousemove",a)},_simulateEvent:function(a,d){var f=q.createEvent("MouseEvents");f._simulated=!0;d.target._simulatedClick=!0;f.initMouseEvent(a,!0,!0,u,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);d.target.dispatchEvent(f)}});e.Browser.touch&&!e.Browser.pointer&&e.Map.addInitHook("addHandler","tap",e.Map.Tap);e.Map.mergeOptions({boxZoom:!0});e.Map.BoxZoom=e.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane},addHooks:function(){e.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){e.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(a){return!a.shiftKey||1!==a.which&&1!==a.button?!1:(this._resetState(),e.DomUtil.disableTextSelection(),e.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(a),void e.DomEvent.on(q,{contextmenu:e.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=e.DomUtil.create("div","leaflet-zoom-box",this._container),e.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);a=new e.Bounds(this._point,this._startPoint);var d=a.getSize();e.DomUtil.setPosition(this._box,a.min);this._box.style.width=d.x+"px";this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(e.DomUtil.remove(this._box),e.DomUtil.removeClass(this._container,"leaflet-crosshair"));e.DomUtil.enableTextSelection();e.DomUtil.enableImageDrag();e.DomEvent.off(q,{contextmenu:e.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){1!==a.which&&1!==a.button||(this._finish(),!this._moved)||(setTimeout(e.bind(this._resetState,this),0),a=new e.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});e.Map.addInitHook("addHandler","boxZoom",e.Map.BoxZoom);e.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80});e.Map.Keyboard=e.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");e.DomEvent.on(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();e.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=q.body,d=q.documentElement,f=a.scrollTop||d.scrollTop,a=a.scrollLeft||d.scrollLeft;this._map._container.focus();u.scrollTo(a,f)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var d,f,e=this._panKeys={},h=this.keyCodes;d=0;for(f=h.left.length;f>d;d++)e[h.left[d]]=[-1*a,0];d=0;for(f=h.right.length;f>d;d++)e[h.right[d]]=[a,0];d=0;for(f=h.down.length;f>d;d++)e[h.down[d]]=[0,a];d=0;for(f=h.up.length;f>d;d++)e[h.up[d]]=[0,-1*a]},_setZoomDelta:function(a){var d,e,g=this._zoomKeys={},h=this.keyCodes;d=0;for(e=h.zoomIn.length;e>d;d++)g[h.zoomIn[d]]=a;d=0;for(e=h.zoomOut.length;e>d;d++)g[h.zoomOut[d]]=-a},_addHooks:function(){e.DomEvent.on(q,"keydown",this._onKeyDown,this)},_removeHooks:function(){e.DomEvent.off(q,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d;d=a.keyCode;var f=this._map;if(d in this._panKeys){if(f._panAnim&&f._panAnim._inProgress)return;d=this._panKeys[d];a.shiftKey&&(d=e.point(d).multiplyBy(3));f.panBy(d);f.options.maxBounds&&f.panInsideBounds(f.options.maxBounds)}else if(d in this._zoomKeys)f.setZoom(f.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[d]);else{if(27!==d)return;f.closePopup()}e.DomEvent.stop(a)}}});e.Map.addInitHook("addHandler","keyboard",e.Map.Keyboard);e.Util.extend(e.Map.Keyboard.prototype,{keyCodes:e.Util.extend(e.Map.Keyboard.prototype.keyCodes,{left:[37,36,65],right:[39,35,68],down:[40,34,83],up:[38,33,87]})});e.Handler.MarkerDrag=e.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new e.Draggable(a,a,!0));this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();e.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&e.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var d=this._marker,f=d._shadow,g=e.DomUtil.getPosition(d._icon),h=d._map.layerPointToLatLng(g);f&&e.DomUtil.setPosition(f,g);d._latlng=h;a.latlng=h;a.oldLatLng=this._oldLatLng;d.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}});e.Util.extend(e.Handler.MarkerDrag.prototype,{_ischangeOffset:!1,addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new e.Draggable(a,a,!0),this._draggable._updatePosition=function(){var a=this._lastEvent;this.fire("predrag",a);a=a.touches?a.touches[0]:a;this.fire("drag",{offset:this._startPoint.subtract(new e.Point(a.clientX,a.clientY))});this._startPoint=new e.Point(a.clientX,a.clientY)});this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();e.DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&e.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart");var a=this._marker.options,d=this._marker.getElement(),f=this._marker.dragging;if(a.raiseOnDrag&&!f._ischangeOffset){f._ischangeOffset=!0;var g=a.icon.options.iconSize,h=a.angleOffsetX,k=parseInt(g[0]);null==a.angleOffsetX&&(h=k/2);h=parseInt(d.style.marginLeft)+h-5.5;g=parseInt(d.style.marginTop)+(g[1]-11)+5.5;k=e.DomUtil.create("div","");k.style.cssText="position:absolute;background:url("+a.raiseUrl+") ;width:11px;height:11px;overflow: hidden;margin-top:"+g+"px;margin-left:"+h+"px";e.Browser.ie?(k.style.transform=d.style.transform,k.style.top=d.style.top,k.style.left=d.style.left,k.style.position="absolute"):k.style.transform=d.style.transform;f._bottomEle=k;d.parentNode.appendChild(k);d.style.marginTop=parseInt(d.style.marginTop)-25+"px"}},_onDrag:function(a){this._transformPoints(a.offset,a);this._marker.fire("move",a).fire("drag",a)},_transformPoints:function(a,d){var f=this._marker;if(f._latlng){var g=f._map.containerPointToLatLng(f._map.latLngToContainerPoint(f._latlng)._subtract(a));f._latlng=g;d.latlng=g;f.setLatLng(g)}f=this._marker.getElement();g=this._marker.dragging;g._bottomEle&&(e.Browser.ie?(g._bottomEle.style.top=f.style.top,g._bottomEle.style.left=f.style.left):g._bottomEle.style.transform=f.style.transform)},_onDragEnd:function(a){a.latlng=this._marker._latlng;this._marker.fire("moveend").fire("dragend",a);a=this._marker.getElement();var d=this._marker.dragging;if(a){d._ischangeOffset&&(d._ischangeOffset=!1,a.style.marginTop=parseInt(a.style.marginTop)+25+"px");var e=d._bottomEle;e&&(a.parentNode.removeChild(e),d._bottomEle=null)}}});e.Handler.GroundImageDrag=e.Handler.MarkerDrag.extend({_transformPoints:function(a,d){var f=this._marker;if(f._latlng){var g=f._map.containerPointToLatLng(f._map.latLngToContainerPoint(f._latlng)._subtract(a));f._latlng=g;d.latlng=g;var h=f._bounds;h._northEast=f._map.containerPointToLatLng(f._map.latLngToContainerPoint(h._northEast)._subtract(a));h._southWest=f._map.containerPointToLatLng(f._map.latLngToContainerPoint(h._southWest)._subtract(a));f.setLatLng(g)}f=this._marker.getElement();g=this._marker.dragging;g._bottomEle&&(e.Browser.ie?(g._bottomEle.style.top=f.style.top,g._bottomEle.style.left=f.style.left):g._bottomEle.style.transform=f.style.transform)}});e.Browser.svg?e.Path.include({_resetTransform:function(){this._renderer._rootGroup.setAttributeNS(null,"transform","")},_applyTransform:function(a){this._renderer._rootGroup.setAttributeNS(null,"transform","matrix("+a.join(" ")+")")}}):e.Path.include({_resetTransform:function(){this._skew&&(this._skew.on=!1,this._renderer._rootGroup.removeChild(this._skew),this._skew=null)},_applyTransform:function(a){var d=this._skew;d||(d=this._createElement("skew"),this._renderer._rootGroup.appendChild(d),d.style.behavior="url(#default#VML)",this._skew=d);var e=a[0].toFixed(8)+" "+a[1].toFixed(8)+" "+a[2].toFixed(8)+" "+a[3].toFixed(8)+" 0 0";a=Math.floor(a[4]).toFixed()+", "+Math.floor(a[5]).toFixed();var g=this._renderer._rootGroup.style,h=parseFloat(g.left),k=parseFloat(g.top),l=parseFloat(g.width),g=parseFloat(g.height);isNaN(h)&&(h=0);isNaN(k)&&(k=0);!isNaN(l)&&l||(l=1);!isNaN(g)&&g||(g=1);h=(-h/l-.5).toFixed(8)+" "+(-k/g-.5).toFixed(8);d.on="f";d.matrix=e;d.origin=h;d.offset=a;d.on=!0}});e.Path.include({_onMouseClick:function(a){this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(a)}});e.Handler.PathDrag=e.Handler.extend({initialize:function(a){this._Object=a},addHooks:function(){var a=this,d=a._Object._path;a._draggable||(a._draggable=new e.Draggable(d,d,!0),a._draggable._onDown=function(d){if(!(a._Object&&a._Object._map&&1==a._Object._map._toolOpened||(this._moved=!1,e.DomUtil.hasClass(this._element,"leaflet-zoom-anim")||e.Draggable._dragging||d.shiftKey||1!==d.which&&1!==d.button&&!d.touches||!this._enabled||(e.Draggable._dragging=!0,this._preventOutline&&e.DomUtil.preventOutline(this._element),this._moving)))){this.fire("down");var f=d.touches?d.touches[0]:d;this._startPoint=new e.Point(f.clientX,f.clientY);this._startPos=this._newPos=e.DomUtil.getPosition(this._element);e.DomEvent.on(q,e.Draggable.MOVE[d.type],this._onMove,this).on(q,e.Draggable.END[d.type],this._onUp,this)}},a._draggable._updatePosition=function(){var a=this._lastEvent;this.fire("predrag",a);a=a.touches?a.touches[0]:a;this.fire("drag",{offset:this._startPoint.subtract(new e.Point(a.clientX,a.clientY))});this._startPoint=new e.Point(a.clientX,a.clientY)});a._draggable.on({dragstart:a._onDragStart,drag:a._onDrag,dragend:a._onDragEnd},a).enable();e.DomUtil.addClass(a._Object._renderer._rootGroup,"leaflet-path-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();e.Path.CANVAS||e.DomUtil.removeClass(this._Object._renderer._rootGroup,"leaflet-path-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(a){this._Object.fire("movestart").fire("dragstart")},_onDrag:function(a){this._transformPoints(a.offset);this._Object.fire("move",a).fire("drag",a)},_onDragEnd:function(a){this._Object.fire("moveend").fire("dragend")},_transformPoints:function(a){var d,e,g,h=this._Object;if(h._latlng=h._latlng||h._position,h._latlng)h._latlng=h._map.containerPointToLatLng(h._map.latLngToContainerPoint(h._latlng)._subtract(a)),h.setLatLng(h._latlng);else if(h._latlngs){h._latlngs=1<h._latlngs.length?h._latlngs:h._latlngs[0];d=0;for(e=h._latlngs.length;e>d;d++)g=h._latlngs[d],g=h._map.latLngToContainerPoint(g)._subtract(a),h._latlngs[d]=h._map.containerPointToLatLng(g);h.setLatLngs(h._latlngs)}}});e.Path.prototype.drag=function(a){a?(this.dragging||(this.dragging=new e.Handler.PathDrag(this)),this.dragging.enable()):this.dragging&&this.dragging.disable()};e.Edit=e.Edit||{};e.Edit.Poly=e.Handler.extend({options:{icon:new e.DivIcon({iconSize:new e.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon",offset:[-5,-6]})},initialize:function(a,d){this._poly=a;e.setOptions(this,d)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new e.LayerGroup);this._markers=[];var a,d,f,g=1<this._poly._latlngs.length?this._poly._latlngs:this._poly._latlngs[0];a=0;for(f=g.length;f>a;a++)d=this._createMarker(g[a],a),d.on("click",this._onMarkerClick,this),this._markers.push(d);var h,k;a=0;for(d=f-1;f>a;d=a++)(0!==a||e.Polygon&&this._poly instanceof e.Polygon)&&(h=this._markers[d],k=this._markers[a],this._createMiddleMarker(h,k),this._updatePrevNext(h,k))},_createMarker:function(a,d){var f=new e.Marker(a,{draggable:!0,icon:this.options.icon});return f._origLatLng=a,f._index=d,f.on("mousedown",this._onMarkerStart,this),f.on("drag",this._onMarkerDrag,this),f.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(f),f},_fireEdit:function(){this._poly.fire("editend")},_onMarkerStart:function(a){this._poly.fire("editstart")},_onMarkerDrag:function(a){a=a.target;e.extend(a._origLatLng,a._latlng);a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a));a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next));this._poly.redraw();this._poly.fire("editing")},_onMarkerClick:function(a){if(!(3>this._poly._latlngs.length)){a=a.target;var d=a._index;this._markerGroup.removeLayer(a);this._markers.splice(d,1);this._poly.spliceLatLngs(d,1);this._updateIndexes(d,-1);this._updatePrevNext(a._prev,a._next);a._middleLeft&&this._markerGroup.removeLayer(a._middleLeft);a._middleRight&&this._markerGroup.removeLayer(a._middleRight);a._prev&&a._next?this._createMiddleMarker(a._prev,a._next):a._prev?a._next||(a._prev._middleRight=null):a._next._middleLeft=null;this._poly.fire("removeedit")}},_updateIndexes:function(a,d){this._markerGroup.eachLayer(function(e){e._index>a&&(e._index+=d)})},_createMiddleMarker:function(a,d){var e,g,h=this._getMiddleLatLng(a,d),k=this._createMarker(h);k.setOpacity(.6);a._middleRight=d._middleLeft=k;e=function(){var e=d._index;k._index=e;k.on("click",this._onMarkerClick,this);h.lat=k.getLatLng().lat;h.lng=k.getLatLng().lng;this._poly.spliceLatLngs(e,0,h);this._markers.splice(e,0,k);k.setOpacity(1);this._updateIndexes(e,1);d._index++;this._updatePrevNext(a,k);this._updatePrevNext(k,d);this._poly.fire("editstart")};g=function(){k.off("dragstart",e,this);k.off("dragend",g,this);this._createMiddleMarker(a,k);this._createMiddleMarker(k,d)};k.on("dragstart",e,this).on("dragend",g,this);this._markerGroup.addLayer(k)},_updatePrevNext:function(a,d){a&&(a._next=d);d&&(d._prev=a)},_getMiddleLatLng:function(a,d){var e=this._poly._map,g=e.latLngToLayerPoint(a.getLatLng()),h=e.latLngToLayerPoint(d.getLatLng());return e.layerPointToLatLng(g._add(h)._divideBy(2))}});e.Polyline.addInitHook(function(){this.editing||(e.Edit.Poly&&(this.editing=new e.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))});e.Edit=e.Edit||{};e.Edit.SimpleShape=e.Handler.extend({options:{moveIcon:new e.DivIcon({iconSize:new e.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new e.DivIcon({iconSize:new e.Point(8,8),offset:new e.Point(-6,-5),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"})},initialize:function(a,d){this._shape=a;e.Util.setOptions(this,d)},addHooks:function(){this._shape._map&&(this._map=this._shape._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup))},removeHooks:function(){if(this._shape._map){for(var a=0,d=this._resizeMarkers.length;d>a;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null;this._map.removeLayer(this._markerGroup);delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new e.LayerGroup);this._createResizeMarker()},_createResizeMarker:function(){},_createMarker:function(a,d){var f=new e.Marker(a,{draggable:!0,icon:d,zIndexOffset:10});return this._bindMarker(f),this._markerGroup.addLayer(f),f},_bindMarker:function(a){a.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this)},_unbindMarker:function(a){a.off("dragstart",this._onMarkerDragStart).off("drag",this._onMarkerDrag).off("dragend",this._onMarkerDragEnd)},_onMarkerDragStart:function(a){a.target.setOpacity(0)},_onMarkerDrag:function(a){a=a.target;var d=a.getLatLng();a===this._moveMarker?this._move(d):this._resize(d);this._shape.redraw()},_onMarkerDragEnd:function(a){a.target.setOpacity(1);this._shape.fire("edit")},_move:function(){},_resize:function(){}});e.Edit=e.Edit||{};e.Edit.Rectangle=e.Edit.SimpleShape.extend({_createMoveMarker:function(){this._shape.getBounds().getCenter()},_createResizeMarker:function(){var a=this._getCorners();this._resizeMarkers=[];for(var d=0,e=a.length;e>d;d++)this._resizeMarkers.push(this._createMarker(a[d],this.options.resizeIcon)),this._resizeMarkers[d]._cornerIndex=d},_onMarkerDragStart:function(a){e.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,a);var d=this._getCorners();a=a.target._cornerIndex;this._oppositeCorner=d[(a+2)%4];this._toggleCornerMarkers(0,a)},_onMarkerDragEnd:function(a){var d,f,g=a.target;g===this._moveMarker&&(d=this._shape.getBounds(),f=d.getCenter(),g.setLatLng(f));this._toggleCornerMarkers(1);this._repositionCornerMarkers();e.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,a)},_move:function(a){for(var d,e=this._shape.getLatLngs(),g=this._shape.getBounds().getCenter(),h=[],k=0,l=e.length;l>k;k++)d=[e[k].lat-g.lat,e[k].lng-g.lng],h.push([a.lat+d[0],a.lng+d[1]]);this._shape.setLatLngs(h);this._repositionCornerMarkers()},_resize:function(a){this._shape.setBounds(e.latLngBounds(a,this._oppositeCorner));this._shape.getBounds()},_getCorners:function(){var a=this._shape.getBounds(),d=a.getNorthWest(),e=a.getNorthEast(),g=a.getSouthEast(),a=a.getSouthWest();return[d,e,g,a]},_toggleCornerMarkers:function(a){for(var d=0,e=this._resizeMarkers.length;e>d;d++)this._resizeMarkers[d].setOpacity(a)},_repositionCornerMarkers:function(){for(var a=this._getCorners(),d=0,e=this._resizeMarkers.length;e>d;d++)this._resizeMarkers[d].setLatLng(a[d])}});e.Rectangle.addInitHook(function(){e.Edit.Rectangle&&(this.editing=new e.Edit.Rectangle(this),this.options.editable&&this.editing.enable())});e.Edit=e.Edit||{};e.Edit.Circle=e.Edit.SimpleShape.extend({_createResizeMarker:function(){var a=this._shape.getLatLng(),a=this._getResizeMarkerPoint(a);this._resizeMarkers=[];this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(a){var d=this._shape._radius*Math.cos(Math.PI/4);a=this._map.project(a);return this._map.unproject([a.x+d,a.y-d])},_move:function(a){var d=this._getResizeMarkerPoint(a);this._resizeMarkers[0].setLatLng(d);this._shape.setLatLng(a)},_resize:function(a){a=this._shape.getLatLng().distanceTo(a);this._shape.setRadius(a)}});e.Circle.addInitHook(function(){e.Edit.Circle&&(this.editing=new e.Edit.Circle(this),this.options.editable&&this.editing.enable());this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()});this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})});e.Control=e.Class.extend({options:{position:"topright"},initialize:function(a){e.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var d=this._map;return d&&d.removeControl(this),this.options.position=a,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var d=this._container=this.onAdd(a),f=this.getPosition();a=a._controlCorners[f];return e.DomUtil.addClass(d,"leaflet-control"),-1!==f.indexOf("bottom")?a.insertBefore(d,a.firstChild):a.appendChild(d),this},remove:function(){return this._map?(e.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&0<a.screenX&&0<a.screenY&&this._map.getContainer().focus()}});e.control=function(a){return new e.Control(a)};e.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){function a(a,k){d[a+k]=e.DomUtil.create("div",f+a+" "+f+k,g)}var d=this._controlCorners={},f="leaflet-",g=this._controlContainer=e.DomUtil.create("div",f+"control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){e.DomUtil.remove(this._controlContainer)}});e.Control.Zoom=e.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var d=e.DomUtil.create("div","leaflet-control-zoom leaflet-bar"),f=this.options;return this._zoomInButton=this._createButton(f.zoomInText,f.zoomInTitle,"leaflet-control-zoom-in",d,this._zoomIn),this._zoomOutButton=this._createButton(f.zoomOutText,f.zoomOutTitle,"leaflet-control-zoom-out",d,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,d,f,g,h){f=e.DomUtil.create("a",f,g);return f.innerHTML=a,f.href="#",f.title=d,f.setAttribute("role","button"),f.setAttribute("aria-label",d),e.DomEvent.on(f,"mousedown dblclick",e.DomEvent.stopPropagation).on(f,"click",e.DomEvent.stop).on(f,"click",h,this).on(f,"click",this._refocusOnMap,this),f},_updateDisabled:function(){var a=this._map;e.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");e.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMinZoom())&&e.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&e.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});e.control.zoom=function(a){return new e.Control.Zoom(a)};e.Util.extend(e.Control.prototype,{options:e.Util.extend(e.Control.prototype.options,{position:[0,0],visible:!0}),setPosition:function(a){this._map;return this.options.position=a,this._calculatePosition(),this},setOffset:function(a){this.options.offset=a;this._calculatePosition()},visible:function(a){var d=this._container;d&&(a?d.style.visibility="inherit":d.style.visibility="hidden");this.options.visible=a},addTo:function(a){this.remove();this._map=a;var d=this._container=this.onAdd(a),f=this.getPosition();e.DomUtil.addClass(d,"leaflet-control");var g=e.DomUtil.create("div","leaflet-top leaflet-left",a._controlContainer);return f.indexOf&&-1!==f.indexOf("bottom")?g.insertBefore(d,g.firstChild):g.appendChild(d),this.visible(this.options.visible),this._calculatePosition(),a.on("resize",this._calculatePosition,this),this},_calculatePosition:function(){var a=this._container;if(a&&this._map){var d=this.options,e=this._map.getSize(),g=e.x*d.position[0],e=e.y*d.position[1],h=a.offsetWidth||a.style.width,k=a.offsetHeight||a.style.height;switch(d.position.join(",")){case "0,0":break;case "0.5,0":g-=h/2;break;case "1,0":g-=h;break;case "1,0.5":g-=h;e-=k/2;break;case "1,1":g-=h;e-=k;break;case "0.5,1":g-=h/2;e-=k;break;case "0,0.5":e-=k/2;break;case "0,1":e-=k;break;default:e-=k/2}g+=Math.floor(d.offset.x);e+=Math.floor(d.offset.y);a.style.left=g+"px";a.style.top=e+"px"}},remove:function(){return this._map?(e.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("resize",this._calculatePosition,this),this._map=null,this):this}});e.Util.extend(e.Control.Zoom.prototype,{options:e.Util.extend(e.Control.Zoom.prototype.options,{position:[0,0],offset:{x:10,y:10}})});e.Control.Attribution=e.Control.extend({options:{position:"bottomright",prefix:'\x3ca href\x3d"http://leafletjs.com" title\x3d"A JS library for interactive maps"\x3eLeaflet\x3c/a\x3e'},initialize:function(a){e.setOptions(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=e.DomUtil.create("div","leaflet-control-attribution");e.DomEvent&&e.DomEvent.disableClickPropagation(this._container);for(var d in a._layers)a._layers[d].getAttribution&&this.addAttribution(a._layers[d].getAttribution());return this._update(),this._container},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[],d;for(d in this._attributions)this._attributions[d]&&a.push(d);d=[];this.options.prefix&&d.push(this.options.prefix);a.length&&d.push(a.join(", "));this._container.innerHTML=d.join(" | ")}}});e.control.attribution=function(a){return new e.Control.Attribution(a)};e.Util.extend(e.Control.Attribution.prototype,{options:e.Util.extend(e.Control.Attribution.prototype.options,{position:[1,1],offset:{x:-5,y:-5},prefix:""}),onAdd:function(a){return this._container=e.DomUtil.create("div","leaflet-control-attribution"),e.DomEvent&&e.DomEvent.disableClickPropagation(this._container),this._update(),this._container},addAttribution:function(a){return a||a.id?(this._attributions[a.id]=a,this._update(),this):this},removeAttribution:function(a){return a&&this._attributions[a]?(this._attributions[a]=v,this._update(),this):void 0},getAttribution:function(a){return this._attributions[a]},getAttributions:function(){var a=[],d;for(d in this._attributions)this._attributions[d]&&a.push(this._attributions[d]);return a},_update:function(){if(this._map){var a=[],d;for(d in this._attributions)this._attributions[d]&&a.push(this._attributions[d].content);this._container.innerHTML=a.join(" | ");this._calculatePosition()}}});e.Control.Scale=e.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var d=e.DomUtil.create("div","leaflet-control-scale"),f=this.options;return this._addScales(f,"leaflet-control-scale-line",d),a.on(f.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),d},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,d,f){a.metric&&(this._mScale=e.DomUtil.create("div",d,f));a.imperial&&(this._iScale=e.DomUtil.create("div",d,f))},_update:function(){var a=this._map,d=a.getSize().y/2,a=a.distance(a.containerPointToLatLng([0,d]),a.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(a)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var d=this._getRoundNum(a);this._updateScale(this._mScale,1E3>d?d+" m":d/1E3+" km",d/a)},_updateImperial:function(a){var d,e,g;a*=3.2808399;5280<a?(d=a/5280,e=this._getRoundNum(d),this._updateScale(this._iScale,e+" mi",e/d)):(g=this._getRoundNum(a),this._updateScale(this._iScale,g+" ft",g/a))},_updateScale:function(a,d,e){a.style.width=Math.round(this.options.maxWidth*e)+"px";a.innerHTML=d},_getRoundNum:function(a){var d=Math.pow(10,(Math.floor(a)+"").length-1);a/=d;return a=10<=a?10:5<=a?5:3<=a?3:2<=a?2:1,d*a}});e.control.scale=function(a){return new e.Control.Scale(a)};e.Util.extend(e.Control.Scale.prototype,{options:e.Util.extend(e.Control.Scale.prototype.options,{position:[0,1],offset:{x:5,y:-5},maxWidth:150}),_updateMetric:function(a){var d=this._getRoundNum(a);this._updateScale(this._mScale,1E3>d?d+"\u7c73":d/1E3+"\u516c\u91cc",d/a)},_updateImperial:function(a){var d,e,g;a*=3.2808399;5280<a?(d=a/5280,e=this._getRoundNum(d),this._updateScale(this._iScale,e+"\u82f1\u91cc",e/d)):(g=this._getRoundNum(a),this._updateScale(this._iScale,g+"\u82f1\u5c3a",g/a))}});e.PosAnimation=e.Evented.extend({run:function(a,d,f,g){this.stop();this._el=a;this._inProgress=!0;this._duration=f||.25;this._easeOutPower=1/Math.max(g||.5,.2);this._startPos=e.DomUtil.getPosition(a);this._offset=d.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=e.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(a){var d=+new Date-this._startTime,e=1E3*this._duration;e>d?this._runFrame(this._easeOut(d/e),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var f=this._startPos.add(this._offset.multiplyBy(a));d&&f._round();e.DomUtil.setPosition(this._el,f);this.fire("step")},_complete:function(){e.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});e.Map.include({setView:function(a,d,f){if(d=d===v?this._zoom:this._limitZoom(d),a=this._limitCenter(e.latLng(a),d,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&!0!==f)if(f.animate!==v&&(f.zoom=e.extend({animate:f.animate},f.zoom),f.pan=e.extend({animate:f.animate,duration:f.duration},f.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,f.zoom):this._tryAnimatedPan(a,f.pan))return clearTimeout(this._sizeTimer),this;return this._resetView(a,d),this.fire("moveend").fire("changed"),this},panBy:function(a,d){if(a=e.point(a).round(),d=d||{},!a.x&&!a.y)return this.fire("moveend").fire("changed");if(!0!==d.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new e.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart").fire("changed"),!1!==d.animate){e.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(a);this._panAnim.run(this._mapPane,f,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend").fire("changed");return this},_onPanTransitionStep:function(){this.fire("move").fire("change")},_onPanTransitionEnd:function(){e.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend").fire("changed")}});e.Map.include({_defaultLocateOptions:{timeout:1E4,watch:!1},locate:function(a){if(a=this._locateOptions=e.extend({},this._defaultLocateOptions,a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=e.bind(this._handleGeolocationResponse,this),f=e.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,f,a):navigator.geolocation.getCurrentPosition(d,f,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var d=a.code;a=a.message||(1===d?"permission denied":2===d?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:d,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var d=new e.LatLng(a.coords.latitude,a.coords.longitude),f=d.toBounds(a.coords.accuracy),g=this._locateOptions;if(g.setView){var h=this.getBoundsZoom(f);this.setView(d,g.maxZoom?Math.min(h,g.maxZoom):h)}var d={latlng:d,bounds:f,timestamp:a.timestamp},k;for(k in a.coords)"number"==typeof a.coords[k]&&(d[k]=a.coords[k]);this.fire("locationfound",d)}});e.Label=(e.Layer?e.Layer:e.Class).extend({includes:e.Mixin.Events,options:{className:"",clickable:!0,direction:"right",noHide:!1,offset:[0,0],anchor:[0,0],opacity:1,zoomAnimation:!0,fontName:"\u5b8b\u4f53",fontColor:"#ffffff",fontSize:12,fontBold:!0,title:"",type:"0"},initialize:function(a,d){e.setOptions(this,a);this._source=d;this._animated=e.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(a){this._map=a;this._pane=this.options.pane?a._panes[this.options.pane]:this._source instanceof e.Marker?a._panes.markerPane:a._panes.popupPane;this._parentContainer||this._initLayout();this._pane.appendChild(this._parentContainer);this._initInteraction();this._update();this.setOpacity(this.options.opacity);a.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this);this._animated&&a.on("zoom",this._zoomAnimation,this)},onRemove:function(a){this._pane.removeChild(this._parentContainer);a.off({zoom:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this);this._removeInteraction();this._map=null},setLatLng:function(a){return this._latlng=e.latLng(a),this._map&&this._updatePosition(),this},getLatLng:function(){return this._latlng},setContent:function(a){return this._previousContent=this._content,this._content=a,this._updateContent(),this},close:function(){var a=this._map;a&&a.removeLayer(this)},updateZIndex:function(a){this._zIndex=a;this._parentContainer&&this._zIndex&&(this._parentContainer.style.zIndex=a)},setOpacity:function(a){this.options.opacity=a;this._container&&e.DomUtil.setOpacity(this._container,a)},getOptions:function(){return this.options},getLabelSize:function(){return[this._labelWidth,this._labelHeight]},getElement:function(){return this._parentContainer},_initLayout:function(){this._parentContainer=e.DomUtil.create("div","");this._parentContainer.style.position="absolute";this._parentContainer.style.zIndex=210;this._container=e.DomUtil.create("div","leafletmap-label "+this.options.className+" leafletmap-zoom-animated");this._container.style.color=this.options.fontColor;this._container.style.font=this.options.fontSize+'px "'+this.options.fontName+'"';this._container.style.fontWeight=this.options.fontBold?"bold":"normal";this._container.style.border="1px solid rgb(128, 128, 128)";this._container.style.backgroundColor="rgb(255, 255, 255)";this._container.style.padding="1px 2px";this._container.style.whiteSpace="nowrap";this._parentContainer.appendChild(this._container);this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._parentContainer.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._parentContainer.style.visibility="")},_updateContent:function(){this._content&&this._map&&("0"==this.options.type?(this._container.className=this.options.className+" leafletmap-zoom-animated",this._container.style.color=this.options.fontColor,this._container.style.font=this.options.fontSize+'px "'+this.options.fontName+'"',this._container.style.fontWeight=this.options.fontBold?"bold":"normal",this._container.innerHTML=this._content,this._prevContent=this._content):(this._parentContainer.removeChild(this._container),"string"==typeof this._content?(this._container=e.DomUtil.create("div",""),this._container.innerHTML=this._content):this._container=this._content,this._container.style.whiteSpace="nowrap",this._parentContainer.appendChild(this._container)),this._labelWidth=this._container.offsetWidth,this._labelHeight=this._container.offsetHeight)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},_setPosition:function(a){var d=this._map,f=this._parentContainer,g=d.latLngToContainerPoint(d.getCenter()),d=d.layerPointToContainerPoint(a),h=this.options.direction,k=this._labelWidth,l=(this._labelHeight,e.point(this.options.offset)),m=e.point(this.options.anchor);"right"===h||"auto"===h&&d.x<g.x?(e.DomUtil.removeClass(f,"leafletmap-label-left"),a=a.add(l)):(e.DomUtil.addClass(f,"leafletmap-label-left"),e.DomUtil.removeClass(f,"leafletmap-label-right"),a=a.add(e.point(-l.x-k,l.y)));a=a.subtract(m);e.DomUtil.setPosition(f,a)},_zoomAnimation:function(a){a=this._map.latLngToLayerPoint(this._latlng).round();this._setPosition(a)},_onMoveEnd:function(){this._updatePosition()},_onViewReset:function(a){a&&a.hard&&this._update()},_initInteraction:function(){if(this.options.clickable){var a=this._parentContainer,d=["dblclick","mousedown","mouseover","mouseout","contextmenu"];e.DomUtil.addClass(a,"leafletmap-clickable");e.DomEvent.on(a,"click",this._onMouseClick,this);e.DomEvent.on(a,"contextmenu",function(a){e.DomEvent.preventDefault(a)},this);for(var f=0;f<d.length;f++)e.DomEvent.on(a,d[f],this._fireMouseEvent,this)}},_removeInteraction:function(){if(this.options.clickable){var a=this._parentContainer,d=["dblclick","mousedown","mouseover","mouseout","contextmenu"];e.DomUtil.removeClass(a,"leafletmap-clickable");e.DomEvent.off(a,"click",this._onMouseClick,this);for(var f=0;f<d.length;f++)e.DomEvent.off(a,d[f],this._fireMouseEvent,this)}},_onMouseClick:function(a){this.hasEventListeners(a.type)&&e.DomEvent.stopPropagation(a);this.fire(a.type,{originalEvent:a})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a});"contextmenu"===a.type&&this.hasEventListeners(a.type)&&e.DomEvent.preventDefault(a);"mousedown"!==a.type?e.DomEvent.stopPropagation(a):e.DomEvent.preventDefault(a)}});e.BaseMarkerMethods={showLabel:function(){return this.label&&this._map&&(this.label.setLatLng(this._latlng),this._map.showLabel(this.label)),this},hideLabel:function(){return this.label&&this.label.close(),this},setLabelNoHide:function(a){this._labelNoHide!==a&&(this._labelNoHide=a,a?(this._removeLabelRevealHandlers(),this.showLabel()):(this._addLabelRevealHandlers(),this.hideLabel()))},bindLabel:function(a,d){return this._labelNoHide=d.noHide,this.label||(this._labelNoHide||this._addLabelRevealHandlers(),this.on("remove",this.hideLabel,this).on("move",this._moveLabel,this).on("add",this._onMarkerAdd,this),this._hasLabelHandlers=!0),"object"==typeof a?this.label=a:this.label=(new e.Label(d,this)).setContent(a),this},unbindLabel:function(){return this.label&&(this.hideLabel(),this.label=null,this._hasLabelHandlers&&(this._labelNoHide||this._removeLabelRevealHandlers(),this.off("remove",this.hideLabel,this).off("move",this._moveLabel,this).off("add",this._onMarkerAdd,this)),this._hasLabelHandlers=!1),this},updateLabelContent:function(a){this.label&&this.label.setContent(a)},getLabel:function(){return this.label},_onMarkerAdd:function(){this._labelNoHide&&this.showLabel()},_addLabelRevealHandlers:function(){this.on("mouseover",this.showLabel,this).on("mouseout",this.hideLabel,this);e.Browser.touch&&this.on("click",this.showLabel,this)},_removeLabelRevealHandlers:function(){this.off("mouseover",this.showLabel,this).off("mouseout",this.hideLabel,this);e.Browser.touch&&this.off("click",this.showLabel,this)},_moveLabel:function(a){this.label.setLatLng(a.latlng)}};e.Icon.Default.mergeOptions({labelAnchor:new e.Point(9,-20)});e.Marker.mergeOptions({icon:new e.Icon.Default});e.Marker.include(e.BaseMarkerMethods);e.Marker.include({_originalUpdateZIndex:e.Marker.prototype._updateZIndex,_updateZIndex:function(a){var d=this._zIndex;this._originalUpdateZIndex(a);this.label&&this.label.updateZIndex(d)},_originalSetOpacity:e.Marker.prototype.setOpacity,setOpacity:function(a,d){this.options.labelHasSemiTransparency=d;this._originalSetOpacity(a)},_originalUpdateOpacity:e.Marker.prototype._updateOpacity,_updateOpacity:function(){var a=0===this.options.opacity?0:1;this._originalUpdateOpacity();this.label&&this.label.setOpacity(this.options.labelHasSemiTransparency?this.options.opacity:a)},_originalSetLatLng:e.Marker.prototype.setLatLng,setLatLng:function(a){return this.label&&!this._labelNoHide&&this.hideLabel(),this._originalSetLatLng(a)}});e.CircleMarker.mergeOptions({labelAnchor:new e.Point(0,0)});e.CircleMarker.include(e.BaseMarkerMethods);e.Path.include({bindLabel:function(a,d){return this.label&&this.label.options===d||(this.label=new e.Label(d,this)),this.label.setContent(a),this._showLabelAdded||(this.on("mouseover",this._showLabel,this).on("mousemove",this._moveLabel,this).on("mouseout remove",this._hideLabel,this),e.Browser.touch&&this.on("click",this._showLabel,this),this._showLabelAdded=!0),this},unbindLabel:function(){return this.label&&(this._hideLabel(),this.label=null,this._showLabelAdded=!1,this.off("mouseover",this._showLabel,this).off("mousemove",this._moveLabel,this).off("mouseout remove",this._hideLabel,this)),this},updateLabelContent:function(a){this.label&&this.label.setContent(a)},_showLabel:function(a){this.label.setLatLng(a.latlng);this._map.showLabel(this.label)},_moveLabel:function(a){this.label.setLatLng(a.latlng)},_hideLabel:function(){this.label.close()}});e.Map.include({showLabel:function(a){return this.addLayer(a)}});e.FeatureGroup.include({clearLayers:function(){return this.unbindLabel(),this.eachLayer(this.removeLayer,this),this},bindLabel:function(a,d){return this.invoke("bindLabel",a,d)},unbindLabel:function(){return this.invoke("unbindLabel")},updateLabelContent:function(a){this.invoke("updateLabelContent",a)}});(function(a,d){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet")));"undefined"!=typeof d&&d.L&&a(d.L)})(function(a){a.Editable=a.Evented.extend({statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1E3,polygonClass:a.Polygon,polylineClass:a.Polyline,markerClass:a.Marker,rectangleClass:a.Rectangle,circleClass:a.Circle,drawingCSSClass:"leaflet-editable-drawing",drawingCursor:"crosshair",editLayer:v,featuresLayer:v,polylineEditorClass:v,polygonEditorClass:v,markerEditorClass:v,rectangleEditorClass:v,circleEditorClass:v,lineGuideOptions:{},skipMiddleMarkers:!1},initialize:function(d,e){a.setOptions(this,e);this._lastZIndex=this.options.zIndex;this.map=d;this.editLayer=this.createEditLayer();this.featuresLayer=this.createFeaturesLayer();this.forwardLineGuide=this.createLineGuide();this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(a,d){d=d||{};d.editTools=this;this.fire(a,d);this.map.fire(a,d)},createLineGuide:function(){var d=a.extend({dashArray:"5,10",weight:1,interactive:!1},this.options.lineGuideOptions);return a.polyline([],d)},createVertexIcon:function(d){return a.Browser.touch?new a.Editable.TouchVertexIcon(d):new a.Editable.VertexIcon(d)},createEditLayer:function(){return this.options.editLayer||(new a.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new a.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(a){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=a,this.forwardLineGuide._bounds.extend(a),this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(a){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=a,this.backwardLineGuide._bounds.extend(a),this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(a){this.forwardLineGuide._latlngs[0]=a;this.forwardLineGuide._bounds.extend(a);this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(a){this.backwardLineGuide._latlngs[0]=a;this.backwardLineGuide._bounds.extend(a);this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide.setLatLngs([]);this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide.setLatLngs([]);this.editLayer.removeLayer(this.backwardLineGuide)},blockEvents:function(){this._oldTargets||(this._oldTargets=this.map._targets,this.map._targets={})},unblockEvents:function(){this._oldTargets&&(this.map._targets=a.extend(this.map._targets,this._oldTargets),delete this._oldTargets)},registerForDrawing:function(d){this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor);this.blockEvents();d.reset();this._drawingEditor=d;this.map.on("mousemove touchmove",d.onDrawingMouseMove,d);this.map.on("mousedown",this.onMousedown,this);this.map.on("mouseup",this.onMouseup,this);a.DomUtil.addClass(this.map._container,this.options.drawingCSSClass);this.defaultMapCursor=this.map._container.style.cursor;this.map._container.style.cursor=this.options.drawingCursor},unregisterForDrawing:function(d){this.unblockEvents();a.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass);this.map._container.style.cursor=this.defaultMapCursor;(d=d||this._drawingEditor)&&(this.map.off("mousemove touchmove",d.onDrawingMouseMove,d),this.map.off("mousedown",this.onMousedown,this),this.map.off("mouseup",this.onMouseup,this),d===this._drawingEditor&&(delete this._drawingEditor,d._drawing&&d.cancelDrawing()))},onMousedown:function(a){this._mouseDown=a;this._drawingEditor.onDrawingMouseDown(a)},onMouseup:function(d){if(this._mouseDown){var e=this._drawingEditor,f=this._mouseDown;if(this._mouseDown=null,e.onDrawingMouseUp(d),this._drawingEditor===e)e=a.point(f.originalEvent.clientX,f.originalEvent.clientY),e=a.point(d.originalEvent.clientX,d.originalEvent.clientY).distanceTo(e),Math.abs(e)<9*(u.devicePixelRatio||1)&&this._drawingEditor.onDrawingClick(d)}},drawing:function(){return this._drawingEditor&&this._drawingEditor.drawing()},stopDrawing:function(){this.unregisterForDrawing()},commitDrawing:function(a){this._drawingEditor&&this._drawingEditor.commitDrawing(a)},connectCreatedToMap:function(a){return this.featuresLayer.addLayer(a)},startPolyline:function(a,d){var e=this.createPolyline([],d);return e.enableEdit(this.map).newShape(a),e},startPolygon:function(a,d){var e=this.createPolygon([],d);return e.enableEdit(this.map).newShape(a),e},startMarker:function(a,d){a=a||this.map.getCenter().clone();var e=this.createMarker(a,d);return e.enableEdit(this.map).startDrawing(),e},startRectangle:function(d,e){var f=d||a.latLng([0,0]),f=new a.LatLngBounds(f,f),f=this.createRectangle(f,e);return f.enableEdit(this.map).startDrawing(),f},startCircle:function(a,d){a=a||this.map.getCenter().clone();var e=this.createCircle(a,d);return e.enableEdit(this.map).startDrawing(),e},startHole:function(a,d){a.newHole(d)},createLayer:function(d,e,f){f=a.Util.extend({editOptions:{editTools:this}},f);d=new d(e,f);return this.fireAndForward("editable:created",{layer:d}),d},createPolyline:function(a,d){return this.createLayer(d&&d.polylineClass||this.options.polylineClass,a,d)},createPolygon:function(a,d){return this.createLayer(d&&d.polygonClass||this.options.polygonClass,a,d)},createMarker:function(a,d){return this.createLayer(d&&d.markerClass||this.options.markerClass,a,d)},createRectangle:function(a,d){return this.createLayer(d&&d.rectangleClass||this.options.rectangleClass,a,d)},createCircle:function(a,d){return this.createLayer(d&&d.circleClass||this.options.circleClass,a,d)}});a.extend(a.Editable,{makeCancellable:function(a){a.cancel=function(){a._cancelled=!0}}});a.Map.mergeOptions({editToolsClass:a.Editable,editable:!1,editOptions:{}});a.Editable.VertexIcon=a.DivIcon.extend({options:{iconSize:new a.Point(8,8)}});a.Editable.TouchVertexIcon=a.Editable.VertexIcon.extend({options:{iconSize:new a.Point(20,20)}});a.Editable.VertexMarker=a.Marker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(d,e,f,g){this.latlng=d;this.latlngs=e;this.editor=f;a.Marker.prototype.initialize.call(this,d,g);this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className});this.latlng.__vertex=this;this.editor.editLayer.addLayer(this);this.setZIndexOffset(f.tools._lastZIndex+1)},onAdd:function(d){a.Marker.prototype.onAdd.call(this,d);this.on("drag",this.onDrag);this.on("dragstart",this.onDragStart);this.on("dragend",this.onDragEnd);this.on("mouseup",this.onMouseup);this.on("click",this.onClick);this.on("contextmenu",this.onContextMenu);this.on("mousedown touchstart",this.onMouseDown);this.addMiddleMarkers()},onRemove:function(d){this.middleMarker&&this.middleMarker["delete"]();delete this.latlng.__vertex;this.off("drag",this.onDrag);this.off("dragstart",this.onDragStart);this.off("dragend",this.onDragEnd);this.off("mouseup",this.onMouseup);this.off("click",this.onClick);this.off("contextmenu",this.onContextMenu);this.off("mousedown touchstart",this.onMouseDown);a.Marker.prototype.onRemove.call(this,d)},onDrag:function(d){d.vertex=this;this.editor.onVertexMarkerDrag(d);d=a.DomUtil.getPosition(this._icon);d=this._map.layerPointToLatLng(d);this.latlng.update(d);this._latlng=this.latlng;this.editor.refresh();this.middleMarker&&this.middleMarker.updateLatLng();(d=this.getNext())&&d.middleMarker&&d.middleMarker.updateLatLng()},onDragStart:function(a){a.vertex=this;this.editor.onVertexMarkerDragStart(a)},onDragEnd:function(a){a.vertex=this;this.editor.onVertexMarkerDragEnd(a)},onClick:function(a){a.vertex=this;this.editor.onVertexMarkerClick(a)},onMouseup:function(d){a.DomEvent.stop(d);d.vertex=this;this.editor.map.fire("mouseup",d)},onContextMenu:function(a){a.vertex=this;this.editor.onVertexMarkerContextMenu(a)},onMouseDown:function(a){a.vertex=this;this.editor.onVertexMarkerMouseDown(a)},"delete":function(){var a=this.getNext();this.latlngs.splice(this.getIndex(),1);this.editor.editLayer.removeLayer(this);this.editor.onVertexDeleted({latlng:this.latlng,vertex:this});this.latlngs.length||this.editor.deleteShape(this.latlngs);a&&a.resetMiddleMarker();this.editor.refresh()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(2>this.latlngs.length)){var a=this.getIndex(),d=a-1;0===a&&this.editor.CLOSED&&(d=this.getLastIndex());return(a=this.latlngs[d])?a.__vertex:void 0}},getNext:function(){if(!(2>this.latlngs.length)){var a=this.getIndex(),d=a+1;a===this.getLastIndex()&&this.editor.CLOSED&&(d=0);return(a=this.latlngs[d])?a.__vertex:void 0}},addMiddleMarker:function(a){this.editor.hasMiddleMarkers()&&(a=a||this.getPrevious(),a&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(a,this,this.latlngs,this.editor)))},addMiddleMarkers:function(){if(this.editor.hasMiddleMarkers()){var a=this.getPrevious();a&&this.addMiddleMarker(a);(a=this.getNext())&&a.resetMiddleMarker()}},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker["delete"]();this.addMiddleMarker()},split:function(){this.editor.splitShape&&this.editor.splitShape(this.latlngs,this.getIndex())},"continue":function(){if(this.editor.continueBackward){var a=this.getIndex();0===a?this.editor.continueBackward(this.latlngs):a===this.getLastIndex()&&this.editor.continueForward(this.latlngs)}}});a.Editable.mergeOptions({vertexMarkerClass:a.Editable.VertexMarker});a.Editable.MiddleMarker=a.Marker.extend({options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon",draggable:!0},initialize:function(d,e,f,g,h){this.left=d;this.right=e;this.editor=g;this.latlngs=f;a.Marker.prototype.initialize.call(this,this.computeLatLng(),h);this._opacity=this.options.opacity;this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className});this.editor.editLayer.addLayer(this);this.setVisibility()},setVisibility:function(){var d=this._map.latLngToContainerPoint(this.left.latlng),e=this._map.latLngToContainerPoint(this.right.latlng),f=a.point(this.options.icon.options.iconSize);d.distanceTo(e)<3*f.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng());this.setVisibility()},computeLatLng:function(){var a=this.editor.map.latLngToContainerPoint(this.left.latlng),d=this.editor.map.latLngToContainerPoint(this.right.latlng);return this.editor.map.containerPointToLatLng([(a.x+d.x)/2,(a.y+d.y)/2])},onAdd:function(d){a.Marker.prototype.onAdd.call(this,d);a.DomEvent.on(this._icon,"mousedown touchstart",this.onMouseDown,this);d.on("zoomend",this.setVisibility,this)},onRemove:function(d){delete this.right.middleMarker;a.DomEvent.off(this._icon,"mousedown touchstart",this.onMouseDown,this);d.off("zoomend",this.setVisibility,this);a.Marker.prototype.onRemove.call(this,d)},onMouseDown:function(d){var e=a.DomUtil.getPosition(this._icon),e=this.editor.map.layerPointToLatLng(e);if(d={originalEvent:d,latlng:e},0!==this.options.opacity&&(a.Editable.makeCancellable(d),this.editor.onMiddleMarkerMouseDown(d),!d._cancelled)){this.latlngs.splice(this.index(),0,d.latlng);this.editor.refresh();var e=this._icon,f=this.editor.addVertexMarker(d.latlng,this.latlngs),g=f._icon.parentNode;g.removeChild(f._icon);f._icon=e;g.appendChild(f._icon);f._initIcon();f._initInteraction();f.setOpacity(1);a.Draggable._dragging=!1;f.dragging._draggable._onDown(d.originalEvent);this["delete"]()}},"delete":function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)}});a.Editable.mergeOptions({middleMarkerClass:a.Editable.MiddleMarker});a.Editable.BaseEditor=a.Handler.extend({initialize:function(d,e,f){a.setOptions(this,f);this.map=d;this.feature=e;this.feature.editor=this;this.editLayer=new a.LayerGroup;this.tools=this.options.editTools||d.editTools},addHooks:function(){this.isConnected()?this.onFeatureAdd():this.feature.once("add",this.onFeatureAdd,this);this.onEnable();this.feature.on(this._getEvents(),this)},removeHooks:function(){this.feature.off(this._getEvents(),this);this.feature.dragging&&this.feature.dragging.disable();this.editLayer.clearLayers();this.tools.editLayer.removeLayer(this.editLayer);this.onDisable();this._drawing&&this.cancelDrawing()},drawing:function(){return!!this._drawing},reset:function(){},onFeatureAdd:function(){this.tools.editLayer.addLayer(this.editLayer);this.feature.dragging&&this.feature.dragging.enable()},hasMiddleMarkers:function(){return!this.options.skipMiddleMarkers&&!this.tools.options.skipMiddleMarkers},fireAndForward:function(a,d){d=d||{};d.layer=this.feature;this.feature.fire(a,d);this.tools.fireAndForward(a,d)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(a){this.fireAndForward("editable:drawing:commit",a)},onDrawingMouseDown:function(a){this.fireAndForward("editable:drawing:mousedown",a)},onDrawingMouseUp:function(a){this.fireAndForward("editable:drawing:mouseup",a)},startDrawing:function(){this._drawing||(this._drawing=a.Editable.FORWARD);this.tools.registerForDrawing(this);this.onStartDrawing()},commitDrawing:function(a){this.onCommitDrawing(a);this.endDrawing()},cancelDrawing:function(){a.Draggable._dragging=!1;this.onCancelDrawing();this.endDrawing()},endDrawing:function(){this._drawing=!1;this.tools.unregisterForDrawing(this);this.onEndDrawing()},onDrawingClick:function(d){this.drawing()&&(a.Editable.makeCancellable(d),this.fireAndForward("editable:drawing:click",d),d._cancelled||(this.isConnected()||this.connect(d),this.processDrawingClick(d)))},isConnected:function(){return this.map.hasLayer(this.feature)},connect:function(a){this.tools.connectCreatedToMap(this.feature);this.tools.editLayer.addLayer(this.editLayer)},onMove:function(a){this.fireAndForward("editable:drawing:move",a)},onDrawingMouseMove:function(a){this.onMove(a)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(a){this.onEditing();this.fireAndForward("editable:dragstart",a)},onDrag:function(a){this.onMove(a);this.fireAndForward("editable:drag",a)},onDragEnd:function(a){this.fireAndForward("editable:dragend",a)}});a.Editable.MarkerEditor=a.Editable.BaseEditor.extend({onDrawingMouseMove:function(d){a.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,d);this._drawing&&this.feature.setLatLng(d.latlng)},processDrawingClick:function(a){this.fireAndForward("editable:drawing:clicked",a);this.commitDrawing(a)},connect:function(d){d&&(this.feature._latlng=d.latlng);a.Editable.BaseEditor.prototype.connect.call(this,d)}});a.Editable.PathEditor=a.Editable.BaseEditor.extend({CLOSED:!1,MIN_VERTEX:2,addHooks:function(){return a.Editable.BaseEditor.prototype.addHooks.call(this),this.feature&&this.initVertexMarkers(),this},initVertexMarkers:function(d){if(this.enabled())if(d=d||this.getLatLngs(),a.Polyline._flat(d))this.addVertexMarkers(d);else for(var e=0;e<d.length;e++)this.initVertexMarkers(d[e])},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers();this.initVertexMarkers()},addVertexMarker:function(a,d){return new this.tools.options.vertexMarkerClass(a,d,this)},addVertexMarkers:function(a){for(var d=0;d<a.length;d++)this.addVertexMarker(a[d],a)},refreshVertexMarkers:function(a){a=a||this.getDefaultLatLngs();for(var d=0;d<a.length;d++)a[d].__vertex.update()},addMiddleMarker:function(a,d,e){return new this.tools.options.middleMarkerClass(a,d,e,this)},onVertexMarkerClick:function(d){if(a.Editable.makeCancellable(d),this.fireAndForward("editable:vertex:click",d),!(d._cancelled||this.tools.drawing()&&this.tools._drawingEditor!==this)){var e,f=d.vertex.getIndex();d.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(d):d.originalEvent.altKey?this.onVertexMarkerAltClick(d):d.originalEvent.shiftKey?this.onVertexMarkerShiftClick(d):d.originalEvent.metaKey?this.onVertexMarkerMetaKeyClick(d):f===d.vertex.getLastIndex()&&this._drawing===a.Editable.FORWARD?f>=this.MIN_VERTEX-1&&(e=!0):0===f&&this._drawing===a.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX?e=!0:0===f&&this._drawing===a.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?e=!0:this.onVertexRawMarkerClick(d);this.fireAndForward("editable:vertex:clicked",d);e&&this.commitDrawing(d)}},onVertexRawMarkerClick:function(a){this.fireAndForward("editable:vertex:rawclick",a);a._cancelled||this.vertexCanBeDeleted(a.vertex)&&a.vertex["delete"]()},vertexCanBeDeleted:function(a){return a.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(a){this.fireAndForward("editable:vertex:deleted",a)},onVertexMarkerCtrlClick:function(a){this.fireAndForward("editable:vertex:ctrlclick",a)},onVertexMarkerShiftClick:function(a){this.fireAndForward("editable:vertex:shiftclick",a)},onVertexMarkerMetaKeyClick:function(a){this.fireAndForward("editable:vertex:metakeyclick",a)},onVertexMarkerAltClick:function(a){this.fireAndForward("editable:vertex:altclick",a)},onVertexMarkerContextMenu:function(a){this.fireAndForward("editable:vertex:contextmenu",a)},onVertexMarkerMouseDown:function(a){this.fireAndForward("editable:vertex:mousedown",a)},onMiddleMarkerMouseDown:function(a){this.fireAndForward("editable:middlemarker:mousedown",a)},onVertexMarkerDrag:function(a){this.onMove(a);this.feature._bounds&&this.extendBounds(a);this.fireAndForward("editable:vertex:drag",a)},onVertexMarkerDragStart:function(a){this.fireAndForward("editable:vertex:dragstart",a)},onVertexMarkerDragEnd:function(a){this.fireAndForward("editable:vertex:dragend",a)},setDrawnLatLngs:function(a){this._drawnLatLngs=a||this.getDefaultLatLngs()},startDrawing:function(){this._drawnLatLngs||this.setDrawnLatLngs();a.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing()},endDrawing:function(){this.tools.detachForwardLineGuide();this.tools.detachBackwardLineGuide();this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs);a.Editable.BaseEditor.prototype.endDrawing.call(this);delete this._drawnLatLngs},addLatLng:function(d){this._drawing===a.Editable.FORWARD?this._drawnLatLngs.push(d):this._drawnLatLngs.unshift(d);this.feature._bounds.extend(d);this.addVertexMarker(d,this._drawnLatLngs);this.refresh()},newPointForward:function(a){this.addLatLng(a);this.tools.attachForwardLineGuide();this.tools.anchorForwardLineGuide(a)},newPointBackward:function(a){this.addLatLng(a);this.tools.anchorBackwardLineGuide(a)},push:function(d){return d?void(this._drawing===a.Editable.FORWARD?this.newPointForward(d):this.newPointBackward(d)):console.error("L.Editable.PathEditor.push expect a vaild latlng as parameter")},removeLatLng:function(a){a.__vertex["delete"]();this.refresh()},pop:function(){if(!(1>=this._drawnLatLngs.length)){var d;return d=this._drawing===a.Editable.FORWARD?this._drawnLatLngs[this._drawnLatLngs.length-1]:this._drawnLatLngs[0],this.removeLatLng(d),this._drawing===a.Editable.FORWARD?this.tools.anchorForwardLineGuide(this._drawnLatLngs[this._drawnLatLngs.length-1]):this.tools.anchorForwardLineGuide(this._drawnLatLngs[0]),d}},processDrawingClick:function(d){d.vertex&&d.vertex.editor===this||(this._drawing===a.Editable.FORWARD?this.newPointForward(d.latlng):this.newPointBackward(d.latlng),this.fireAndForward("editable:drawing:clicked",d))},onDrawingMouseMove:function(d){a.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,d);this._drawing&&(this.tools.moveForwardLineGuide(d.latlng),this.tools.moveBackwardLineGuide(d.latlng))},refresh:function(){this.feature.redraw();this.onEditing()},newShape:function(a){var d=this.addNewEmptyShape();d&&(this.setDrawnLatLngs(d[0]||d),this.startDrawingForward(),this.fireAndForward("editable:shape:new",{shape:d}),a&&this.newPointForward(a))},deleteShape:function(d,e){var f={shape:d};return a.Editable.makeCancellable(f),this.fireAndForward("editable:shape:delete",f),f._cancelled?void 0:(d=this._deleteShape(d,e),this.ensureNotFlat&&this.ensureNotFlat(),this.feature.setLatLngs(this.getLatLngs()),this.refresh(),this.reset(),this.fireAndForward("editable:shape:deleted",{shape:d}),d)},_deleteShape:function(a,d){if(d=d||this.getLatLngs(),d.length){var e=this,f=function(a,d){return a.splice(a.indexOf(d),1),a.length||e._deleteShape(a),d};if(d===a)return d.splice(0,Number.MAX_VALUE);for(var g=0;g<d.length;g++){if(d[g]===a)return f(d,a);if(-1!==d[g].indexOf(a))return f(d[g],a)}}},deleteShapeAt:function(a){return(a=this.feature.shapeAt(a))?this.deleteShape(a):void 0},appendShape:function(a){this.insertShape(a)},prependShape:function(a){this.insertShape(a,0)},insertShape:function(a,d){this.ensureMulti();a=this.formatShape(a);"undefined"==typeof d&&(d=this.feature._latlngs.length);this.feature._latlngs.splice(d,0,a);this.feature.redraw();this._enabled&&this.reset()},extendBounds:function(a){this.feature._bounds.extend(a.vertex.latlng)},onDragStart:function(d){this.editLayer.clearLayers();a.Editable.BaseEditor.prototype.onDragStart.call(this,d)},onDragEnd:function(d){this.initVertexMarkers();a.Editable.BaseEditor.prototype.onDragEnd.call(this,d)}});a.Editable.PolylineEditor=a.Editable.PathEditor.extend({startDrawingBackward:function(){this._drawing=a.Editable.BACKWARD;this.startDrawing()},continueBackward:function(a){this.drawing()||(a=a||this.getDefaultLatLngs(),this.setDrawnLatLngs(a),0<a.length&&(this.tools.attachBackwardLineGuide(),this.tools.anchorBackwardLineGuide(a[0])),this.startDrawingBackward())},continueForward:function(a){this.drawing()||(a=a||this.getDefaultLatLngs(),this.setDrawnLatLngs(a),0<a.length&&(this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(a[a.length-1])),this.startDrawingForward())},getDefaultLatLngs:function(d){return d=d||this.feature._latlngs,!d.length||d[0]instanceof a.LatLng?d:this.getDefaultLatLngs(d[0])},ensureMulti:function(){this.feature._latlngs.length&&a.Polyline._flat(this.feature._latlngs)&&(this.feature._latlngs=[this.feature._latlngs])},addNewEmptyShape:function(){if(this.feature._latlngs.length){var a=[];return this.appendShape(a),a}return this.feature._latlngs},formatShape:function(d){return a.Polyline._flat(d)?d:d[0]?this.formatShape(d[0]):void 0},splitShape:function(d,e){if(e&&!(e>=d.length-1)){this.ensureMulti();var f=this.feature._latlngs.indexOf(d);if(-1!==f){var g=d.slice(0,e+1),h=d.slice(e);h[0]=a.latLng(h[0].lat,h[0].lng,h[0].alt);this.feature._latlngs.splice(f,1,g,h);this.refresh();this.reset()}}}});a.Editable.PolygonEditor=a.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:3,newPointForward:function(d){a.Editable.PathEditor.prototype.newPointForward.call(this,d);this.tools.backwardLineGuide._latlngs.length||this.tools.anchorBackwardLineGuide(d);2===this._drawnLatLngs.length&&this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(a){this.ensureNotFlat();if(a=this.feature.shapeAt(a)){var d=[];return a.push(d),d}},newHole:function(a){var d=this.addNewEmptyHole(a);d&&(this.setDrawnLatLngs(d),this.startDrawingForward(),a&&this.newPointForward(a))},addNewEmptyShape:function(){if(this.feature._latlngs.length&&this.feature._latlngs[0].length){var a=[];return this.appendShape(a),a}return this.feature._latlngs},ensureMulti:function(){this.feature._latlngs.length&&a.Polyline._flat(this.feature._latlngs[0])&&(this.feature._latlngs=[this.feature._latlngs])},ensureNotFlat:function(){this.feature._latlngs.length&&!a.Polyline._flat(this.feature._latlngs)||(this.feature._latlngs=[this.feature._latlngs])},vertexCanBeDeleted:function(d){var e=this.feature.parentShape(d.latlngs);return 0<a.Util.indexOf(e,d.latlngs)?!0:a.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,d)},getDefaultLatLngs:function(){return this.feature._latlngs.length||this.feature._latlngs.push([]),this.feature._latlngs[0]},formatShape:function(d){return!a.Polyline._flat(d)||d[0]&&0===d[0].length?d:[d]}});a.Editable.RectangleEditor=a.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:4,options:{skipMiddleMarkers:!0},extendBounds:function(d){var e=d.vertex.getIndex(),f=d.vertex.getNext(),g=d.vertex.getPrevious(),e=d.vertex.latlngs[(e+2)%4],h=new a.LatLngBounds(d.latlng,e);g.latlng.update([d.latlng.lat,e.lng]);f.latlng.update([e.lat,d.latlng.lng]);this.updateBounds(h);this.refreshVertexMarkers()},onDrawingMouseDown:function(d){a.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,d);this.connect();var e=this.getDefaultLatLngs();3===e.length&&e.push(d.latlng);var f=new a.LatLngBounds(d.latlng,d.latlng);this.updateBounds(f);this.updateLatLngs(f);this.refresh();this.reset();d.originalEvent._simulated=!1;this.map.dragging._draggable._onUp(d.originalEvent);e[3].__vertex.dragging._draggable._onDown(d.originalEvent)},onDrawingMouseUp:function(d){this.commitDrawing(d);d.originalEvent._simulated=!1;a.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,d)},onDrawingMouseMove:function(d){d.originalEvent._simulated=!1;a.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,d)},getDefaultLatLngs:function(a){return a||this.feature._latlngs[0]},updateBounds:function(a){this.feature._bounds=a},updateLatLngs:function(a){var d=this.getDefaultLatLngs();a=this.feature._boundsToLatLngs(a);for(var e=0;e<d.length;e++)d[e].update(a[e])}});a.Editable.CircleEditor=a.Editable.PathEditor.extend({MIN_VERTEX:2,options:{skipMiddleMarkers:!0},initialize:function(d,e,f){a.Editable.PathEditor.prototype.initialize.call(this,d,e,f);this._resizeLatLng=this.computeResizeLatLng()},computeResizeLatLng:function(){var a=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),d=this.map.project(this.feature._latlng);return this.map.unproject([d.x+a,d.y-a])},updateResizeLatLng:function(){this._resizeLatLng.update(this.computeResizeLatLng());this._resizeLatLng.__vertex.update()},getLatLngs:function(){return[this.feature._latlng,this._resizeLatLng]},getDefaultLatLngs:function(){return this.getLatLngs()},onVertexMarkerDrag:function(d){1===d.vertex.getIndex()?this.resize(d):this.updateResizeLatLng(d);a.Editable.PathEditor.prototype.onVertexMarkerDrag.call(this,d)},resize:function(a){a=this.feature._latlng.distanceTo(a.latlng);this.feature.setRadius(a);this.feature._resizeLatLng=this._resizeLatLng},onDrawingMouseDown:function(d){a.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,d);this._resizeLatLng.update(d.latlng);this.feature._latlng.update(d.latlng);this.connect();d.originalEvent._simulated=!1;this.map.dragging._draggable._onUp(d.originalEvent);this._resizeLatLng.__vertex.dragging._draggable._onDown(d.originalEvent)},onDrawingMouseUp:function(d){this.commitDrawing(d);d.originalEvent._simulated=!1;a.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,d)},onDrawingMouseMove:function(d){d.originalEvent._simulated=!1;a.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,d)},onDrag:function(d){a.Editable.PathEditor.prototype.onDrag.call(this,d);this.feature.dragging.updateLatLng(this._resizeLatLng)}});var d={createEditor:function(a){a=a||this._map;var d=(this.options.editOptions||{}).editTools||a.editTools;if(!d)throw Error("Unable to detect Editable instance.");return new (this.options.editorClass||this.getEditorClass(d))(a,this,this.options.editOptions)},enableEdit:function(a){return this.editor||this.createEditor(a),this.editor.enable(),this.editor},editEnabled:function(){return this.editor&&this.editor.enabled()},disableEdit:function(){this.editor&&(this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()},_onEditableAdd:function(){this.editor&&this.enableEdit()}},e={getEditorClass:function(d){return d&&d.options.polylineEditorClass?d.options.polylineEditorClass:a.Editable.PolylineEditor},shapeAt:function(d,e){var f=null;if(e=e||this._latlngs,!e.length)return f;if(a.Polyline._flat(e)&&this.isInLatLngs(d,e))f=e;else for(var g=0;g<e.length;g++)if(this.isInLatLngs(d,e[g]))return e[g];return f},isInLatLngs:function(d,e){if(!e)return!1;var f,g,h,k,l=[],m=this._clickTolerance();if(this._projectLatlngs(e,l,this._pxBounds),l=l[0],k=this._map.latLngToLayerPoint(d),!this._pxBounds.contains(k))return!1;f=1;h=l.length;for(g=0;h>f;g=f++)if(a.LineUtil.pointToSegmentDistance(k,l[g],l[f])<=m)return!0;return!1}},g={getEditorClass:function(d){return d&&d.options.polygonEditorClass?d.options.polygonEditorClass:a.Editable.PolygonEditor},shapeAt:function(d,e){var f=null;if(e=e||this._latlngs,!e.length)return f;if(a.Polyline._flat(e)&&this.isInLatLngs(d,e))f=e;else if(a.Polyline._flat(e[0])&&this.isInLatLngs(d,e[0]))f=e;else for(var g=0;g<e.length;g++)if(this.isInLatLngs(d,e[g][0]))return e[g];return f},isInLatLngs:function(a,d){var e,f,g,h,k=!1;g=0;h=d.length;for(f=h-1;h>g;f=g++)e=d[g],f=d[f],e.lat>a.lat!=f.lat>a.lat&&a.lng<(f.lng-e.lng)*(a.lat-e.lat)/(f.lat-e.lat)+e.lng&&(k=!k);return k},parentShape:function(d,e){if(e=e||this._latlngs){var f=a.Util.indexOf(e,d);if(-1!==f)return e;for(var g=0;g<e.length;g++)if(f=a.Util.indexOf(e[g],d),-1!==f)return e[g]}}},h={getEditorClass:function(d){return d&&d.options.markerEditorClass?d.options.markerEditorClass:a.Editable.MarkerEditor}},k={getEditorClass:function(d){return d&&d.options.rectangleEditorClass?d.options.rectangleEditorClass:a.Editable.RectangleEditor}},l={getEditorClass:function(d){return d&&d.options.circleEditorClass?d.options.circleEditorClass:a.Editable.CircleEditor}},m=function(){this.on("add",this._onEditableAdd)};a.Polyline&&(a.Polyline.include(d),a.Polyline.include(e),a.Polyline.addInitHook(m));a.Polygon&&(a.Polygon.include(d),a.Polygon.include(g));a.Marker&&(a.Marker.include(d),a.Marker.include(h),a.Marker.addInitHook(m));a.Rectangle&&(a.Rectangle.include(d),a.Rectangle.include(k));a.Circle&&(a.Circle.include(d),a.Circle.include(l));a.LatLng.prototype.update=function(d){d=a.latLng(d);this.lat=d.lat;this.lng=d.lng}},u);e.Util.extend(e.Editable.prototype,{createMarker:function(a,d){var f=e.VectorIcon.icon({icon:"",iconSize:[25,41],prefix:"fa",markerColor:d.markerColor,strokewidth:3,strokecolor:d.strokecolor,alpha:.9,anchor:{x:12,y:40},spin:!0,type:1});return d=d||{},d.icon=f,this.createLayer(d&&d.markerClass||this.options.markerClass,a,d)}});e.Util.extend(e.Editable.VertexMarker.prototype,{initialize:function(a,d,f,g){this.latlng=a;this.latlngs=d;this.editor=f;e.Marker.prototype.initialize.call(this,a,g);this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className});this.options.icon.options.anchor=g.anchor;this.latlng.__vertex=this;this.editor.editLayer.addLayer(this);this.setZIndexOffset(f.tools._lastZIndex+1)}});e.Util.extend(e.Editable.MiddleMarker.prototype,{initialize:function(a,d,f,g,h){this.left=a;this.right=d;this.editor=g;this.latlngs=f;e.Marker.prototype.initialize.call(this,this.computeLatLng(),h);this._opacity=this.options.opacity;this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className});this.options.icon.options.anchor=h.anchor;this.editor.editLayer.addLayer(this);this.setVisibility()}});e.Util.extend(e.Editable.PathEditor.prototype,{addVertexMarker:function(a,d){return new this.tools.options.vertexMarkerClass(a,d,this,{anchor:{x:5,y:5}})},addMiddleMarker:function(a,d,e){return new this.tools.options.middleMarkerClass(a,d,e,this,{anchor:{x:5,y:5}})},startDrawing:function(){this.map.doubleClickZoom.disable();this._drawnLatLngs||this.setDrawnLatLngs();e.Editable.BaseEditor.prototype.startDrawing.call(this)}})}(window,document);